
<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>Item Detail Information</title>
	<link rel="Shortcut Icon" href="/Library/images/Insignia.ico?v=892" type="image/x-icon" />
	<link href="/Library/Content/kendo/2016.3.1118/kendo.common-bootstrap.min.css" rel="stylesheet" type="text/css" />
	
	<link href="/Library/Content/kendo/2016.3.1118/kendo.bootstrap.min.css" rel="stylesheet" type="text/css" />
	
	<link href="/Library/Content/opac/Base.css?v=892" rel="stylesheet" type="text/css" />
	<link href="/Library/Content/opac/Base2.css?v=892" rel="stylesheet" type="text/css" />
	<link href="/Library/Content/opac/BaseFullScreen.css?v=892" rel="stylesheet" type="text/css" />
	<link href="/Library/Content/opac/IM.css?v=892" rel="stylesheet" type="text/css" />
	<link href="/Library/Content/opac/Blue/BlueBase.css?v=892" rel="stylesheet" type="text/css" />
	<link href="/Library/Content/opac/Blue/kendo-Blue.css?v=892" rel="stylesheet" type="text/css" />
		<style>
		.no_image_text {
			color: #ffffff !important;
		}
	</style>
		<style>
		.no_image_text {
			font-weight: normal !important;
		}
	</style>
	
	<script src="/Library/Scripts/kendo/2016.3.1118/jquery.min.js"></script>
	<script src="/Library/Scripts/kendo/2016.3.1118/jszip.min.js"></script>
		<script src="/Library/Scripts/kendo/2016.3.1118/kendo.web.min.js"></script>
		<script src="/Library/Scripts/kendo/2016.3.1118/cultures/kendo.culture.ur-PK.min.js"></script>
		<script src="/Library/Scripts/kendo/2016.3.1118/messages/kendo.messages.ur-PK.min.js"></script>

	<script src="/Library/Scripts/kendo/2016.3.1118/kendo.aspnetmvc.min.js"></script>
	<script src="/Library/Scripts/kendo.modernizr.custom.js"></script>
	<script src="/Library/Scripts/jquery.cookie.min.js"></script>
	<script src="/Library/Scripts/jquery-dateFormat.min.js"></script>
	<script src="/Library/Scripts/opac/kendo.extensions.js?v=892"></script>
	<script src="/Library/Scripts/opac/Util.js?v=892"></script>
	<script src="/Library/Scripts/opac/Extensions.js?v=892"></script>
	<script src="/Library/Scripts/opac/complete.js?v=892"></script>
	<script src="/Library/Scripts/opac/Message.js?v=892"></script>
	<script src="/Library/Scripts/md5.min.js?v=892"></script>
	<script src="/Library/Scripts/crypto/components/core-min.js"></script>
	<script src="/Library/Scripts/crypto/rollups/aes.js"></script>
	<script src="/Library/Scripts/opac/aes.js?v=892"></script>



	
            <meta name="og:title" content="Calculus : Early Transcendentals Single Variable." />
            <meta name="og:description" content=" Anton, Howard, 1991.;&#160;Howard Anton, 1991.;&#160;Irl Bivens, 2002.;&#160;Stephen Davis, 1952. " />
            <meta name="og:image" content="https://nu.insigniails.com/library/Library/Images/~imageCI95309.JPG" />
            <meta name="og:url" content="https://nu.insigniails.com/library/ItemDetail?l=All&amp;i=95309&amp;ti=3&amp;subid=0?l=All&amp;i=95309" />
            <meta name="title" content="Calculus : Early Transcendentals Single Variable." />
            <meta name="description" content=" Anton, Howard, 1991.;&#160;Howard Anton, 1991.;&#160;Irl Bivens, 2002.;&#160;Stephen Davis, 1952. " />
            <link rel="image_src" href="https://nu.insigniails.com/library/Library/Images/~imageCI95309.JPG" />
         
   <script>
      var minChar = parseInt("2");
      var lang_MinChar = "Please input at least 2 characters for search";
      var lang_InvalidSearchWordsAlertMsg = "You have invalid words that are not allowed to search, please change your search keywords.";
      var alreadySearched = "0";
      var eVideoLibraryRequireLogin = parseInt("1");
      var isDetectedLibrary = (parseInt("0") == 1);
      var eVideoLibraries = eval("[\u0027\u0027]");
      var linksExtraWidth = parseInt("0");
      var txtSearchWidth = parseInt("0");
      var lang_eVideoLibraryMessage = "Login is required to access eVideo Library Resources.";
      var lang_VirtualLibraryMessage = "Login is required to access Virtual Library Resources.";
      var youtobeShowMeLink = "https://youtu.be/kYN4h9PDQJc";
      var logoutPage = "/Library/Logout.aspx";
      var languageHTML = "<div id='languageDiv' class='languageDiv' style='position:absolute;top:23px;right:-6px;padding-top:19px;display:none;z-index:20000;width:95px;'><div style='border:6px solid transparent;position:absolute;right:6px;border-bottom:8px solid #EAF3FA;top:5px;'></div><ul style='background:#EAF3FA;border-radius:3px;'><li style='float:none;'><a onclick='changeLanguage(0);return false;' href='javascript:void(0);'>English</a></li><li style='float:none;'><a onclick='changeLanguage(4);return false;' href='javascript:void(0);'>Urdu</a></li><li style='float:none;'><a onclick='changeLanguage(3);return false;' href='javascript:void(0);'>Arabic</a></li></ul></div>";
      var isTextbookSearch = ("False".toLowerCase() == "true" || "simple".toLowerCase() == "textbooks" || "simple".toLowerCase() == "ordertextbooks");
      var isOtherSearch = (isTextbookSearch || "simple".toLowerCase() == "createposorder");
      var lang_ShowMe = "Show Me";
      Util.lang_Video = "Video";
      Util.RootHomeFolder = "/Library/";
      Util.iOPACWindowAlert = parseInt("0");
      Util.AddbeforeLogin = "0";
      Util.IsLogin = (parseInt("0") == 1);
      Util.IsRMEnabled = (parseInt("0") == 1);
      Util.RMLibraryIDList = [];
      Util.applicationName = "OPAC";
      Util.librariesCount = "5";
      Util.IsGoogleThirdPartySSO = (parseInt("0") == 1);
      Util.IsGoogleSSO = (parseInt("0") == 1);
      Util.IsSSOLogin = (parseInt("0") == 1);
      Util.MilitaryTime = parseInt("0");
      Util.StandardDateFormat = "dd/MM/yyyy";
      Util.StandardDateFormatFullTime = "dd/MM/yyyy hh:mm:ss tt";
      Util.StandardDateFormatTimeNoSecond = "dd/MM/yyyy hh:mm tt";
      Util.StandardFullTimeFormat = "hh:mm:ss tt";
      Util.StandardTimeNoSecondFormat = "hh:mm tt";
      Util.CompositeDateFormat = "{0:dd/MM/yyyy}";
      Util.CompositeDateFormatFullTime = "{0:dd/MM/yyyy hh:mm:ss tt}";
      Util.CompositeDateFormatTimeNoSecond = "{0:dd/MM/yyyy hh:mm tt}";
      Util.CompositeFullTimeFormat = "{0:hh:mm:ss tt}";
      Util.CompositeTimeNoSecondFormat = "{0:hh:mm tt}";
      Util.AllowReserveForRegisteredPatron = (parseInt("1") == 1);
      Util.IsRegisteredPatron = (parseInt("0") == 1);
      Util.lang_NoReservePermission = "No reserve permission.";
      Util.isNewMenuLayout = ("False".toLowerCase() == "true");
      var cboChangeManager = $("<div></div>");
      var dtpChangeManager = $("<div></div>");
      var tpChangeManager = $("<div></div>");
      var speechToTextPrefixWord = "";
      var zoomscale = 1;
      var clientCultureName = "ur-PK";
      var CS_SiteBasedCC = (parseInt("0") > 0);
      var isLoginValid = ("True".toLowerCase() == "true");
      var changeSortBySearchType = ("False".toLowerCase() == "true");
      var musicLibraryIDs = "";
      var voicing_Lang = "Voicing", arranger_Lang = "Arranger";
      var originalSearchTypes = [];
      var currentOPACLanguage = "English";
      var currentHtmlLang = "en";
      var isLDAP = "0";
      var simpleSearchBrowseIndex = ("1" == "1");
      var hideSimpleSearch = ("0" == "1");
      Util.AllowUserCloseMessage = ("False".toLowerCase() == "true");

      $(document).ready(
         function () {
            try {
               kendo.culture(clientCultureName);
            }
            catch (cultureEx) {
            }
            try {
               if (window.localStorage.getItem("Opac2015_ZoomScale")) {
                  zoomscale = parseFloat(window.localStorage.getItem("Opac2015_ZoomScale"));
                  zoomPageContent();
               }
            }
            catch (zoomEx) {
               $("#divZoomButtons").hide();
            }
            $(".searchlibraries").css("opacity", "1");
            if (Util.librariesCount == 1) {
               $(".searchlibraries").hide();
               txtSearchWidth += 165;
            }

            if (hideSimpleSearch && Util.isNewMenuLayout) {
               $("#liSimple").show();
            }

            $(document).mousedown(function (e, sender) {
               console.log($(e.target).parents("div[data-tag2='popmenucontainer']"));
               console.log($(e.target).parents("ul[id='navMenu']"));
               if ($(e.target).parents("div[data-tag2='popmenucontainer']").length == 0 && $(e.target).parents("ul[id='navMenu']").length == 0) {
                  console.log("hide popmenucontainer");
                  $("#navMenu").find("div[data-tag2='popmenucontainer']").hide();
               }
            });
            $(document.body).change(function (e) {
               if (e.target && $(e.target).length == 1) {
                  if ($(e.target).parent() && $(e.target).parent().is(".k-combobox")) {
                     function afterComboChange() {
                        var cbo = $("#" + $(e.target).attr("id")).data("kendoComboBox");
                        if (!cbo.dataItem()) {
                           var cboDataArray = cbo.dataSource.data();
                           var findIndex = -1;
                           var cboInvalideValue = cbo.value();
                           if (cboInvalideValue == null) cboInvalideValue = "";
                           cboInvalideValue = cboInvalideValue.toLowerCase();
                           if (cboInvalideValue != null && $.trim(cboInvalideValue).length > 0) {
                              $.each(cboDataArray, function (index, item) {
                                 var itemText = item.Text;
                                 if (itemText == null) itemText = "";
                                 itemText = itemText.toLowerCase();
                                 if (itemText.indexOf(cboInvalideValue) == 0 && findIndex < 0) {
                                    findIndex = index;
                                    return false;
                                 }
                              });
                           }
                           if (findIndex > -1) {
                              cbo.value(cboDataArray[findIndex].Value);
                           }
                           else {
                              if (cboDataArray && cboDataArray.length > 0) {
                                 if (cbo._initial)
                                    cbo.value(cbo._initial);
                                 else
                                    cbo.value(cboDataArray[0].Value);
                              }
                              else {
                                 cbo.value("");
                              }
                           }
                        }
                        else {
                        }
                        if (cbo._events.change && cbo._events.change.length > 0) {
                           var list = [];
                           for (var tmp = 0; tmp < cbo._events.change.length; tmp++) {
                              list.push(cbo._events.change[tmp]);
                           }
                           for (var tmp = cbo._events.change.length - 1; tmp >= 0; tmp--) {
                              cbo.unbind("change", cbo._events.change[tmp]);
                           }
                           cboChangeManager.data($(e.target).attr("id"), list);
                        }
                        var changeHandlers = cboChangeManager.data($(e.target).attr("id"));
                        if (cbo.dataItem()) {
                           if (cbo.value() == cbo._initial) {
                              //if not change return
                              return;
                           }
                           if (changeHandlers && changeHandlers.length > 0) {
                              for (var tmp = 0; tmp < changeHandlers.length; tmp++) {
                                 changeHandlers[tmp].call(cbo, { sender: cbo, preventDefault: function () { } });
                              }
                           }
                           cbo._initial = cbo.value();
                        }
                     };
                     afterComboChange();
                  }
                  else if ($(e.target).parent() && $(e.target).parent().parent()
                           && $(e.target).parent().parent().is(".k-datepicker")) {
                     function afterDatePickerChange() {
                        var dtpJqueryData = $("#" + $(e.target).attr("id")).data();
                        var dtp = $("#" + $(e.target).attr("id")).data("kendoDatePicker");
                        var dtpValue = dtp.value();
                        if (!dtpValue) {
                           if (dtpJqueryData.lastValue)
                              dtp.value(dtpJqueryData.lastValue);
                           else
                              dtp.value(dtp.dateView._current);
                        }
                        else {
                        }
                        if (dtp._events.change && dtp._events.change.length > 0) {
                           dtpChangeManager.data($(e.target).attr("id"), dtp._events.change[dtp._events.change.length - 1]);
                           dtp.unbind("change", dtp._events.change[dtp._events.change.length - 1]);
                        }
                        var changeHandler2 = dtpChangeManager.data($(e.target).attr("id"));
                        if (dtp.value()) {
                           if (dtpValue == dtpJqueryData.lastValue) {
                              //if not change return
                              return;
                           }
                           if (changeHandler2) {
                              changeHandler2.call(dtp, { sender: dtp, preventDefault: function () { } });
                           }
                           dtpJqueryData.lastValue = dtp.value();
                        }
                     };
                     afterDatePickerChange();
                  }
                  else if ($(e.target).parent() && $(e.target).parent().parent()
                           && $(e.target).parent().parent().is(".k-timepicker")) {
                     function afterTimePickerChange() {
                        var tpJqueryData = $("#" + $(e.target).attr("id")).data();
                        var tp = $("#" + $(e.target).attr("id")).data("kendoTimePicker");
                        var tpValue = tp.value();
                        if (!tpValue) {
                           if (tpJqueryData.lastValue)
                              tp.value(tpJqueryData.lastValue);
                           else
                              tp.value(tp.timeView._current);
                        }
                        else {
                        }
                        if (tp._events.change && tp._events.change.length > 0) {
                           tpChangeManager.data($(e.target).attr("id"), tp._events.change[tp._events.change.length - 1]);
                           tp.unbind("change", tp._events.change[tp._events.change.length - 1]);
                        }
                        var changeHandler3 = tpChangeManager.data($(e.target).attr("id"));
                        if (tp.value()) {
                           if (tpValue == tpJqueryData.lastValue) {
                              //if not change return
                              return;
                           }
                           if (changeHandler3) {
                              changeHandler3.call(tp, { sender: tp, preventDefault: function () { } });
                           }
                           tpJqueryData.lastValue = tp.value();
                        }
                     };
                     afterTimePickerChange();
                  }
               }
            });

            $("input:text").focus(function () { $(this).select(); });
            initSearchText();

            $("#tipLoginWin").bind("keydown", function (e) {
               var keyCode = e.keyCode;
               if (keyCode == 13) {
                  var itemIDlist = $("#tipLoginWin").data().itemIDlist;
                  var showType = $("#tipLoginWin").data().showType;
                  var bDigital = $("#tipLoginWin").data().bDigital;
                  Util.LoginClick(itemIDlist, showType, bDigital);
               }
            });
            initLibrariesDialog();
            initLanguageTip();

            checkSessionTimeout();
            if ($("#MessageTest").length == 1) {
               showMessage($("#MessageTest"));
            }
            var musicLibraryIDsTMP = musicLibraryIDs;
            musicLibraryIDs = musicLibraryIDs.split(String.fromCharCode(160));
            var searchTypeValue = $("#cboSearchTypes").val();
            if (searchTypeValue == "Genre") {
            }
            else {
               setTimeout(function () { $("#txtSearchData").focus(); libraryChanged(false); }, 500);
            }
            if (speechToTextPrefixWord.trim() != "") {
               initSpeechToText(speechToTextPrefixWord);
            }
            $("#videoSharePlayer").bind("contextmenu", function (e) {
               e.preventDefault();
            });
         });

      function initSearchText() {
         if ($("#txtSearchData").length == 1) {
            var searchTypeValue = $("#cboSearchTypes").val();
            if (searchTypeValue && searchTypeValue.toLowerCase() == "genre") {
               $("#div_SearchDataCombo").css("display", "inline-block");
               $("#div_txtSearchData").hide();
               $("#div_txtSearchDataReadonly").hide();
            }
            else if (searchTypeValue && searchTypeValue.toLowerCase() == "eresource") {
               //$("#txtSearchData").css("visibility", "hidden");
               //$("#txtSearchDataReadonly").css("visibility", "visible");
            }
            if (!isLoginValid) {
               $("#btnSearch").attr("disabled", true);
               $("#div_txtSearchData").hide();
               $("#div_txtSearchDataReadonly").show();
            }
            var simpleSearch = function () {
               var _searchForm = $("#searchform").find("form");
               if (_searchForm.length == 1) {
                  _searchForm.submit();
               }
            };
            if (!isOtherSearch && isLoginValid) {
               oComplete = new Complete2($("#txtSearchData")[0], null, $("#txtSearchData"));
               oComplete.keydowncallback = function (e) {
                  e = e || event;
                  var keyCode = e.which | e.keyCode;
                  if (keyCode == 13) {
                     Util.stopDefaultEvent(e);
                     simpleSearch();
                     return false;
                  }
               };
               oComplete.fngetlibraryid = function () {
                  var strLibraryID = '';
                  if ($("#cboLibraries").length == 1) strLibraryID = $("#cboLibraries").val();
                  return strLibraryID;
               };
               oComplete.fngettype = function () {
                  var searchByCmp = $("#cboSearchTypes");
                  var strSearchBy = '';
                  if (searchByCmp.length == 1) strSearchBy = searchByCmp.val();
                  if (strSearchBy == null) strSearchBy = '';
                  switch (strSearchBy.toLowerCase()) {
                     case "keywords":
                     case "relevance":
                        return 0;
                     case "authors":
                        return 1;
                     case "subjects":
                        return 2;
                     case "titles":
                        return 3;
                     case "series":
                        return 4;
                     default:
                        return 5;
                  }
               };
               oComplete.onclick = simpleSearch;
               oComplete.offset.w = 0;
               oComplete.setpos();
            }
         }
      }

      function initLibrariesDialog() {
         var librariesData = [];
         window.libDialog_GetLibraries = function () {
            $.ajax({
               type: "GET",
               url: Util.RootHomeFolder + "/Global_LoadLibraries",
               dataType: "json",
               success: function (response) {
                  if (response) {

                     if (response == null || response.length == 0) return;
                     var firstLetterOfLibraryName = new Array();
                     var btnLetterArray1 = new Array();
                     var btnLetterArray2 = new Array();
                     var btnLetterArray3 = new Array();

                     librariesData = response;
                     for (var i = 0; i < response.length; i++) {
                        var isContinue = false;
                        var t = response[i].Text.substring(0, 1);
                        if (t != null)
                           t = t.toUpperCase();
                        if (firstLetterOfLibraryName != null && firstLetterOfLibraryName.length > 0) {
                           for (var j = 0; j < firstLetterOfLibraryName.length; j++) {
                              if (firstLetterOfLibraryName[j] == t)
                                 isContinue = true;
                           }
                        }
                        if (isContinue) continue;
                        firstLetterOfLibraryName.push(t.trim());
                     }
                  }
                  firstLetterOfLibraryName.sort();
                  for (var k = 0; k < firstLetterOfLibraryName.length; k++) {
                     var btnLetter = "<button class=\"k-primary k-button\" id=\"btn" + firstLetterOfLibraryName[k]
                        + "\" style=\"padding:0;width:28px;height:28px;margin-left:5px;margin-top:5px;\" type=\"button\""
                        + "onclick=\"window.ShowLibrariesByLetter('btn" + firstLetterOfLibraryName[k].trim() + "', '"
                        + firstLetterOfLibraryName[k].trim() + "');\""
                        + " data-role=\"button\" role=\"button\" aria-disabled=\"false\">"
                        + firstLetterOfLibraryName[k] + "</button>";

                     $("#libraryLetters").append(btnLetter);
                  }

                  $("#grdLibrary").kendoGrid({
                     columns: [
                        { field: "Value", hidden: true },
                        { field: "Text", title: "Library Name" }
                     ],
                     selectable: true,
                     scrollable: false,
                     dataSource: []
                  });
                  ShowLibrariesByLetter("btnA", "A");
               },
               error: function (error) {
                  Util.alert("", error);
               }
            });
         };
         window.ShowLibrariesByLetter = function (tid, letter) {
            $("#ShowLibraryDialog [id^=btn]").removeClass("btn-letter-selected");
            $("#" + tid).addClass("btn-letter-selected");
            var dataTemp = new Array();
            if (librariesData == null || librariesData.length == 0) return;
            for (var i = 0; i < librariesData.length; i++) {
               if (librariesData[i].Text.substring(0, 1).toUpperCase() == letter.toUpperCase())
                  dataTemp.push(librariesData[i]);
            }
            var grid = $("#grdLibrary").data("kendoGrid");
            var dataSource = new kendo.data.DataSource({
               data: dataTemp
            });
            grid.setDataSource(dataSource);
         }

         $("#btnLibraries").bind("click", function (e) {
            var dialog = $("#ShowLibraryDialog").data("kendoWindow");
            dialog.center();
            dialog.open();
            if (!$("#libraryLetters").html()) {
               window.libDialog_GetLibraries();
            }
         });
         $("#btnLibraryDialogOK").bind("click", function (e) {
            var grid = $("#grdLibrary").data("kendoGrid");
            var row = grid.select();
            if (row.length > 0) {
               var data = grid.dataItem(row);
               $("#cboLibraries").data("kendoComboBox").value(data.Value);
               $("#cboLibraries").val(data.Value).trigger("change");
            }
            var dialog = $("#ShowLibraryDialog").data("kendoWindow");
            dialog.close();
         });
      }

      function initLanguageTip() {
         //var toolTipTarget = $("#aLanguage").parent();
         //var tooltip = $(languageHTML);
         //   toolTipTarget.css("position", "relative").append(tooltip);
         //   toolTipTarget.mouseover(function () {
         //      tooltip.show();
         //   });
         //   toolTipTarget.mouseleave(function () {
         //      setTimeout(function () {
         //         tooltip.hide();
         //      }, 500);
         //   });
         //   $("#aLanguage").focus(function () {//huxiaojing add at 2018-05-04. wcag
         //      tooltip.show();
         //   });

         window.langTooltip = $(languageHTML);
         $("#aChangeLanguage").css("position", "relative").append(window.langTooltip);
      }

      function showLanguage() {
         if (window.langTooltip.is(":visible")) {
            window.langTooltip.hide();
         }
         else {
            window.langTooltip.show();
         }
      }

      function showAccountInfo() {
         if ($("#divAccountInfo").is(":visible")) {
            $("#divAccountInfo").hide();
         }
         else {
            $("#divAccountInfo").show();
         }
      }

      function initSpeechToText(prefixWord) {
         if (navigator.userAgent.indexOf("Chrome") > 0) {
            $.getScript(Util.RootHomeFolder + "/Scripts/annyang.min.js", function (response, status) {
               if ($('#txtSearchData').length == 1 && annyang) {
                  var callback = function (word) {
                     $('#txtSearchData').val(word);
                     if ($('#txtSearchData').val() != "") {
                        $("#btnSearch").trigger('click');
                     }
                  };
                  var cmd = "var commands = { '" + prefixWord.trim() + " *word': callback };";
                  eval(cmd);
                  annyang.addCommands(commands);
                  annyang.start();
               }
            });
         }
      }

      function changeLanguage(languageType) {
         var currentLanguage = "English";
         switch (languageType) {
            case 0:
               {
                  currentLanguage = "English";
                  break;
               }
            case 1:
               {
                  currentLanguage = "French";
                  break;
               }
            case 2:
               {
                  currentLanguage = "Spanish";
                  break;
               }
            case 3:
               {
                  currentLanguage = "Arabic";
                  break;
               }
            case 4:
               {
                  currentLanguage = "Urdu";
                  break;
               }
            case 5:
               {
                  currentLanguage = "Chinese";
                  break;
               }
         }
         $.ajax({
            type: "POST",
            url: Util.RootHomeFolder + "/Global_SaveLanguage",
            data: { strLanguageName: currentLanguage },
            dataType: "json",
            success: function (res) {
               if (res) {
                  function removeLanguage(newUrl, lang) {
                     var langParam = "&language=" + lang.toLowerCase();
                     var iTemp = newUrl.toLowerCase().indexOf(langParam);
                     if (iTemp >= 0) {
                        newUrl = newUrl.substr(0, iTemp) + newUrl.substring(iTemp + langParam.length);
                     }
                     else {
                        langParam = "language=" + lang.toLowerCase();
                        iTemp = newUrl.toLowerCase().indexOf(langParam);
                        if (iTemp >= 0) {
                           newUrl = newUrl.substr(0, iTemp) + newUrl.substring(iTemp + langParam.length);
                        }
                     }
                     return newUrl;
                  };
                  var url = window.location.href;
                  var newUrl = url;
                  newUrl = removeLanguage(newUrl, "english");
                  newUrl = removeLanguage(newUrl, "french");
                  newUrl = removeLanguage(newUrl, "spanish");
                  newUrl = removeLanguage(newUrl, "arabic");
                  newUrl = removeLanguage(newUrl, "urdu");
                  newUrl = removeLanguage(newUrl, "chinese");
                  if (newUrl.substring(newUrl.length - 1) == "&") {
                     newUrl = newUrl.substr(0, newUrl.length - 1);
                  }
                  if (newUrl.substring(newUrl.length - 1) == "?") {
                     newUrl = newUrl.substr(0, newUrl.length - 1);
                  }
                  if (url == newUrl) {
                     window.location.reload();
                  }
                  else {
                     window.location.href = newUrl;
                  }
               }
            }
         });
      }

      function checkSessionTimeout() {
         clearTimeout(window.__sessionCK);
         var _ = this;
         window.__sessionCK = setTimeout(function () {
            $.ajax({
               type: "POST",
               url: Util.RootHomeFolder + "/Global_CheckSessionTimeout",
               data: "",
               dataType: "json",
               success: function (res) {
                  if (res)
                     top.window.location.href = logoutPage;
                  else
                     checkSessionTimeout();
               },
               error: function (error) {
                  if (!error) {
                     error = {};
                  }
                  if (!error.Message) {
                     error.Message = 'Unknown Error!';
                  }
                  if (error && error.Type && error.Type.toString() === "SeesionTimeoutException") {
                     top.window.location.href = logoutPage;
                  } else {
                     checkSessionTimeout();
                  }
               }
            });
         }, 120000);
      }

      function showMessage(el) {
         var l = $.cookie('hideMessageCookie');
         var idList = [];
         if (Util.AllowUserCloseMessage && l != null && l.toString() != "") {
            idList = l.toString().split(",");
         }
         var msg = new _Message();
         msg.Show(el, 954, idList);
      }

      function displaySubMenu(li) {
         if (li.tagName == "A") {//huxiaojing add at 2018-07-30,Ver 8.4.1. wcag
            li = $(li).parent()[0];
         }
         var subMenu = li.getElementsByTagName("ul")[0];
         subMenu.style.display = "block";
      }
      function hideSubMenu(li) {
         var subMenu = li.getElementsByTagName("ul")[0];
         subMenu.style.display = "none";
      }
      function showNewSubMenu(sender) {
         //var userAgentString = window.navigator.userAgent,
         //    isIE = userAgentString.indexOf("MSIE") > -1 || userAgentString.indexOf("rv:") > -1,
         //    isFireFox = userAgentString.indexOf("Firefox") >= 0;
         console.log("showNewSubMenu");
         $("#navMenu").find("div[data-tag2='popmenucontainer'][data-tag1!='" + $(sender).attr("rel") + "']").hide();
         //if (isFireFox == true) {
         //   console.log("Mozilla Firefox");
         //   $("#navMenu").find("div.nav-wrap").css("width", "220px");
         //}

         var divContainer = $(sender).parent("li").find("div[data-tag2='popmenucontainer']");
         if (divContainer.is(":visible")) {
            divContainer.hide();
            //if (isFireFox == true) {
            //   divContainer.children("div.nav-wrap").css("width", "220px");
            //}
         }
         else {
            divContainer.show();
            //setTimeout(function () {
            //   if (isFireFox == true) {
            //      divContainer.children("div.nav-wrap").css("width", "auto");
            //   }
            //}, 30);
         }
      }
      function subMenu_LostFocus(e) {//huxiaojing add at 2018-08-09,Ver 8.4.1. wcag
         var li = $(e).parent();
         if (!$(li).hasClass("lastMenu")) {
            return;
         }
         if (li.find("ul").length > 0) {
            return;
         }
         var subMenu = $(li).parent();
         $(subMenu).css("display", "none");
         if ($(subMenu).parent().hasClass("lastMenu")) {
            $(subMenu).parent().parent().css("display", "none");
         }
      }
      function displayUserMenu(tag) {
         var _ParamForm = $("#ParamForm");
         _ParamForm.html("");
         var oInput = document.createElement("input");
         oInput.type = "hidden";
         oInput.name = "tag";
         oInput.value = tag;
         _ParamForm.append($(oInput));
         _ParamForm.submit();
      }
      function showOrHideLogoutButton(visible) {
         if (!$("#btnLogout")) return;
         if (visible) {
            $("#btnLogout")[0].style.display = 'block';
            $("#logoutSpace")[0].style.display = 'block';
         }
         else {
            $("#btnLogout")[0].style.display = 'none';
            $("#logoutSpace")[0].style.display = 'none';
         }
      }

      function showMe() {
         var helpCountInThisPage = parseInt($("#showMe_helpCount").val());
         if (helpCountInThisPage <= 1) {
            if (youtobeShowMeLink && youtobeShowMeLink.length > 0) {
               window.open(youtobeShowMeLink, "_bank");
            }
            else {
               $("#videoSharePlayer").attr("src", $((".showMe_helpfilename:eq(0)")).val());
               var descriptionHTML = "<track src=\"" + $((".showMe_helpdescriptionfile:eq(0)")).val()
                  + "\" kind=\"captions\" srclang=\"" + currentHtmlLang + "\" label=\"" + currentOPACLanguage
                  + "\"><track src=\"" + $((".showMe_helpdescriptionfile:eq(0)")).val()
                  + "\" kind=\"descriptions\" srclang=\"" + currentHtmlLang + "\" label=\"" + currentOPACLanguage + "\">";
               $("#videoSharePlayer").html(descriptionHTML);
               $("#tipVideoShareWin").data("kendoWindow").title(lang_ShowMe);
               $("#tipVideoShareWin").data("kendoWindow").open();
               $("#tipVideoShareWin").data("kendoWindow").center();
            }
         }
         else {
            var currentNo = 0;
            if ($.isNumeric(window.currentHelpNo)) {
               currentNo = window.currentHelpNo;
            }
            if ($(("#showMe_helpyoutobe_" + currentNo)).length) {
               var currentYoutobeShowMeLink = $(("#showMe_helpyoutobe_" + currentNo)).val();
               if (currentYoutobeShowMeLink && currentYoutobeShowMeLink.length > 0) {
                  window.open(currentYoutobeShowMeLink, "_bank");
               }
               else {
                  $("#videoSharePlayer").attr("src", $(("#showMe_helpfile_" + currentNo)).val());
                  var descriptionHTML = "<track src=\"" + $((".showMe_helpdescriptionfile_" + currentNo)).val()
                     + "\" kind=\"captions\" srclang=\"" + currentHtmlLang + "\" label=\"" + currentOPACLanguage
                     + "\"><track src=\"" + $((".showMe_helpdescriptionfile_" + currentNo)).val()
                     + "\" kind=\"descriptions\" srclang=\"" + currentHtmlLang + "\" label=\"" + currentOPACLanguage + "\">";
                  $("#videoSharePlayer").html(descriptionHTML);
                  $("#tipVideoShareWin").data("kendoWindow").title(lang_ShowMe);
                  $("#tipVideoShareWin").data("kendoWindow").open();
                  $("#tipVideoShareWin").data("kendoWindow").center();
               }
            }
         }
      }

      function onVideoShareDialogClose(e) {
         try {
            $("#videoSharePlayer")[0].pause();
         }
         catch (e) {
         }
      }

      function checkSearchField() {
         if (!$("#btnSearch").is(":enabled")) {
            return false;
         }
         if ($("#chkIncludeWarehouseTextbooks").length > 0) {//youhk add at 2022-05-18,ver 8.8.7 
            $("#hsw").val($("#chkIncludeWarehouseTextbooks").prop("checked"));
         }
         else {
            $("#hsw").remove();
         }
         var a = ($("#txtSearchData")[0]) ? $("#txtSearchData").val() : "";
         //if (!($("#cboSearchTypes").val() && $("#cboSearchTypes").val().toLowerCase() == "eresource") && a.length < 2) {
         if (a.length < 2) {
            Util.alert("", lang_MinChar);
         }
         //var valide = (($("#cboSearchTypes").val() && $("#cboSearchTypes").val().toLowerCase() == "eresource") || a.length > 1);
         var valide = (a.length > 1);
         if (a.toLowerCase() == "insigniadbname") {
            valide = false;
            $.post(Util.RootHomeFolder + "/Simple_GetInsigniaDBName", {},
               function (data) {
                  Util.alert("", data);
               });
         }
         if (valide) {
            if (!$("#txtSearchData").data("valid")) {
               var ajaxSettings = {};
               ajaxSettings.data = JSON.stringify({ searchWords: a });
               ajaxSettings.contentType = "application/json";
               ajaxSettings.type = "POST";
               $.ajax(Util.RootHomeFolder + "/Global_CheckInvalidSearchWords", ajaxSettings)
                  .done(function (data, textStatus, jqXHR) {
                     if (data) {
                        var _searchForm = $("#searchform").find("form");
                        if (_searchForm.length == 1) {
                           $("#txtSearchData").data("valid", true);
                           _searchForm.submit();
                        }
                     }
                     else {
                        $("#txtSearchData").removeData("valid");
                        Util.alert("", lang_InvalidSearchWordsAlertMsg);
                     }
                  });
               valide = false;
            }
            if (valide) {
               if (!isOtherSearch) {
                  // huanglidan add at 2014-11-19,Ver 6.4.8.
                  // If search type changed, use default sort type.
                  var oldSearchType = "";
                  var url = window.location.href;
                  if (url.length > 0 && url.split('?').length > 1) {
                     oldSearchType = (url.split('?')[1]).getQueryStringValue("t");
                  }
                  if (!changeSortBySearchType) {
                  }//!changeSortBySearchType
                  else {
                     var searchTypeValue = $("#cboSearchTypes").val();
                     if (alreadySearched == "0" && searchTypeValue == "Relevance") {
                        $("#hst").attr("value", "Relevance");
                     }
                     else if (alreadySearched == "1"
                        || (alreadySearched == "2" && oldSearchType != searchTypeValue)) {
                        if (searchTypeValue == "Relevance")
                           $("#hst").attr("value", "Relevance");
                        else if (searchTypeValue == "Series")
                           $("#hst").attr("value", "t02SeriesTitle");
                        else if (searchTypeValue == "Authors")
                           $("#hst").attr("value", "t02Authors");
                        else if (searchTypeValue == "Subjects")
                           $("#hst").attr("value", "t02Subjects");
                        else if (searchTypeValue == "CallNo")
                           $("#hst").attr("value", "t02Callno");
                        else if (searchTypeValue == "ISBN")
                           $("#hst").attr("value", "t02ISBN");
                        else
                           $("#hst").attr("value", "t02TitlesForOrderBy");
                     }
                  }//changeSortBySearchType
                  //$("#hifs").val("0");
                  if (simpleSearchBrowseIndex && ((searchTypeValue == "Authors") || (searchTypeValue == "Subjects"))) {
                     $("#hifs").val("0");
                  }
               }//!isTextbookSearch
            }//valide
         }
         return valide;
      }

      function librarysCboSelect(e) {
         if (!e.sender.dataItem()) return false;
         libraryChanged(true);
      }

      function libraryChanged(showLogin) {
         var searchTypeValue = $("#cboSearchTypes").val();
         if (eVideoLibraryRequireLogin == 1 && !isDetectedLibrary && ($.inArray($("#cboLibraries").val(), eVideoLibraries) > -1)) {
            $("#div_SearchDataCombo").css("display", "none");
            $("#div_txtSearchData").hide();
            $("#div_txtSearchDataReadonly").show();
            $("#btnSearch").attr("disabled", true);
            //huanglidan add at 2014-10-16,Ver 6.4.5
            var itemIDs = { libraryID: $("#cboLibraries").val() };
            if (showLogin)
               Util.showLogin(this, itemIDs, "eVideoLogin", null);
            showLogin = false;
         } else {
            if (isLoginValid) {
               if (!(searchTypeValue && searchTypeValue.toLowerCase() == "genre")) {
                  $("#div_txtSearchData").show();
               }
               $("#div_txtSearchDataReadonly").hide();
               $("#btnSearch").attr("disabled", false);
            }
         }
         var libID = $("#cboLibraries").val();
         if (!isOtherSearch && $("#cboSearchTypes").data("kendoComboBox")) {
            //alivya add music search type logic at 2019-01-31, ver 8.4.7
            if ($.inArray(libID, musicLibraryIDs) > -1) {
               var newSearchTypes = $.extend(true, [], originalSearchTypes);
               newSearchTypes.push({ Text: voicing_Lang, Value: "Voicing" });
               newSearchTypes.push({ Text: arranger_Lang, Value: "Arranger" });
               $("#cboSearchTypes").data("kendoComboBox").setDataSource(newSearchTypes);
               $("#cboSearchTypes").data("kendoComboBox").value(searchTypeValue);
            }
            else {
               $("#cboSearchTypes").data("kendoComboBox").setDataSource(originalSearchTypes);
               if (searchTypeValue == "Voicing" || searchTypeValue == "Arranger") {
                  $("#cboSearchTypes").data("kendoComboBox").select(0);
               }
               else {
                  $("#cboSearchTypes").data("kendoComboBox").value(searchTypeValue);
               }
            }
         }
         if (searchTypeValue == "Genre" && showLogin) {
            $("#div_SearchDataCombo").css("display", "inline-block");
            $("#div_txtSearchData").hide();
            $("#div_txtSearchDataReadonly").hide();
            var reg = new RegExp("__lib__type$");
            if (reg.test(libID)) libID = "All";
            kendo.ui.progress($("#body"), true);
            $.post(Util.RootHomeFolder + "Global_GetCopyGenreList", { libraryID: libID },
               function (data) {
                  kendo.ui.progress($("#body"), false);
                  if (!$.isArray(data)) data = [];
                  var dataSource = new kendo.data.DataSource({
                     data: data
                  });
                  $("#cboSearchData").data("kendoComboBox").setDataSource(dataSource);
                  if (data.length) {
                     $("#cboSearchData").data("kendoComboBox").select(0);
                     $("#txtSearchData").val(data[0].Text);
                  }
                  else {
                     $("#cboSearchData").data("kendoComboBox").text("");
                     $("#txtSearchData").val("");
                  }
                  if (typeof (afterlibrarysCboSelect) != "undefined" && afterlibrarysCboSelect != null) {
                     afterlibrarysCboSelect(libID);
                  }
                  else if (!Util.IsLogin) {
                     resetLinks(libID);
                  }
               });
         }
         else {
            if (typeof (afterlibrarysCboSelect) != "undefined" && afterlibrarysCboSelect != null) {
               afterlibrarysCboSelect(libID);
            }
            else if (!Util.IsLogin) {
               resetLinks(libID);
            }
         }
      }

      function resetLinks(libID) {
         if (!libID) return;
         var reg = new RegExp("__lib__type$");
         if (reg.test(libID)) return;
         kendo.ui.progress($("#body"), true);
         $.post(Util.RootHomeFolder + "/ResetLinks", { libraryID: libID },
            function (data, ts, jqXHR) {
               kendo.ui.progress($("#body"), false);
               $("#linksDiv").html(data);
               if (hideSimpleSearch && Util.isNewMenuLayout) {
                  $("#liSimple").show();
               }
            });
      }

   function tipLoginClick(e) {
         console.log(e.sender.element.data());
         var itemIDlist = e.sender.element.data().itemIDlist;
         var showType = e.sender.element.data().showType;
         var bDigital = e.sender.element.data().bDigital;
         Util.LoginClick(itemIDlist, showType, bDigital);
      }

      function cancelLogin(e) {
         $("#tipLoginWin").data("kendoWindow").close();
      }

      function onLoginDialogOpen(e) {
         var showType = this.element.data().showType;
         var isbtnCancelVisible = ((showType == 'eVideoLogin') || (showType == 'VirtualLogin'));
         if (isbtnCancelVisible) {
            if (showType == 'eVideoLogin') {
               $("#divMsg").html('<span style="color:#ed0909">' + lang_eVideoLibraryMessage + '</span>');
            }
            else {
               $("#divMsg").html('<span style="color:#ed0909">' + lang_VirtualLibraryMessage + '</span>');
            }
            $("#tipCancel").css("visibility", "visible");
            $("#divNotice").css("display", "none");
         }
         else {
            $("#divMsg").html("");
            $("#tipCancel").css("visibility", "visible"); //alivya change hidden to visible at 2019-09-06, ver 8.5.9. which leo told me to do this.
            $("#divNotice").css("display", "");
         }
         setTimeout(function () { $("#tipUserName").focus(); }, 500);
      }

   function onAzureSSOLogin(e) {

      var itemIDlist;
      var showType;
      var bDigital;
      if ($("#tipLogin").data().showType) {
			itemIDlist = $("#tipLogin").data().itemIDlist;
			showType = $("#tipLogin").data().showType;
			bDigital = $("#tipLogin").data().bDigital;
		}

		//console.log("btnSSOLinkClick");
      if (officeSocialConnection) {
         officeSocialConnection.redirectPath = decodeURIComponent("https%3A%2F%2Fnu.insigniails.com%2Flibrary%2FItemDetail%3Fl%3DAll%26i%3D95309%26ti%3D3%26subid%3D0");
			officeSocialConnection.loginSuccessCallback = function () {
            console.log("officeSocialConnection");
				Util.redirectAfterLoginSuccess(itemIDlist, showType, bDigital)
         };
			$.post(Util.RootHomeFolder + "/UsingAzureLogin", { login: 1 },
				function (data2) {
					officeSocialConnection.signIn();
            });


		}
      }

      function onGoogleSSOLogin(response) {

			var itemIDlist;
			var showType;
			var bDigital;
			if ($("#tipLogin").data().showType) {
				itemIDlist = $("#tipLogin").data().itemIDlist;
				showType = $("#tipLogin").data().showType;
				bDigital = $("#tipLogin").data().bDigital;
			}


			googleSocialConnection.loginSuccessCallback = function () {
				console.log("googleSocialConnection");
				Util.redirectAfterLoginSuccess(itemIDlist, showType, bDigital)
         };

         googleSocialConnection.signIn(response);


	}

      function onZoomClick(type) {
         if (type == 1) { // zoom in
            zoomscale += 0.1;
         }
         else { //zoom out
            zoomscale -= 0.1;
         }
         window.localStorage.setItem("Opac2015_ZoomScale", zoomscale.toString());
         zoomPageContent();
      }

      function zoomPageContent() {
         if (zoomscale == 1) {
            window.localStorage.removeItem("Opac2015_ZoomScale");
         }
         var contentWidth = $("#pageMainContent").width() * zoomscale;
         var scrollWidth = document.body.scrollWidth;
         var leftMargin = 0;
         if (contentWidth <= $(document.body).width()) {
            leftMargin = (document.body.scrollWidth - contentWidth) / 2;
         }
         $("#pageMainContent").css("transform", ("scale(" + zoomscale + "," + zoomscale + ")"));
         $("#pageMainContent").css("margin-left", leftMargin);
      }

      function searchTypeChanged() {
         var searchTypeValue = $("#cboSearchTypes").val();
         var libID = $("#cboLibraries").val();
         $("#div_txtSearchData").show();
         $("#div_txtSearchDataReadonly").hide();
         if (searchTypeValue && searchTypeValue.toLowerCase() == "genre") {
            var reg = new RegExp("__lib__type$");
            if (reg.test(libID)) libID = "All";
            kendo.ui.progress($("#body"), true);
            $.post(Util.RootHomeFolder + "Global_GetCopyGenreList", { libraryID: libID },
               function (data) {
                  kendo.ui.progress($("#body"), false);
                  if (!$.isArray(data)) data = [];
                  var dataSource = new kendo.data.DataSource({
                     data: data
                  });
                  $("#cboSearchData").data("kendoComboBox").setDataSource(dataSource);
                  if (data.length) {
                     $("#cboSearchData").data("kendoComboBox").select(0);
                     $("#txtSearchData").val(data[0].Text);
                  }
                  else {
                     $("#cboSearchData").data("kendoComboBox").text("");
                     $("#txtSearchData").val("");
                  }
                  $("#div_SearchDataCombo").css("display", "inline-block");
                  $("#div_txtSearchData").hide();
                  $("#div_txtSearchDataReadonly").hide();
               });
         }
         else if (searchTypeValue && searchTypeValue.toLowerCase() == "eresource") {
            $("#div_SearchDataCombo").css("display", "none");
         }
         else {
            $("#div_SearchDataCombo").css("display", "none");
         }
      }

   </script>
	<style>
		.searchControl .btnNormal .k-i-search {
			height: 24px;
			filter: invert(100%);
		}

		#MessageTest:not(:empty) {
			padding-top: 5px;
		}

      #MessageTest .btnNormal .expandmessage{
         border-width: 0 2px 2px 0;
         border-style: solid;
         border-color: rgb(255, 255, 255);
         width: 6px;
         height: 6px;
         display: inline-block;
         content: " ";
         transform: matrix(0.71, 0.71, -0.71, 0.71, 0, 0);
      }

      #MessageTest .btnNormal .collapsemessage {
         border-width: 2px 0 0 2px;
         border-style: solid;
         border-color: rgb(255, 255, 255);
         width: 6px;
         height: 6px;
         display: inline-block;
         content: " ";
         transform: matrix(0.71, 0.71, -0.71, 0.71, 0, 0);
         margin-top: 5px;
      }


		.languageDiv a, .languageDiv a:hover {
			color: darkslateblue;
			font-weight: 700;
		}

		#tipLoginWin .btnSSOLink {
			width: 270px;
			height: 40px;
			text-align: left !important;
			vertical-align: middle !important;
			background: white !important;
			border: 1px solid #000 !important;
			margin-bottom: 5px !important;
			margin-top: 5px !important;
			border-radius: 2px !important;
			color: #000 !important;
			font-weight: bold !important;
			font-size: 15px !important;
			box-shadow: none !important;
			padding: 5px 0 0 5px !important;
		}

			#tipLoginWin .btnSSOLink > img {
				margin: -5px 15px 0 0px !important;
				width: 30px;
				height: 30px;
			}
	</style>
	<style>
		.searchControl .k-textbox > input,
		.searchControl .k-autocomplete .k-input,
		.searchControl .k-picker-wrap .k-input,
		.searchControl .k-numeric-wrap .k-input,
		.searchControl .k-dropdown-wrap .k-input,
		.searchControl .k-selectbox .k-input {
			height: 2em;
		}
	</style>
	
</head>
<body id="pagebody">
	<div id="divZoomButtons" style="position: fixed; right: 2em; top: 67px; z-index: 8888; width:30px;">
		<button style="border: 1px solid #bbb; border-bottom-width: 0; border-radius: 4px 4px 0 0; padding: 3px 5px; width: auto; height: auto; background: none;"
				  onclick="onZoomClick(1);">
			<img src="/Library/Images/enlarge.png" alt="Zoom In" style="width: 24px;" />
		</button>
		<button style="border: 1px solid #bbb; border-radius: 0 0 4px 4px; padding: 3px 5px; width: auto; height: auto; background: none;"
				  onclick="onZoomClick(0);">
			<img src="/Library/Images/turndown.png" alt="Zoom Out" style="width: 24px;" />
		</button>
	</div>
	<div id="tipLoginWin" style="display:none">
   <div style="width: 268px; margin: 0 auto;">



      <div style="width: 100%" id="divMsg"></div>
      <div style="width: 100%; margin: 5px 0;">
         <label id="lbltipUserName" for="tipUserName">Username</label>
      </div>
      <div style="width: 100%">
<input class="loginFavorite" id="tipUserName" name="tipUserName" placeholder="Username" style="width:225px;" type="text" value="" />
      </div>
      <div style="width: 100%; margin: 5px 0;">
         <label id="lbltipPassword" for="tipPassword">Password</label>
      </div>
      <div style="width: 100%">
<input class="passwordFavorite" id="tipPassword" name="tipPassword" placeholder="Password" style="width:225px;" type="password" value="" />
      </div>
      <div style="width: 100%; height: 17px;" id="divNotice">Please Enter Your Patron ID and Password</div>
      <div style="width: 100%; min-height: 17px; margin: 5px 0;" id="divErrorMsg">
         <span id="msgLabel" style="color: #ed0909"></span>
      </div>
      <div style="width: 100%; align-items: flex-end;">
            <span style="display: inline-block; width: 110px;"></span>
         <button class="k-primary" id="tipLogin" style="width:66px; height:24px; padding-top:0;">Login</button><script>
	jQuery(function(){jQuery("#tipLogin").kendoButton({"click":tipLoginClick});});
</script>
<button class="k-primary" id="tipCancel" style="width:66px; height:24px; padding-top:0; visibility:hidden;">Cancel</button><script>
	jQuery(function(){jQuery("#tipCancel").kendoButton({"click":cancelLogin});});
</script>
      </div>

      <div style="width: 100%;"></div>

   </div>
   </div><script>
	jQuery(function(){jQuery("#tipLoginWin").kendoWindow({"open":onLoginDialogOpen,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Login","resizable":false,"width":320,"actions":["Close"]});});
</script>
	<div id="tipVideoShareWin" style="display:none">
   <video id="videoSharePlayer" src="" width="690" height="480" controls="controls" controlsList="nodownload">
      <track src="" kind="captions" srclang="en" label="English">
      <track src="" kind="descriptions" srclang="en" label="English">
   </video>
   </div><script>
	jQuery(function(){jQuery("#tipVideoShareWin").kendoWindow({"close":onVideoShareDialogClose,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Show Me","resizable":false,"width":700,"actions":["Close"]});});
</script>
	<input type="hidden" id="showMe_helpCount" value="1" />
	<input type="hidden" class="showMe_helpfilename" id="showMe_helpfile_0" value="" />
	<input type="hidden" class="showMe_helpdescriptionfile" id="showMe_helpdescriptionfile_0" value="" />
	<input type="hidden" id="showMe_helpyoutobe_0" value="https://youtu.be/kYN4h9PDQJc" />

	<div id="ShowLibraryDialog" style="display:none">
   <div id="libraryLetters" style="margin: 0 auto; border: #3892D3 solid 1px; margin: 5px 0; padding: 1px 1px 5px 0;"></div>
   <div style="margin: 0 auto; border: #3892D3 solid 1px; min-height: 160px; max-height: 200px; overflow-y: auto;">
      <div id="grdLibrary"></div>
   </div>
   <div style="margin: 0 auto; text-align: right; margin: 5px 0;">
      <button class="k-primary k-button" id="btnLibraryDialogOK" style="padding: 0;" type="button" data-role="button" role="button" aria-disabled="false">OK</button>
   </div>
   </div><script>
	jQuery(function(){jQuery("#ShowLibraryDialog").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Library","resizable":false,"width":320,"actions":["Close"]});});
</script>
	<div id="pageMainContent" class="fullWidth" style="transform-origin: left top;  margin: 0 auto;">
		<header id="header">
			<div id="divPageHeaderContent" class="flexlayout" style="width: calc(100% - 20px); margin: 0 auto;">
				<div style="flex: 1; -webkit-flex: 1;">
					<img alt="Logo" src="/Library/images/customize/064a6abd279543b3826b68634e4a2492.png" />
				</div>
				<div class="flexlayout" style="border-left: solid 1px #e3e4e8; min-height: 66px; padding: 0 10px;">
					<a id="aChangeLanguage" style="margin: auto 0px; height: 36px; text-decoration: none; display: inline-flex;" href="javascript:showLanguage();">
						<img src="/Library/Content/opac/Images/system/language2.png" style="margin: auto 0; width: 36px; height: 36px;" alt="Language" />
						<div style="display: inline-flex;">
							<span style="margin: auto 10px; height: 18px; font-weight: 700; color: #2f2f2f; text-transform: uppercase;">en</span>
							<img style="margin: auto 0px; width: 12px; height: 12px;" src="/Library/Content/opac/Images/system/down-arrow.png" alt="Drop down list">
						</div>
					</a>
				</div>
				<div class="flexlayout" style="border-left: solid 1px #e3e4e8; min-height: 66px; padding: 0 10px;">
					<a title="Login" style="margin: auto 0; height:36px; text-decoration:none; display: inline-flex;" href="Login">
						<img src="/Library/Content/opac/Images/system/login.png" style="margin: auto 0; width: 37px; height: 36px;" alt="Login" />
						<span style="font-weight: 700; color: #2f2f2f; text-transform: capitalize; margin: 9px;">Login</span>
					</a>
				</div>
			</div>
			<div class="clear"></div>
			<section>
				<div class="menu floatNone" style="margin: 0 auto;">
					<ul id='navMenu'>
<li >
<a href='Home' class='base home-normal  first '  style="">Home</a>
</li>
<li  onmouseover='displaySubMenu(this);' onmouseout='hideSubMenu(this);' onfocus='displaySubMenu(this);' onblur='hideSubMenu(this);'>
<a  class='base myAccount-normal  '  rel='myAccountDM' style="" onfocus='displaySubMenu(this);' onmouseover='displaySubMenu(this);'  href='javascript:void(0);'>My Account</a>
<ul>
<li class='liTriangle'><div class='triangle'></div></li>
<li class=' myBioSubMenu firstMenu' >
<a href='MyBio' class=''  onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>My Info</a>
</li>
<li class=' myFavoSubMenu' >
<a href='MyFavorites' class=''  onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>My Favourites</a>
</li>
<li class=' notifySubMenu' >
<a href='NotificationAlerts' class=''  onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Notification/Alerts</a>
</li>
<li class=' historicalSubMenu'  onmouseover='displaySubMenu(this);' onmouseout='hideSubMenu(this);' onfocus='displaySubMenu(this);' onblur='hideSubMenu(this);'>
<a class='next' onfocus='displaySubMenu(this);' onmouseover='displaySubMenu(this);'  href='javascript:void(0);' >Historical Data</a>
<ul>
<li class=' firstMenu '>
<a href='LoanHistory' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >Loan History</a></li>
<li class='  lastMenu'>
<a href='FineHistory' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >Fine History</a></li>

</ul>
</li>
<li class=' bookSubMenu'  onmouseover='displaySubMenu(this);' onmouseout='hideSubMenu(this);' onfocus='displaySubMenu(this);' onblur='hideSubMenu(this);'>
<a class='next' onfocus='displaySubMenu(this);' onmouseover='displaySubMenu(this);'  href='javascript:void(0);' >My Borrowing</a>
<ul>
<li class=' firstMenu '>
<a href='RequestsNewBooks' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >Request New Books</a></li>
<li class=' '>
<a href='Loan' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >Loan</a></li>
<li class=' '>
<a href='Reserves' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >Reserves</a></li>
<li class=' '>
<a href='Fine' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >Fine</a></li>
<li class='  lastMenu'>
<a href='ILL' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >ILL</a></li>

</ul>
</li>
<li class='defaultSubMenu' >
<a href='Communication' class=''  onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Communication</a>
</li>
<li class='defaultSubMenu' >
<a href='RecommededList' class=''  onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Recommended List</a>
</li>
<li class='defaultSubMenu'  onmouseover='displaySubMenu(this);' onmouseout='hideSubMenu(this);' onfocus='displaySubMenu(this);' onblur='hideSubMenu(this);'>
<a class='next' onfocus='displaySubMenu(this);' onmouseover='displaySubMenu(this);'  href='javascript:void(0);' >Booking</a>
<ul>
<li class=' firstMenu '>
<a href='MyMediaBooking' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >My Media Booking</a></li>
<li class=' '>
<a href='Room' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >Book Room</a></li>
<li class='  lastMenu'>
<a href='MyRoomBookings' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >My Room Bookings</a></li>

</ul>
</li>
<li class='defaultSubMenu' >
<a href='ComputerBooking' class=''  onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Computer Booking</a>
</li>
<li class='defaultSubMenu secondToLast'  onmouseover='displaySubMenu(this);' onmouseout='hideSubMenu(this);' onfocus='displaySubMenu(this);' onblur='hideSubMenu(this);'>
<a class='next' onfocus='displaySubMenu(this);' onmouseover='displaySubMenu(this);'  href='javascript:void(0);' >Events</a>
<ul>
<li class=' firstMenu  lastMenu'>
<a href='MyCreatedEvents' onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);' >Manage Events</a></li>

</ul>
</li>
<li class='defaultSubMenu lastMenu' >
<a href='RequestDocumentDelivery' class=''  onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Request Document Delivery</a>
</li>

</ul>
</li>
<li  onmouseover='displaySubMenu(this);' onmouseout='hideSubMenu(this);' onfocus='displaySubMenu(this);' onblur='hideSubMenu(this);'>
<a onfocus='displaySubMenu(this);' onmouseover='displaySubMenu(this);' href='javascript:void(0)'  class='base program-normal  '  rel='programDM' style="">University Site</a>
<ul>
<li class='liTriangle'><div class='triangle'></div></li>
<li class='  programSubMenu firstMenu' >
<a href='http://cfd.nu.edu.pk/' target='_blank' class=''   onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Chinniot-Faislabad Campus</a>
</li>
<li class='  programSubMenu' >
<a href='http://isb.nu.edu.pk/' target='_blank' class=''   onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Islamabad Campus</a>
</li>
<li class='  programSubMenu' >
<a href='http://khi.nu.edu.pk/' target='_blank' class=''   onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Karachi Campus</a>
</li>
<li class='  programSubMenu' >
<a href='http://lhr.nu.edu.pk/' target='_blank' class=''   onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Lahore Campus</a>
</li>
<li class='  programSubMenu lastMenu' >
<a href='http://pwr.nu.edu.pk/' target='_blank' class=''   onblur='subMenu_LostFocus(this);' onmouseout='subMenu_LostFocus(this);'>Peshawar Campus</a>
</li>

</ul>
</li>
<li >
<a href='Branches' class='base branches-normal  '  style="">Campus Locations</a>
</li>
<li >
<a href='CustomPage?tag=Services' class='base services-normal  '  rel='servicesDM' style="">E-Resources</a>
</li>
</ul>

				</div>
			</section>
		</header>
		<div id="body" class="" style="margin: 3px 10px;">
			<div id="divMainCustomColorStyle">

			</div>

			<section id="searchform">
<form action="/Library/DoSearch" method="get" onsubmit="return&#32;checkSearchField();">					<div style="width: calc(100% - 20px); min-width: 960px; margin: 5px auto 0 auto; background-color: white; height: 40px;" class="flexlayout base-border">
						<div id="searchControl" class="searchControl flexlayout " style="position: relative;flex:1;-webit-flex:1;">
							<div class="searchlibraries" style="opacity: 0;">
								<button aria-label="Show filter libraries dialog" class="k-primary" id="btnLibraries" style="padding: 2px; width: 8px; height: 2.5em;" type="button"></button><script>
	jQuery(function(){jQuery("#btnLibraries").kendoButton({});});
</script>
							</div>
							<div class="searchlibraries flexlayout" style="flex: 0.6; -webkit-flex: 0.6; max-width: 250px;opacity: 0;">
								<label id="lblSelectLibraries" for="cboLibraries_input" style="width: 1px; text-indent: -9999em; float: left;">Select Library</label>
								<div style="flex: 1; -webkit-flex: 1;">
									<input aria-labelledby="lblSelectLibraries" id="cboLibraries" name="l" style="width: 100%; " type="text" value="All" /><script>
	jQuery(function(){jQuery("#cboLibraries").kendoComboBox({"change":librarysCboSelect,"dataSource":[{"Text":"All Libraries","Value":"All","Tag":null},{"Text":"Chiniot-Faislabad","Value":"0005","Tag":null},{"Text":"Islamabad","Value":"0001","Tag":null},{"Text":"Karachi","Value":"0002","Tag":null},{"Text":"Lahore Campus ","Value":"0003","Tag":null},{"Text":"Peshawar Campus","Value":"0004","Tag":null}],"dataTextField":"Text","dataValueField":"Value"});});
</script>
								</div>
							</div>
							<label id="lblSelectSearchTypes" for="cboSearchTypes_input" style="width: 1px; text-indent: -9999em;">Select Search Type</label>
							<div>
								<input aria-labelledby="lblSelectSearchTypes" id="cboSearchTypes" name="t" style="width: 104px; " type="text" value="Keywords" /><script>
	jQuery(function(){jQuery("#cboSearchTypes").kendoComboBox({"dataSource":[{"Text":"Keywords","Value":"Keywords","Tag":null},{"Text":"Relevance","Value":"Relevance","Tag":null},{"Text":"Title","Value":"Titles","Tag":null},{"Text":"Author","Value":"Authors","Tag":null},{"Text":"Subject","Value":"Subjects","Tag":null},{"Text":"Call No","Value":"CallNo","Tag":null},{"Text":"Series","Value":"Series","Tag":null},{"Text":"ISBN","Value":"ISBN","Tag":null},{"Text":"ISSN","Value":"ISSN","Tag":null},{"Text":"Local Notes","Value":"LocalNotes","Tag":null}],"dataTextField":"Text","dataValueField":"Value"});});
</script>
							</div>
							<label id="lblSearchData" for="txtSearchData" style="width: 1px; text-indent: -9999em;">Enter your search keywords</label>
							<label id="lblSearchGenre" for="cboSearchData_input" style="width: 1px; text-indent: -9999em;">Select Genre</label>
							<div style="flex: 1; -webkit-flex: 1;" id="div_txtSearchData">
								<input aria-labelledby="lblSearchData" class="k-textbox" id="txtSearchData" name="k" style="width:100%;" />
							</div>
							<div style="flex: 1; -webkit-flex: 1; display: none;" id="div_txtSearchDataReadonly">
								<input aria-labelledby="lblSearchData" class="k-textbox k-state-disabled" disabled="disabled" id="txtSearchDataReadonly" name="txtSearchDataReadonly" style=" background-color:#f2f2f2; width:100%;" />
							</div>
							<div id="div_SearchDataCombo" style="display: none; flex: 1; -webkit-flex: 1;">
								<input aria-labelledby="lblSearchGenre" id="cboSearchData" name="ck" style="width:100%;" type="text" /><script>
	jQuery(function(){jQuery("#cboSearchData").kendoComboBox({"dataSource":[],"dataTextField":"Text","dataValueField":"Value"});});
</script>
							</div>
<button aria-label="Submit your search" class="btnNormal" id="btnSearch" style="width: 70px; height: 2.3em;margin:0 3px;" type="submit"></button><script>
	jQuery(function(){jQuery("#btnSearch").kendoButton({"icon":"search"});});
</script>							<input type="hidden" name="action" value="simple" />
							<input type="hidden" name="p" value="1" />
							<input type="hidden" name="ps" id="hps" value="30" />
							<input type="hidden" name="st" id="hst" value="t02TitlesForOrderBy" />
							<input type="hidden" name="ifs" id="hifs" value="0" />
							<input type="hidden" name="c" value="c" />
                     <input type="hidden" name="sw" id="hsw" value="false" />
							<input type="hidden" name="oldSearchType" id="oldSearchType" value="Keywords" />
						</div>
						<div id="linksDiv" class="links" style="width: auto;">   <ul>      <li id='liSimple' style='display:none'><a href="SearchResult" >Simple</a></li>      <li id='liAdvanced'><a href="AdvancedSearch" >Advanced</a></li>      <li id='liKids'><a href="Kiosk" >Kiosk</a></li>      <li id='liAssets'><a href="Assets" >Assets</a></li>   </ul></div>
						<div>
						</div>
					</div>
</form>
			</section>
			<section>
				<div id="MessageTest" style="float: none; margin: 0 auto; width: calc(100% - 20px);"></div>
			</section>
			<section class="flexlayout" style="padding-top: 5px;">
				<div class="main-content" style="">
					

<script src="/Library/Scripts/opac/PatronBook.js?v=892"></script>
<script type="text/javascript" src="https://js.live.net/v7.2/OneDrive.js"></script>
   <script type="text/javascript">
      var ipodItemID = parseInt("95309");
      function changeTab(tabIndex, sender, isMiddle, isOnlineDB) {
         showLoadMask(1);
         setParentTabPanels(sender, tabIndex);
         var div = null
         $("#copiesDetail").css("display", "none");
         $("#SummaryDetail").css("display", "none");
         $("#marcDetail").css("display", "none");
         $("#reviewDetail").css("display", "none");
         $("#imageCoverDetail").css("display", "none");
         $("#additionalInfo").css("display", "none");
         var id = getID();
         var strLibraryID = getLibraryID();
         if (tabIndex == 0) {
            div = $("#copiesDetail");
            div.css("display", "block");
            if ($("#overdriveID").length) {
               $("#overDriveEBook").show();
               var strMediumType = "";
               if ($("#overdriveID").data("mediumtype")) {
                  strMediumType = $("#overdriveID").data("mediumtype");
               }
               var strItemID = "";
               if ($("#overdriveID").data("itemid")) {
                  strItemID = $("#overdriveID").data("itemid");
               }
               if (strMediumType == "Magazine") {
                  $("#overDriveEBook").empty();
                  var strMore = "<div id='div_od_{0}' class='flexlayoutcol downloadableEResource overDriveMagazineConent'>"
                     + "<div style='flex:0 0 10px;-webkit-flex:0 0 10px;'></div>"
                     + "<div class='overdriveMagazineIssuesMore flexlayout' style = 'justify-content: center;-webkit-justify-content: center;'>"
                     + "<a id='showMore_{0}' style='display:none; color:#FFF;' href='javascript: void(0);'  onclick = 'checkOverDriveMagazine(\"{1}\", \"{0}\", true)'><span style='font-size:14px;'>+</span>&nbsp;&nbsp;{2}</a></div>"
                     + "<div style='flex:0 0 10px;-webkit-flex:0 0 10px;'></div>"
                     + "</div>"
                  strMore = kendo.format(strMore, strItemID, $("#overdriveID").get(0).value, "Load More")
                  $("#overDriveEBook").append(strMore);
                  $("#overDriveEBook").css("height", "auto");
                  checkOverDriveMagazine($("#overdriveID").get(0).value, strItemID, false);
               }
               else {
                  $.post(Util.RootHomeFolder + "/OverDrive_LoadAvailabilityInfo", { id: $("#overdriveID").get(0).value }, function (strJsonOverDrive) {
                     updateOverderiveItemInfo(eval("(" + strJsonOverDrive + ")"), $("#overDriveEBook"));
                     showLoadMask(0);
                  });
               }
            }  else {
               showAviailability(ipodItemID, 0, false, "localCopiesDetail", false, function () { showLoadMask(0); }, getLibraryID());
            }
         }
         else if (tabIndex == 1) {
            div = $("#SummaryDetail");
            div.css("display", "block");
            saveSubTabIndex(1);
            showLoadMask(0);
         }
         else if (tabIndex == 2) {
            div = $("#marcDetail");
            div.css("display", "block");
            showItemDetailMARC(id, strLibraryID);
         }
         else if (tabIndex == 3) {
            div = $("#reviewDetail");
            div.css("display", "block");
            showItemDetailReviewed(id, strLibraryID);
         }
         else if (tabIndex == 4) {
            div = $("#imageCoverDetail");
            div.css("display", "block");
            saveSubTabIndex(4);
            showLoadMask(0);
         }
         else if (tabIndex == 5) {
            div = $("#additionalInfo");
            div.css("display", "block");
            showItemAdditionalInfo(id);
         } else if (tabIndex == -1) {
            //add by liujing 2017-06-28 ver:8.1.1
            $("#allTabPanels").hide();
            $("#ItemDetailTabsIframeDiv").hide();
            showLoadMask(0);
         }
         //if ($("#iframeItemDetailTabs")[0]) {
         //   $("iframeItemDetailTabs").attr("src", "ItemDetailTabs?ti=" + tabIndex + "&id=" + getID().toString() + "&l=" + window.encodeURIComponent(getLibraryID()) + (isOnlineDB ? "&iifs=1" : ""));
         //}
      }

      function saveSubTabIndex(subTabIndex) {
         $.post(Util.RootHomeFolder + "/ItemDetail_SaveSubTabIndex",
            { subTabIndex: subTabIndex },
            function (data) {
            });
      }
      function updateOverderiveItemInfo(jsonResult, container) {
         var id = jsonResult.reserveId.toUpperCase();
       
         container.html("");
         if (jsonResult) {
            jsonResult.id = id;
            if (jsonResult.availabilityType) {
               if (jsonResult.ownedCopies == 0 && jsonResult.copiesAvailable == 0 && jsonResult.available == "false") { //Preorder titles
                  jsonResult.buttonClass = "btnNormal";
                  jsonResult.copiesInfo = "<span class='redFont'>" + jsonResult.numberOfHolds + " holds</span>";
                  jsonResult.buttonValue = "Reserve";
                  jsonResult.operatorFun = "overDriveHold";
               }
               else if (jsonResult.availabilityType == "LimitedAvailability" && jsonResult.copiesOwned == 500000) { //Cost Per Circ (CPC) titles
                  jsonResult.buttonClass = "btnNormal";
                  jsonResult.copiesInfo = "<span class='green'>" + jsonResult.copiesAvailable + " copies</span>";
                  jsonResult.buttonValue = "Check Out";
                  jsonResult.operatorFun = "overDriveCheckout";
               }
               else if (jsonResult.availabilityType == "AlwaysAvailable" && jsonResult.copiesOwned == 999999) { //Simultaneous Use titles
                  jsonResult.buttonClass = "btnNormal";
                  jsonResult.copiesInfo = "";
                  jsonResult.buttonValue = "Check Out";
                  jsonResult.operatorFun = "overDriveCheckout";
               }
               else {
                  if (jsonResult.copiesAvailable > 0) {
                     jsonResult.buttonClass = "btnNormal";
                     jsonResult.copiesInfo = "<span class='green'>" + jsonResult.copiesAvailable + " of " + jsonResult.copiesOwned + " copies</span>";
                     jsonResult.buttonValue = "Check Out";
                     jsonResult.operatorFun = "overDriveCheckout";
                  }
                  else {
                     jsonResult.buttonClass = "btnNormal";
                     jsonResult.copiesInfo = "<span class='redFont'>" + jsonResult.numberOfHolds + " holds on " + jsonResult.copiesOwned + " copies</span>";
                     jsonResult.buttonValue = "Reserve";
                     jsonResult.operatorFun = "overDriveHold";
                  }
               }
               var template = kendo.template($("#overdriveInfoTemplate").html());
               container.html(template(jsonResult));
            }
         }
      }

      function loadODAvailabilityInfoForOneItem(id, callback) {
         $.post(Util.RootHomeFolder + "/OverDrive_LoadAvailabilityInfo", { id: id }, function (strJonResult) {
            updateOverderiveItemInfo(eval("(" + strJonResult + ")"), $("#overDriveEBook"));
            if ($.isFunction(callback)) callback();
         });
      }

      function checkOverDriveMagazine(magazineID, magazineItemID, bMore) {
         var aMagazineIssues = [];
         var $divs = $("#overDriveEBook");
         $.post(Util.RootHomeFolder + "/OverDrive_LoadMagazineIssues", {
            ids: magazineID,
            bMore: bMore,
            iOffset: bMore ? $divs.find("div[id^=divOverdriveMagazineIssues]").length : 0
         }, function (res) {
            if (res && res.length) {
               var aIssuesIDs = [];
               var jsonObj = $.parseJSON(res);
               if (jsonObj && jsonObj.products && jsonObj.products.length) {
                  showLoadMask(1);
                  aMagazineIssues = jsonObj.products;
                  var aProductsID = [];
                  var iProductCount = 0;
                  iProductCount = jsonObj.products.length;
                  if (iProductCount < 10) {
                     if (iProductCount < 5) {
                        $('#overDriveEBook').children().first().attr("style", "overflow-y:auto;");
                     }
                     else {
                        $('#overDriveEBook').children().first().attr("style", "overflow-y:scroll;");
                     }
                  }
                  else {
                     $('#overDriveEBook').children().first().attr("style", "overflow-y:scroll;");
                  }
                  for (var i = 0 ; i < jsonObj.products.length; i++) {
                     aProductsID.push(jsonObj.products[i].id);
                     updateOverderiveMagazineItemInfoExceptButton(magazineID, magazineItemID, jsonObj.products[i].id, aMagazineIssues);
                     (function (magazineID, magazineItemID, IssuesID) {
                        checkOverDriveMagazineIssuesAvailabilities(magazineID, magazineItemID, IssuesID, iProductCount);
                     })(magazineID, magazineItemID, jsonObj.products[i].id);
                  }
               }
               else {
                  if ($divs.length == 1 && jsonObj.errorCode) {
                     $divs.css("display", "none");
                  }
               }
            }
         });
      }
      function checkOverDriveMagazineIssuesAvailabilities(magazineID, magazineItemID, IssuesID, iProductCount) {
         $.post(Util.RootHomeFolder + "/OverDrive_LoadAvailabilities", { ids: IssuesID }, function (res) {
            if (res && res.length) {
               var jsonObj = $.parseJSON(res);
               if (jsonObj && jsonObj.availability && jsonObj.availability.length) {
                  for (var i = 0 ; i < jsonObj.availability.length; i++) {
                     updateOverderiveMagazineItemInfo(jsonObj.availability[i], iProductCount, true);
                  }
               }
            }
         });
      }
      function updateOverderiveMagazineItemInfoExceptButton(magazineID, magazineItemID, IssuesID, aMagazineIssues) {
         var id = IssuesID.toUpperCase();
         var $divs = $("#overDriveEBook");
         jsonResult = {};
         if (IssuesID) {
            jsonResult.edition = "";
            jsonResult.series = "";
            jsonResult.title = "";
            jsonResult.starRating = "";
            jsonResult.imagesCoverHref = "";
            $.each(aMagazineIssues, function (iIndex, oItem) {
               if (oItem.id.toUpperCase() == id) {
                  jsonResult.divID = id;
                  jsonResult.edition = oItem.edition;
                  jsonResult.series = oItem.series;
                  jsonResult.title = oItem.title;
                  jsonResult.starRating = oItem.starRating;
                  jsonResult.imagesCoverHref = (oItem.images && oItem.images.cover && oItem.images.cover.href) ? oItem.images.cover.href : "";
                  return false;
               }
            });
            jsonResult.Series_Cap = "Series" + ":";
            jsonResult.Edition_Cap = "Edition" + ":";
            jsonResult.Rating_Cap = "Rating:" + "";
            var template = kendo.template($("#overdriveMagazineInfoExceptButtonTemplate").html());
            jsonResult.strID = magazineItemID + "|" + id;
            if ($divs.find("a[id^=showMore_]").length == 1) {
               $divs.find("a[id^=showMore_]").parent().before(template(jsonResult));
            }
         }
      }
      function updateOverderiveMagazineItemInfo(jsonResult, iProductCount, bJudgeLoadMore) {
         var id = "";
         if (jsonResult.reserveId)
            id = jsonResult.reserveId.toUpperCase();
         else if (jsonResult.id)
            id = jsonResult.id.toUpperCase();

         var $divs = $("#overDriveEBook");
         if (jsonResult) {
            jsonResult.DownloadableEBook_Cap = "Get e-Resource";
            jsonResult.Availability_Cap = "Availability" + ":";
            var holds_Cap = "Holds";
            var copies_Cap = "Copies";
            var on_Cap = "On";
            var of_Cap = "Of";
            var series_Cap = "Series";
            if (jsonResult.availabilityType) {
               if (jsonResult.copiesOwned == 0 && jsonResult.copiesAvailable == 0 && jsonResult.available == "false") { //Preorder titles
                  jsonResult.buttonClass = "btnNormal";
                  jsonResult.copiesInfo = "<span class='redFont'>" + jsonResult.numberOfHolds + " " + holds_Cap + "</span>";
                  jsonResult.buttonValue = "Reserve";
                  jsonResult.operatorFun = "overDriveHold";
               }
               else if (jsonResult.availabilityType == "LimitedAvailability") { //Cost Per Circ (CPC) titles 
                  jsonResult.buttonClass = "btnNormal";
                  jsonResult.copiesInfo = "<span class='green'>" + jsonResult.copiesAvailable + " " + copies_Cap + "</span>";
                  jsonResult.buttonValue = "Check Out";
                  jsonResult.operatorFun = "overDriveCheckout";
               }
               else if (jsonResult.availabilityType == "AlwaysAvailable") { //Simultaneous Use titles
                  jsonResult.buttonClass = "btnNormal";
                  jsonResult.copiesInfo = "";
                  jsonResult.buttonValue = "Check Out";
                  jsonResult.operatorFun = "overDriveCheckout";
                  jsonResult.Availability_Cap = "";
               }
               else {
                  if (jsonResult.copiesAvailable > 0) {
                     jsonResult.buttonClass = "btnNormal";
                     jsonResult.copiesInfo = "<span class='green'>" + jsonResult.copiesAvailable + " " + of_Cap + " " + jsonResult.copiesOwned + " " + copies_Cap + "</span>";
                     jsonResult.buttonValue = "Check Out";
                     jsonResult.operatorFun = "overDriveCheckout";
                  }
                  else {
                     jsonResult.buttonClass = "btnNormal";
                     jsonResult.copiesInfo = "<span class='redFont'>" + jsonResult.numberOfHolds + " " + holds_Cap + " " + on_Cap + " " + jsonResult.copiesOwned + " " + copies_Cap + "</span>";
                     jsonResult.buttonValue = "Reserve";
                     jsonResult.operatorFun = "overDriveHold";
                  }
               }
               if ($("#divButtonOverdriveMagazineIssues" + id).length == 1) {
                  var templateButton = kendo.template($("#overdriveMagazineInfoButtonTemplate").html());
                  var sAlwaysAvailableHTML = "";
                  sAlwaysAvailableHTML = "<div class='flexlayout blueFont' style='font-weight:bold;'> <span>"
                     + jsonResult.DownloadableEBook_Cap
                     + "</span> </div>"
                     + "<div style='flex:0 0 10px;-webkit-flex:0 0 10px;'></div> <div class='flexlayout'>"
                     + "<span>"
                     + jsonResult.Availability_Cap
                     + "&nbsp;&nbsp;</span>"
                     + jsonResult.copiesInfo
                     + "</span></div>"
                  jsonResult.id = id + "|" + "Magazine";;
                  $("#divAvailability_" + id).empty();
                  $("#divAvailability_" + id).html(sAlwaysAvailableHTML);
                  $("#divButtonOverdriveMagazineIssues" + id).empty();
                  $("#divButtonOverdriveMagazineIssues" + id).html(templateButton(jsonResult));
               }
               var divButtons = $divs.find("div[id^=divButtonOverdriveMagazineIssues]");
               var divEmptyButtons = [];
               var iCountButtons = divButtons.length;
               if (iCountButtons > 0) {
                  divEmptyButtons = jQuery.grep(divButtons, function (oItem, iIndex) {
                     return $(oItem).find("button[id^=btnOverdriveMagazineIssue]").length == 0;
                  });
                  if (divEmptyButtons.length == 0) {
                     if (iProductCount < 10) {
                        $divs.find("a[id^=showMore_]").css("display", "none");
                     }
                     else {
                        $divs.find("a[id^=showMore_]").css("display", "");
                     }
                     showLoadMask(0);
                  }
               }
            }
         }
      }
      function loadODMagazineAvailabilityInfoForOneItem(id, callback) {
         $.post(Util.RootHomeFolder + "/OverDrive_LoadAvailabilityInfo", { id: id }, function (strJonResult) {
            updateOverderiveMagazineItemInfo($.parseJSON(strJonResult), 0, false);
            if ($.isFunction(callback)) callback();
         });
      }

      function overDriveCheckout(id) {
         var strID = "";
         var strMediumType = "";
         if (id.indexOf("|") > -1) {
            var arr = id.split("|");
            if (arr.length >= 2) {
               strID = arr[0];
               strMediumType = $.trim(arr[1]);
            }
         }
         else {
            strID = id;
         } 

         if (!Util.IsLogin) {
            Util.showLogin(this, strID, "odc", null);
            return;
         }
         kendo.ui.progress($(document.body), true);
         $.post(Util.RootHomeFolder + "/OverDrive_Checkout", { id: strID }, 
            function (res) { 
               if (strMediumType && strMediumType.toUpperCase() == "MAGAZINE") {
                  loadODMagazineAvailabilityInfoForOneItem(strID, null);
               }
               else {
                  loadODAvailabilityInfoForOneItem(strID, null);
               }
               
               if (res) {
                  var msg = undefined;
                  if (res.strError) {
                     msg = res.strError;
                     try {
                        var errorJson = $.parseJSON(res.strError);
                        if (errorJson && errorJson.message) {
                           msg = errorJson.message;
                        }
                     }
                     catch (e) {
                     }

                     Util.alert("", msg);
                     kendo.ui.progress($(document.body), false);
                     return;
                  }

                  var errorCode = undefined;
                  var result = $.parseJSON(res.checkoutResult);
                  console.log("res" + res);
                 
                  if (result && result.errorCode) {
                     errorCode = result.errorCode;
                  }
                  if (result && result.message) {
                     msg = result.message;
                  }

                  if (errorCode && errorCode != "TitleAlreadyCheckedOut") {
                     Util.alert("", msg);
                     kendo.ui.progress($(document.body), false);
                     return;
                  }
                

                  if (result.errorCode == "TitleAlreadyCheckedOut") {
                     $.post(Util.RootHomeFolder + "/OverDrive_GetCheckoutInfo", { id: strID }, function (strCheckoutInfo) {
                        if (strCheckoutInfo) {
                           var checkoutInfo = eval("(" + strCheckoutInfo + ")");
                           addDownloadParams(checkoutInfo);
                           Util.showOverDriveDownload(checkoutInfo);
                        }
                        kendo.ui.progress($(document.body), false);
                     });
                  }
                  else {
                     kendo.ui.progress($(document.body), false);
                     addDownloadParams(result);
                     Util.showOverDriveDownload(strID);
                  }
               }
            });

         function addDownloadParams(json, strID) {
            var itemID = $("#overdriveID").attr("data-itemid");
            json.itemID = itemID;

            json.img = $("#img_" + itemID).get(0).src;
            json.title = $("#img_" + itemID).get(0).title;
         }
      }

      function overDriveHold(id) {
         if (!Util.IsLogin) {
            Util.showLogin(this, id, "odh", null);
            return;
         }
         kendo.ui.progress($(document.body), true);
         var strID = "";
         var strMediumType = "";
         if (id.indexOf("|") > -1) {
            var arr = id.split("|");
            if (arr.length >= 2) {
               strID = arr[0];
               strMediumType = $.trim(arr[1]);
            }
         }
         else {
            strID = id;
         }
         checkHaveCheckoutOverDrive(strID, function (haveCheckedOut) {
            if (haveCheckedOut) {
               kendo.ui.progress($(document.body), false);
               Util.alert("", "You have checked out this item, and can not reserve it again.");
               return;
            }
            $.post(Util.RootHomeFolder + "/OverDrive_Hold", { id: strID },
               function (res) {
                  kendo.ui.progress($(document.body), false);
                  if (strMediumType && strMediumType.toUpperCase() == "MAGAZINE") {
                     loadODMagazineAvailabilityInfoForOneItem(strID, null);
                  }
                  else {
                     loadODAvailabilityInfoForOneItem(strID, null);
                  }
                  if (res) {
                     var msg = res.lang_HoldSucceed;
                     if (res.strError) {
                        msg = res.strError;
                        try {
                           var errorJson = $.parseJSON(res.strError);
                           if (errorJson && errorJson.message) {
                              msg = errorJson.message;
                           }
                        }
                        catch (e) {
                        }
                     }
                     else {
                        try {
                           var result = $.parseJSON(res.holdResult);
                           if (result && result.message) {
                              msg = result.message;
                           }
                        }
                        catch (e) {

                        }
                     }
                     Util.alert("", msg);
                  }
               });
         });
      }

      function checkHaveCheckoutOverDrive(overdriveID, callback) {
         if ($.isFunction(callback)) callback(false);
         return;

         //do not check have checkout or not. 2017-05-16
         $.post(Util.RootHomeFolder + "/OverDrive_GetCheckoutInfo", { id: overdriveID }, function (strRes) {
            var haveCheckedOut = false;
            var res = undefined;
            try {
               var res = $.parseJSON(strRes);
            }
            catch (e) {

            }
            if (res && res.expires && res.expires.length) {
               if ($.isFunction(callback)) callback(true);
            }
            else {
               if ($.isFunction(callback)) callback(false);
            }
         });
      }
      //Last modified by futao 2021-4-7 ver:7.8.5
      function showItemDetailMARC(id, selectedLibraryID) {
         $.post(Util.RootHomeFolder + "/ItemDetail_GetMARCValues", { id: id, selectedLibraryID: selectedLibraryID },
            function (data) {
               var previewHtml = "";
               if (data) {
                  var marcTemplate = kendo.template($("#marcTemplate").html());
          

                  for (var ri = 0; ri < data.length; ri++) {
                     var row = data[ri];
                     if (ri == 0) {
                        var headerObj = {
                           OneRowStyle: "class=\"itemdetailtabrow\" style=\"background-color:rgb(249, 249, 249);font-weight:bold;\"",
                           TagStyle: "padding-left:8px;padding-top:20px;border-bottom:1px solid darkgray;",
                           ValueStyle: "padding-left:125px;padding-top:20px;border-bottom:1px solid darkgray;",
                           Tag: row.Tag,
                           Value: row.Value,
                        };
                        previewHtml = marcTemplate(headerObj);
                        continue;
                     }                     
                     var OneRowStyleCss = (ri % 2) != 0 ? "class=\"itemdetailtabrow\" style=\"background-color:rgb(249, 249, 249);line-height:20px;\"" : "class=\"itemdetailtabrow\" style=\"line-height:20px;\"";
                     row.OneRowStyle = OneRowStyleCss;
                     row.TagStyle= "padding-left:8px;",
                     row.ValueStyle= "padding-left:5px;",
                     previewHtml += marcTemplate(row);
                  }
               }
               $("#marcDetailContent").html(previewHtml);
               showLoadMask(0);
            });
      }

      var contentFolderUrl = "/Library/Content";
      function showItemDetailReviewed(id, selectedLibraryID) {
         $.post(Util.RootHomeFolder + "/ItemDetail_GetReviewedValues", { id: id, selectedLibraryID: selectedLibraryID },
            function (data) {
               var previewHtml = "";
               if (data) {
                  var reviewTemplate = kendo.template($("#reviewTemplate").html());
                  for (var ri = 0; ri < data.Reviews.length; ri++) {
                     var row = data.Reviews[ri];
                     //row.ReviewedbyCap = data.Captions.reviewedby;
                     //row.RateCap = data.Captions.rate;
                     //row.TagCap = data.Captions.tag;
                     //row.ReviewCap = data.Captions.review;
                     row.OneRowStyle = (ri % 2) == 0 ? "style=\"background-color:rgb(249, 249, 249);border:none;padding:3px 0 6px 0;width:100%;\"" : "style=\"border:none;padding:3px 0 6px 0;width:100%;\"";
                     var titleStars = "";
                     for (var k = 0; k < 5; k++) {
                        if (k < row.Rate) {
                           if (Util.skinName == "White") {
                              titleStars += "<img alt='rating' src='" + contentFolderUrl + "/opac/images/System/star0White.gif' />";
                           }
                           else {
                              titleStars += "<img alt='rating' src='" + contentFolderUrl + "/opac/images/System/star0.gif' />";
                           }
                        }
                        else {
                           titleStars += "<img alt='rating' src='" + contentFolderUrl + "/opac/images/System/star1.gif' />";
                        }
                     }
                     row.StarsHTML = titleStars;
                     previewHtml += reviewTemplate(row);
                  }
                  previewHtml += "<div class=\"reviewDesc\" style=\"overflow-x: auto;clear:both;\">" + (data.SyndeticsContent ? data.SyndeticsContent : "") + "</div>"
               }
               $("#reviewDetailContent").html(previewHtml);
               showLoadMask(0);
            });
         $("#btnWriteAReview_ItemDetail").on("click", function () {
            $("#btnAddReview_ItemDetail").trigger("click");
         });
      }
      function showItemAdditionalInfo(id) {
         //Last modified by futao 2021-4-7 ver:7.8.5
         $.post(Util.RootHomeFolder + "/ItemDetail_GetWebLinks", { id: id },
            function (data) {
               var previewHtml = "";
               if (data) {
                  var additionalTemplate = kendo.template($("#additionalTemplate").html());
                  var headerObj = {
                     OneRowStyle: "class=\"itemdetailtabrow\" style=\"background-color:rgb(249, 249, 249);font-weight:bold;\"",
                     OneHeaderStyle: "style=\"padding-left:25px;padding-top:20px;\"",
                     BorderStyle: "border-bottom:1px solid darkgray;",
                     FileTypeHeaderStyle: "style=\"padding-top:20px;\"",
                     Title: data.Captions.lang_Title,
                     FileType: data.Captions.lang_MediaType,
                     Location: data.Captions.lang_AttachedFile
                  };
                  previewHtml = additionalTemplate(headerObj);
                  for (var ri = 0; ri < data.AdditionalInfos.length; ri++) {
                     var row = data.AdditionalInfos[ri];
                     var OneRowStyleCss = (ri % 2) != 0 ? "class=\"itemdetailtabrow\" style=\"background-color:rgb(249, 249, 249);line-height:30px;\"" : "class=\"itemdetailtabrow\" style=\"line-height:30px;\"";
                     row.OneRowStyle = OneRowStyleCss;
                     row.OneHeaderStyle = "style=\"padding-left:5px;\"";
                     row.BorderStyle = "";
                     row.FileTypeHeaderStyle = "style=\"padding-left:25px;\"";
                     previewHtml += additionalTemplate(row);
                  }
               }
               $("#additionalInfoContent").html(previewHtml);
               showLoadMask(0);
            });
      }
      function addShow_PatronBook() {
         Util.show_PatronBook = function (sender, itemids, searchLibraryID) {
            /// <summary>show Patron Info</summary>
            /// <param name="sender" type="object">open window object</param>
            /// <param name="itemids" type="array|string|number">
            /// ['17652|1','17653|1']   is [ID | Copies,ID | Copies]  or 17652  is ID or '17651|1' is ID | Copies
            /// </param>
            /// <param name="isMagazine" optional="true "type="boolean"/>
            var me = this;

            var _items = [];
            if (typeof itemids == "object") {
               _items = itemids;
            }
            if (typeof itemids == "number") {
               _items.push(itemids + "|1");
            }
            if (typeof itemids == "string") {
               if (itemids != "")
                  _items.push(itemids);
            }
            if (_items.length < 1)
               return;

            if (Util.IsLogin) {
               var sLibarayID = "";
               if (searchLibraryID) {
                  sLibarayID = searchLibraryID;
               } else {
                  sLibarayID = getLibraryID();
               }
               if (!Util.AllowReserveForRegisteredPatron && Util.IsRegisteredPatron) {
                  Util.alert("Permission denied", Util.lang_NoReservePermission);
                  return;
               }
               if (Util.IsRMEnabled && $.inArray(sLibarayID, Util.RMLibraryIDList) > -1) {
                  if (parseInt("0")) {
                     Util.show_PatronBookPlus(sender, itemids, null, null, searchLibraryID);
                  }
                  else {
                     Util.alert("Invalid", "There are no copies in resource center.");
                  }
                  return;
               } else if ("0" == "1") {
                  Util.alert("Permission denied", "You do not have the permission."); //add by futao 2014-7-1 ver:6.4.0
                  return;
               }

               oPatronBook.showWindow(sender, itemids);

            } else {
               Util.showLogin(sender, itemids, "b", null);
            }
         }
      }
   </script>
<script>
   var itemNotesImageUrl = "/Library/Images/system/ItemNotes.png";
   function showAviailability(id, tabIndex, isFromEbook, containerid, isDialog, callback, selectedLibraryID, isSearchResultList) {
     
      if ($("#" + containerid)[0]) {
         var container = $("#" + containerid);
         if (isDialog) container.html("");
         if (!selectedLibraryID) selectedLibraryID = "";
         if (!isSearchResultList) isSearchResultList = false;
         $.post(Util.RootHomeFolder + "/ItemDetail_GetAvailabilityCopyValues",
            { id: id, tabIndex: tabIndex, copyType: 0, isFromEbook: isFromEbook, selectedLibraryID: selectedLibraryID, isDialog: isDialog, isSearchResultList: isSearchResultList },
            function (data) {
               if (data.IsEbook) {
                  if (isDialog) {
                     $("#tipAvailabilityWin").data("kendoWindow").open();
                     $("#tipAvailabilityWin").data("kendoWindow").center();
                  }
                  if (isDialog) {
                     container.html("<div id=\"aviliableDetailCopyInfoPanel\" class=\"copiesTable\" style=\"padding:5px;\">" + data.EBookHTML + "</div>");
                  }
                  else {
                     container.html("<div id=\"aviliableDetailCopyInfoPanel\" style=\"padding:5px;\">" + data.EBookHTML + "</div>");
                  }
                  if (callback) callback();
               }
               else {
                  if (data.Copies != null && data.Copies.length > 0) {
                     if (isDialog) {
                        $("#tipAvailabilityWin").data("kendoWindow").open();
                        $("#tipAvailabilityWin").data("kendoWindow").center();
                     }
                     var itemType = data.Copies[0].ItemType;
                     var isMagazine = data.Copies[0].IsMagazine;
                     var commonWidth = 10;
                     if (parseInt(data.Captions.ShowCheckoutInfoInOPACAvailability) == 1
                        && parseInt(data.Captions.SiteBasedCopyCollectionType) > 0)
                        commonWidth = 8;
                     else if (parseInt(data.Captions.ShowCheckoutInfoInOPACAvailability) == 1
                        || parseInt(data.Captions.SiteBasedCopyCollectionType) > 0)
                        commonWidth = 9;
                    
                     var colspan = 10;
                     if (isDialog) colspan = 8;
                     if (parseInt(data.Captions.ShowCheckoutInfoInOPACAvailability) == 1
                        && parseInt(data.Captions.SiteBasedCopyCollectionType) > 0) colspan = colspan + 2;
                     else if (parseInt(data.Captions.ShowCheckoutInfoInOPACAvailability) == 1
                        || parseInt(data.Captions.SiteBasedCopyCollectionType) > 0) colspan = colspan + 1;
                     if (data.ShowCopyNotesInAvailability) {
                        commonWidth = commonWidth - 1;
                        colspan = colspan + 1;
                     }
                     
                     var headerObj = {
                        VolumnDisplay:(itemType == "S" ? true : false),
                        CallNoCap: data.Captions.CallNoCap,
                        BarcodeCap: data.Captions.BarcodeCap,
                        DueDateCap: data.Captions.DueDateCap,
                        StatusCap: data.Captions.StatusCap,
                        LocationCap: data.Captions.LocationCap,
                        VolumnCap: isMagazine ? data.Captions.VolumnCap2 : data.Captions.VolumnCap1,
                        CopyVolumnCap: data.Captions.VolumeCap,
                        isDialog: isDialog,
                        CheckoutByCap: data.Captions.CheckoutByCap,
                        GenreCap: data.Captions.GenreCap,
                        ShowCheckoutInfoInOPACAvailability: (parseInt(data.Captions.ShowCheckoutInfoInOPACAvailability) == 1 ? true : false),
                        commonwidth: commonWidth,
                        showGenre: (parseInt(data.Captions.SiteBasedCopyCollectionType) > 0),
                        ReserveCopyHeader: data.Captions.ReserveCopyHeader,
                        BookHeader: data.Captions.BookHeader,
                        CopyNotesCap: data.Captions.CopyNotesCap,
                        ShowCopyNotes: data.ShowCopyNotesInAvailability
                     }
                     var headerTemplate = kendo.template($("#copyHeaderTemplate").html());
                     var previewHtml = "<table style=\"width:100%;border-collapse:collapse;\">" + headerTemplate(headerObj);
                     var copyTemplate = kendo.template($("#copyTemplate").html());
                     var copyLibraryTemplate = kendo.template($("#copyLibraryTemplate").html());
                     var librariesCount = 0;
                     var prevLibrary = "";
                     for (var ri = 0; ri < data.Copies.length; ri++) {
                        var copy = data.Copies[ri];
                        copy.ShowCopyNotes = data.ShowCopyNotesInAvailability;
                        if (copy.LibraryName == "") {
                           var notes = copy.Notes;
                           var ShortNotesName = copy.Barcode;
                           if (notes != null && notes != "") {
                              strNotesHTML = "<img alt='show " + ShortNotesName + "'s notes' id='imgbtn_" + ShortNotesName + "' style='cursor:pointer;' src='" + itemNotesImageUrl + "' onclick='Util.show_Notes(this, \"" + ShortNotesName + "\");return false;'/>";
                           }
                           else {
                              strNotesHTML = "&nbsp;";
                           }
                           copy.displayNotesimg = strNotesHTML;
                           var OneCopyStyleCss = (copy.RowNum % 2) != 0 ? "style=\"background-color:rgb(242, 246, 248);\"" : "";
                           var ClassStatusCss = ((copy.Status == null || copy.Status == "") ? 0 : copy.Status) == 5 ? "c3" : "c4";
                           if (isDialog) {
                              OneCopyStyleCss = ((copy.Status == null || copy.Status == "") ? 0 : copy.Status) == 5 ? "class='c31'" : OneCopyStyleCss;
                              ClassStatusCss = ClassStatusCss == "c3" ? "c2" : ClassStatusCss;
                           }
                           copy.OneCopyStyle = OneCopyStyleCss;
                           copy.ClassStatus = ClassStatusCss;
                           copy.isDialog = isDialog;
                           if (isDialog) {
                              copy.CanReserveCopy = false;
                              copy.CanBook = false;
                           }
                           else {
                              copy.CanReserveCopy = (parseInt(data.Captions.AllowReserveCopy) == 1 && copy.CanReserveCopy);
                           }
                           copy.ShowCheckoutInfoInOPACAvailability = (parseInt(data.Captions.ShowCheckoutInfoInOPACAvailability) == 1 ? true : false);
                           copy.showGenre = (parseInt(data.Captions.SiteBasedCopyCollectionType) > 0);
                           copy.commonwidth = commonWidth;
                           copy.colspan = colspan;
                           previewHtml += copyTemplate(copy);
                        }
                        else {
                           copy.isDialog = isDialog;
                           copy.colspan = colspan;
                           previewHtml += copyLibraryTemplate(copy);
                        }
                     }
                     previewHtml += "</table>";
                     container.html(previewHtml);
                     if (callback) callback();
                  }
                  else {
                     if (!isDialog) 
                        container.html("<div style='margin:10px auto; text-align:center; padding:50px; color:red'>" + data.Captions.NoAvailabilityCap + "</div>");
                     else  
                        Util.alert("", data.Captions.NoAvailabilityCap); 
                     if (callback) callback();
                  }
               }
            });
      }
   }

   function showAviailabilityDialog(id, tabIndex, title, isFromEbook) {
      if (!title) title = "";
      if (!isFromEbook) isFromEbook = false;
      $("#tipAvailabilityWin").data().id = id;
      $("#tipAvailabilityWin").data().tabIndex = tabIndex;
      $("#tipAvailabilityWin").data().isFromEbook = isFromEbook;
      //$("#tipAvailabilityWin").data("kendoWindow").open();
      //$("#tipAvailabilityWin").data("kendoWindow").center();
      $("#tipAvailabilityWin").data("kendoWindow").title(title);
      showAviailability(id, tabIndex, isFromEbook, "tipAvailabilityWin_content", true);
   }

   function onAvailabilityDialogOpen(e) {
      var id = this.element.data().id;
      var tabIndex = this.element.data().tabIndex;
      var isFromEbook = this.element.data().isFromEbook;
      showAviailability(id, tabIndex, isFromEbook, "tipAvailabilityWin_content", true);
   }

   function showNotes(sender, strNotesName) {
      if ($('#Notesdiv_' + strNotesName)) {
         if ($('#Notesdiv_' + strNotesName).css("display") == "none") {
            $('#Notesdiv_' + strNotesName).css("display", "");
         } else {
            $('#Notesdiv_' + strNotesName).css("display", "none");
         }
      }
   }

   $(document).ready(function () {
      Util.showAvailabilityCopyDialog = showAviailabilityDialog;
      Util.show_Notes = showNotes;
   });
</script>
<style>
   .copyheadercell
   {
      padding:5px 0 5px 0;
      font-weight:bold;
      
   }
   .copyLibrarycell
   {
      padding:5px 0 5px 0;
      border-top:1px dashed #d8d7d7;
   }
   .copycell
   {
      padding:4px 0 4px 0;
      border-top:1px dashed #d8d7d7;
   }
</style>
<div id="tipAvailabilityWin" style="display:none">
<div id="tipAvailabilityWin_content" class="itemDetailInSomeLocations" style="width: 100%; min-height: 240px; max-height: 400px; float:none;">
</div>
</div><script>
	jQuery(function(){jQuery("#tipAvailabilityWin").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Availability","resizable":false,"width":760,"actions":["Close"]});});
</script>

<script type="text/x-kendo-tmpl" id="copyHeaderTemplate">
   <tr style="display:table-row;background-color:rgb(242, 246, 248);color:rgb(68, 68, 68);border-top:none;">
      <td class="copyheadercell" style="width:2%;">&nbsp;</td>
      #if (!isDialog) {#
      <td class="copyheadercell" style="width:#=commonwidth#%;text-align:left;">#=CallNoCap#</td>
      #} else {#
      <td class="copyheadercell" style="width:#=commonwidth+6#%;text-align:left;">#=CallNoCap#</td>
      #}#
      <td class="copyheadercell" style="text-align:left;">&nbsp;
      #if (VolumnDisplay) {#
      #=VolumnCap#
      #}#
      </td>
      <td class="copyheadercell" style="width:#=commonwidth#%;text-align:left;">#=StatusCap#</td>
      #if (!isDialog) {#
      <td class="copyheadercell" style="width:#=commonwidth#%;text-align:left;">#=LocationCap#</td>
      #} else {#
      <td class="copyheadercell" style="width:#=commonwidth+6#%;text-align:left;">#=LocationCap#</td>
      #}#
      #if (showGenre) {#
      <td class="copyheadercell" style="width:#=commonwidth#%;text-align:left;">#=GenreCap#</td>
      #}#
      #if (ShowCopyNotes) {#
      <td class="copyheadercell" style="text-align:left;width:#=commonwidth#%;"><label>#=CopyNotesCap#</label></td>
      #}#
      <td class="copyheadercell" style="text-align:left;">
      #=CopyVolumnCap#     
      </td>
      <td class="copyheadercell" style="width:#=commonwidth#%;text-align:left;">#=DueDateCap#</td>
      #if (ShowCheckoutInfoInOPACAvailability) {#
      <td class="copyheadercell" style="width:#=commonwidth#%;text-align:left;">#=CheckoutByCap#</td>
      #}#
      #if (!isDialog) {#
         <td class="copyheadercell" style="width:11%;text-align:center;">#=ReserveCopyHeader#</td>
         <td class="copyheadercell" style="width:11%;text-align:center;">#=BookHeader#</td>
      #}#
      <td class="copyheadercell" style="width:15%;text-align:center;">#=BarcodeCap#</td>
   </tr>
</script>
<script type="text/x-kendo-tmpl" id="copyLibraryTemplate">
   #if (RowNum % 2 != 0) {#
   <tr style="background-color:rgb(242, 246, 248);border-top:1px dashed rgb(216, 215, 215);">
   #}else{#
   <tr style="border-top:1px dashed rgb(216, 215, 215);">
   #}#
      <td colspan="#=colspan#" class="copyLibrarycell" style="width:100%;border-top-width:0;" >
         &nbsp;&nbsp;(#=LibraryIn# Of #=LibraryCount# available in <strong>#=LibraryName#</strong> )
         #if (!isDialog && CanReserveCopy) {#
         <a class="ItemAvilibleInfoLink" href = "javascript:void(0);" onclick="if (parent) parent.Util.show_ReserveCheck(this, #=ItemID#, null, '#=LibraryID#','#=LibraryID#')">#=ReserveCopyCap#</a>
         #}#
      </td>
   </tr>
</script>

<script type="text/x-kendo-tmpl" id="copyTemplate">
   <tr #=OneCopyStyle#>
      <td class="copycell" style="width:2%;"><div id="Notesimgdiv">#=displayNotesimg#</div></td>
      #if (!isDialog) {#
      <td class="copycell" style="width:#=commonwidth#%;">#=CallNo#</td>
      #} else {#
      <td class="copycell" style="width:#=commonwidth+6#%;">#=CallNo#</td>
      #}#
      <td class="copycell" style="">&nbsp;
      #if (ItemType == "S") {#
      <span class="Infofont2">#=Volume#</span>
      #}#
      </td>
      <td class="copycell" style="width:#=commonwidth#%;"><span class="#=ClassStatus#">#=StatusCaption#</span></td>
      #if (!isDialog) {#
      <td class="copycell" style="width:#=commonwidth#%; overflow:hidden; text-overflow:ellipsis;" title="#=Location#">#=Location#</td>
      #} else {#
      <td class="copycell" style="width:#=commonwidth+6#%; overflow:hidden; text-overflow:ellipsis;" title="#=Location#">#=Location#</td>
      #}#
      #if (showGenre) {#
      <td class="copycell" style="width:#=commonwidth#%;text-align:left;">#=Genre#</td>
      #}#
      #if (ShowCopyNotes) {#
      <td class="copycell" style="text-align:left;width:#=commonwidth#%;">#=CopyNotes#</td>
      #}#
      <td class="copycell" style="width:#=commonwidth#%;">
      #=CopyVolume#
      </td>
      <td class="copycell" style="width:#=commonwidth#%;">#=DueDate#</td>
      #if (ShowCheckoutInfoInOPACAvailability) {#
      <td class="copycell" style="width:#=commonwidth#%;text-align:left;">#=PatronName#</td>
      #}#
      #if (!isDialog) {#
      <td class="copycell" style="width:11%;">
         #if (CanReserveCopy) {#
         <a href="javascript:void(0);" class="ItemAvilibleInfoLink" onclick="if (parent) parent.Util.show_ReserveCheck(this,#=ItemID#,'#=Barcode#',null,'#=LibraryID#');return false;" >#=ReserveCopyCap#</a>
         #}else{# &nbsp; #}#
      </td>
      #}#
      #if (!isDialog) {#
      <td class="copycell" style="width:7%;text-align:center;">
         #if (CanBook) {#
         <a href="javascript:void(0);" class="ItemAvilibleInfoLink" onclick="if (parent) parent.Util.show_PatronBook(this,{CopyKey:'#=CopyKey#', Barcode:'#=Barcode#', intStatus:#=Status#,Status:'#=StatusCaption#', CheckoutDate: #=DueDateObj#, LibraryID:'#=LibraryID#', ItemID:#=ItemID#, ItemType:'#=ItemType#', t03IssueIdentifier:#=t03IssueIdentifier# },null,'#=BelongToLibraryID#');return false;">#=BookCap#</a>
         #}else{# &nbsp; #}#
      </td>
      #}#
      <td class="copycell" style="width:15%;text-align:center">#=Barcode#</td>
   </tr>
   <tr>
      <td colspan="#=colspan#" id="Notesdiv_#=Barcode#" style="width:100%;display:none" >
         <div style="height: auto; padding-top: 2px;">
            <fieldset class="fieldset" style="width:94%;margin:0 auto;">
               <legend class="legendShow">Notes</legend>
               <span class="Infofont2">#=Notes#</span>
            </fieldset>
         </div>
      </td>
   </tr>
</script>
   <script type="text/x-kendo-tmpl" id="marcTemplate">
        <div #=OneRowStyle#>
            <div class="itemdetailtabrowcell" style="width:10%;#=TagStyle#">
                #=Tag#
            </div>
            <div class="itemdetailtabrowcell" style="width:90%;max-width:653px;word-wrap:break-word;#=ValueStyle#">
                #=Value#
            </div>
        </div>
   </script>
   <script type="text/x-kendo-tmpl" id="reviewTemplateOld">
        <div class="reviewBox">
            <div class="reviewInner">
                <div class="userInfo"><span class="reviewLabel">#=ReviewedbyCap#:</span><span class="reviewText"><span class="c7">#=PatronName#</span></span> </div>
                <div class="reviewDate">#=Date#</div>
            </div>
            <div class="reviewInner"><span class="reviewLabel">#=RateCap#:</span><span>#=StarsHTML#</span></div>
            <div class="reviewInner"><span class="reviewLabel">#=TagCap#:</span><span class="reviewText">#=Tag#</span></div>
            <div class="reviewInner"><span class="reviewLabel">#=ReviewCap#:</span><span class="reviewText">#=ReviewInfo#</span></div>
        </div>
   </script>
   <script type="text/x-kendo-tmpl" id="reviewTemplate">
     <div #=OneRowStyle# class="reviewBox">
      <div class="flexlayout">
      <div style="flex: 0 0 auto; -webkit-flex: 0 0 auto;margin:10px"><span class="loginIcon" ></span></div>
      <div style="flex: 1; -webkit-flex: 1;">
         <div class="reviewInner">
            <div class="userInfo"><span class="reviewText"><span style="font-weight:bold;font-size:larger" class="c7">#=PatronName#</span></span></div>                
         </div>
         <div class="reviewInner"><span>#=StarsHTML#</span>&nbsp&nbsp<div class="reviewDate" style="float:none;text-align:left;width:auto;">#=Date#</div></div>
         <div class="reviewInner"><span class="reviewText" style="width:99.9%">#=ReviewInfo#</span></div>
      </div>
      </div>
    </div>
   </script>
   <script type="text/x-kendo-tmpl" id="additionalTemplate">
        <div #=OneRowStyle#>
            <div class="itemdetailtabrowcell" style="width:40%;#=BorderStyle#">
                <span #=OneHeaderStyle#>#=Title#</span>
            </div>
            <div class="itemdetailtabrowcell" style="width:45%;#=BorderStyle#">
                <span #=OneHeaderStyle#>#=Location#</span>
            </div>
            <div class="itemdetailtabrowcell" style="width:15%;#=BorderStyle#">
                <span #=FileTypeHeaderStyle#>#=FileType#</span>
            </div>           
        </div>
   </script>
   <script type="text/x-kendo-template" id="overdriveInfoTemplate">
        <div style="margin: 6px 9px 0px 0px; float: right;">
            <input type="button" class="#=buttonClass#" value="#=buttonValue#" onclick="#=operatorFun#('#=id#');" />
        </div>
        <div style="margin: 5px 0px 0px 15px;">
            <span><span class="blueFont" style="font-weight:bold;">eBook Availability</span></span>
            <span style='margin: 5px 0px 0px; display: block;'>#=copiesInfo#<span></span></span>
        </div>
   </script>
   <script type="text/x-kendo-template" id="overdriveMagazineInfoExceptButtonTemplate"> 
   
      <div id="divOverdriveMagazineIssues#=divID#" class="flexlayout overdriveIssueContent">  
         <div style="flex:0 0 10px;-webkit-flex:0 0 10px;"></div>
         <div> <img style="max-height:80px;width:50px;" src="#=imagesCoverHref#" alt="#=title#" title="#=title#"> </div>
         <div style="flex:0 0 10px;-webkit-flex:0 0 10px;"></div>
         <div id="divAvailability_#=divID#" class="flexlayoutcol" style="flex:1;-webkit-flex:1; margin-top:7px;">  </div> 
         <div style="flex:1;-webkit-flex:1;margin-top:7px;">
            <span>#=Edition_Cap#</span>
            <span class="blueFont">#=edition#</span>
         </div> 
         <div id="divButtonOverdriveMagazineIssues#=divID#" style="flex:0 0 130px;-webkit-flex:0 0 130px;"> </div>
         <div style="flex:0 0 10px;-webkit-flex:0 0 10px;"></div>
      </div>
  
   </script>
   <script type="text/x-kendo-template" id="overdriveMagazineInfoButtonTemplate"> 
      <button id="btnOverdriveMagazineIssue#=id#" class="#=buttonClass#" style="width:100%;" onclick="#=operatorFun#('#=id#');">#=buttonValue#</button> 
   </script>
<script type="text/javascript">
   var curTypeIndex = parseInt("3");
   var subTabIndex = parseInt("0");
   var backToSearchUrl = $('<div/>').html("").text();
   var o = {
      "message_59791": "Required date cannot be less than today&#39;s date.",
      "message_59792": "Required until cannot be less than required date.",
      "message_80021": "This copy&#39;s not In. {%1} cannot be less than its due date {%2}.~Incorrect Date",
      "message_91025": "Cannot place reserve. This copy&#39;s current status is {%1}.~Invalid Selection",
      "message_80004": "{%1} is marked as &quot;Deleted&quot;. You cannot do anything before changing its status.~Invalid Operation",
      "title": "Booking"
   };
   if (typeof oPatronBook === "undefined") {
      oPatronBook = new PatronBook(o);
   }

   function setParentTabPanels(selectedTab, tabIndex) {
      if (document.getElementById("allTabPanels") != null) {
         var allTabs = document.getElementById("allTabPanels").getElementsByTagName("a");

         for (var i = 0; i < allTabs.length; i++) {
            if (i == 0 || i == allTabs.length - 1)
               allTabs[i].className = "base normal";
            else
               allTabs[i].className = "base middle";
         }
         if (selectedTab) {
            selectedTab.className = "base on";
         } else {
            if ($("#subTab" + tabIndex)[0])
               $("#subTab" + tabIndex).attr("class", "base on");
         }
      }
   }

   function getID() {
      var url = window.location.search;
      var id = 0;
      var param = null;
      if (url.length > 0 && url.split('?').length > 1) {
         param = url.split('?')[1];
      }
      if (param != null) {
         id = parseInt(param.getQueryStringValue("i"));
      }
      return id;
   }

   function getLibraryID() {
      var url = window.location.search;
      var libraryID = "All";
      var param = null;
      if (url.length > 0 && url.split('?').length > 1) {
         param = url.split('?')[1];
      }
      if (param != null) {
         libraryID = param.getQueryStringValue("l");
      }
      return libraryID;
   }

   function getTabIndex() {
      var url = window.location.search;
      var idx = 0;
      var param = null;
      if (url.length > 0 && url.split('?').length > 1) {
         param = url.split('?')[1];
      }
      if (param != null) {
         idx = parseInt(param.getQueryStringValue("ti"));
      }
      return idx;
   }

   function showLoadMask(show) {
      if (show == 1) {
         kendo.ui.progress($("#ItemDetailTabsIframeDiv"), true);
      }
      else {
         kendo.ui.progress($("#ItemDetailTabsIframeDiv"), false);
      }
   }

   function iFrameHeight() {
      var ifm = document.getElementById("iframe_SyndeticsContent");
      var subWeb = document.frames ? document.frames["iframe_SyndeticsContent"].document : ifm.contentDocument;
      if (ifm != null && subWeb != null) {
         ifm.height = subWeb.body.scrollHeight;
      }
   }
   $(document).ready(function () {
      if (typeof saveMarc2014 != "undefined")
         Util.saveMarc2014 = saveMarc2014;
      if (typeof overDriveCheckout != "undefined")
         Util.overDriveCheckout = overDriveCheckout;
      if (typeof overDriveHold != "undefined")
         Util.overDriveHold = overDriveHold;
      var urls = window.location.search; //add by futao 2014-8-26 ver:6.4.3
      if ($("#allTabPanels") && $("#allTabPanels").length == 1) {
         showLoadMask(1);
         addShow_PatronBook();
         if (curTypeIndex == 8 || curTypeIndex == 10) {
            subTabIndex = subTabIndex == 0 ? 1 : subTabIndex;
         }
         changeTab(subTabIndex);
         setParentTabPanels(null, subTabIndex);
      }
      Util.getSearchUrl = getSearchUrl;
      if (curTypeIndex == 8) {
         $("#onlineDBs").css("display", "");
         $("#btnLibraries").css("display", "none");
         $("#cboLibraries").css("display", "none");
         $("#hifs").val(1);
      }
      else if (curTypeIndex == 17) {
         $("#hifs").val(5);
      }
      else if (curTypeIndex == 18) {
         $("#hifs").val(6);
      }
      if ($("#currentVideo").length == 1) {
         var id = getID();
         loadDigitalChapters(id);
      }
      Util.afterLoginCheckAdd($(document.body));
   });

   function itemNavigation(id, libaryID, navTypeIndex, projectID, subsetID, searchGuid) {
      libaryID = libaryID.replace(/%23/g, "'");
      var newURL = "ItemDetail?l=" + encodeURIComponent(libaryID)
         + "&i=" + id + "&ti=" + navTypeIndex;
      if ($.isNumeric(projectID) && projectID > 0) {
         newURL += "&ProID=" + projectID;
      }
      if ($.isNumeric(subsetID) && subsetID > 0) {
         newURL += "&subid=" + subsetID;
      }
      if (searchGuid) {
         newURL += "&searchguid=" + searchGuid;
      }
      window.location.href = newURL;
   }

   function getSearchUrl(typeIndex, id) {
      if (typeIndex == 0 || typeIndex == 6 || typeIndex == 7 || typeIndex == 8 || typeIndex == 9 || typeIndex == 10
         || typeIndex == 11 || typeIndex == 12 || typeIndex == 13 || typeIndex == 14 || typeIndex == 15 || typeIndex == 16
         || typeIndex == 17 || typeIndex == 18) {
         var a = "";
         if (typeIndex == 6 || typeIndex == 16)
            a = "MyFavorites";
         else if (typeIndex == 7)
            a = "AdvancedSearch?";
         else if (typeIndex == 11)
            a = "Project?";
         else if (typeIndex == 12)
            a = "RecommededList";
         else if (typeIndex == 14)
            a = "TextbooksResult";
         else if (typeIndex == 15)
            a = "Mediagraphy";
         else
            a = "SearchResult";
         window.location.href = a + backToSearchUrl;
      } else if (typeIndex >= 21 && typeIndex <= 27) {
         window.location.href = "Kiosk" + backToSearchUrl;
      } else if (typeIndex > 0 && typeIndex < 6) {
         window.location.href = "Home";
      } else {
         window.location.href = "Home";
      }
   }

</script>
<style>
   .itemdetailtabrowcell {
      padding: 4px 0 4px 0;
      display: table-cell;      
   }

      .itemdetailtabrowcell span {
         display: inline-block;
      }

   .itemdetailtabrow {
      display: table-row;
   }

   .itemDetailPage {
      width: 962px;
   }

   #digitalContent {
      padding: 0;
   }

      #digitalContent .tabPanels {
         width: 686px;
      }

   #divDigitalChapters_ItemDetail {
      width: 680px;
   }  

   .fullWidth .itemDetailPage {
      width: calc(100% - 20px);
      min-width: 962px;
   }
   /*.fullWidth #itemDetailRight
   {
     width: calc(60% - 4px);
     float:left;
   }*/
   .fullWidth .itemDetailContent .tabPanels {
      width: 100%;
   }

   .fullWidth .itemDetailContent .copiesTable, .fullWidth #imageCoverDetailContent {
      width: calc(100% - 2px);
   }

   .fullWidth #divDigitalChapters_ItemDetail {
      width: calc(100% - 6px);
   }

   .left-arrow {
      display: inline-block;
      content: " ";
      height: 6px;
      width: 6px;
      border-width: 0 0 2px 2px;
      border-color: #ffffff;
      border-style: solid;
      transform: matrix(0.71, 0.71, -0.71, 0.71, 0, 0);
      margin-left: 5px;
      margin-bottom: 1px;
   }

   .line {
      display: inline-block;
      content: " ";
      height: 2px;
      width: 12px;
      margin: 0 8px 4px -13px;
   }

   .right-arrow {
      display: inline-block;
      content: " ";
      height: 6px;
      width: 6px;
      border-width: 2px 2px 0 0;
      border-color: #ffffff;
      border-style: solid;
      transform: matrix(0.71, 0.71, -0.71, 0.71, 0, 0);
      margin-right: 5px;
   }
   
   .overDriveMagazineConent{ max-height:420px; position:relative;}
   .overdriveIssueContent { margin: 0px 0px 0px 0px; padding:5px 0; flex: 0 0 70px; -webkit-flex: 0 0 70px; border: dashed 1px #d3d4d8;  border-width: 0 0 1px 0;}  
   .overDriveMagazineConent .overdriveIssueContent:nth-child(odd) { }
   .overDriveMagazineConent .overdriveIssueContent:nth-child(even) { background-color:#f6f8fa;}
   .overDriveMagazineConent .overdriveIssueContent img{border-radius:5px;}
   .overdriveMagazineIssuesMore{ margin-top:10px; flex:0 0 25px; -webkit-flex:0 0 25px;justify-content: center;-webkit-justify-content: center;}
</style>

<div class="itemDetailPage" style="margin: 0 auto;">
   <div class="navigationbar">
      <span class="endnav">Item Detail Information</span>
   </div>
   <div class="itemDetailNav flexlayout">
      <div id="itemDetailLeft" style="flex: 0.5; -webkit-flex: 0.5; padding: 1px;" class="itemDetailContent flexlayoutcol">
         <div class="itemDetailNav flexlayout" style="margin-bottom: 5px; flex: 0 0 auto; -webkit-flex: 0 0 auto;">
            <div class="itemDetailGoBack">
               <button class="base-border" style="width: 220px;height: 28px;padding: 0 7px;background-color: white;color: #2f2f2f;"
                       onclick="Util.getSearchUrl(3);return false;">
                  <span class="left-arrow" style="border-color: #2f2f2f;"></span>
                  <span class="line" style="background-color: #2f2f2f;"></span>
                  <span>Back&nbsp;To&nbsp;Home</span>
               </button>
            </div>

            <div class="itemDetailNavbtn">
            </div>
         </div>
         <hr />
         <div class="flexlayoutcol" style="background-color: white; padding: 5px; flex: 0 0 auto; -webkit-flex: 0 0 auto;">
            <div style="flex: 0 0 auto; -webkit-flex: 0 0 auto;" class="flexlayout">
               <!--image column-->
               
               <div class='itemImageSide' style='width:150px;'>
                  <div class='itemImageCover' style='width:140px;'>
                     <table style='width:140px; height:230px;'>
                     <tr><td style='position:relative;'>     
                     <div style='vertical-align:top;text-align:center;height:224px' class='item_image_normal'>
                     <img src='/Library/images/~imageCI95309.JPG' id='img_95309' alt='Calculus : Early Transcendentals Single Variable.'  title='Calculus : Early Transcendentals Single Variable.' style='max-Height:210px;max-Width:136px'/>
                     </div>
                     <div class='materialTypeForItemDetail blueFont' title='Book' style='font-weight:bold;Width:130px'>Book</div>
                     </td></tr></table>         
                  </div>
               </div>

               <!--book detail-->
               <div class='itemDetailSide' style='flex: 1; -webkit-flex: 1; margin:0 3px'>    
      <div class='itemHeader' style='width:95%' >Calculus : Early Transcendentals Single Variable.</div>
      
       
      <div class='itemMessageBox' style='width:95%'>         
         <div style='width:99%' class='infoBox' >
                  <div id='lblRatingTitle95309'  class='showLeft' style='display:none'>Rating:</div>
                  <div class='showRight'> <span id="star95309" class="starWrapper"> </span><a href='javascript:void(0);' onclick='javascript:Util.show_AddRating(this,95309, "star95309", "lblRatingTitle95309");return false;'>Rate This Title</a>&nbsp;&nbsp;</div>
                     </div>        
         <div style='width:99%' class='infoBox' >
            <div class='showLeft'>Copies</div>
            <div class='showRight c2'>13 Total&nbsp;copies, <span class='c3'>13</span>  <span>Copies&nbsp;are&nbsp;in</span>,
               <span class='c4'>0</span>  <span >Copies&nbsp;are&nbsp;out</span>.
            </div>
         </div>
      </div>
      <div class='itemDetailTool1' style='margin-left:0;margin-top:3px;width:95%;'>
      <ul>
      <li style='margin-right:10px;list-style:none; width:115px; display:;'><button class='btnWithSprite btnBookShelf' style='width:110px;' onclick='Util.showShelfList(95309);return false;'>Shelf&nbsp;List<span class='btnSprite'></span></button></li>
      <li style='margin-right:10px;list-style:none; width:105px; display:;'><button class='btnWithSprite btnMapLocation' style='width:100px;' onclick='Util.showLibraryMap(95309);return false;'>Locate&nbsp;It<span class='btnSprite'></span></button></li>
      <li style='margin-right:10px;list-style:none; width:105px; display:none;'><button class='btnWithSprite btnText' style='width:100px;' onclick='Util.textItToMe("",this,"95309");return false;'>Text&nbsp;Me<span class='btnSprite'></span></button></li>
      <li style='margin-right:10px;list-style:none; width:125px; display:;'><button id='btnAddReview_ItemDetail' class='btnWithSprite btnAddReview' style='width:120px;' onclick='Util.show_AddReview(this,95309,"star95309","lblRatingTitle95309");return false;'>Add&nbsp;Review<span class='btnSprite'></span></button></li>
      <li style='margin-right:10px;list-style:none; width:115px; display:none;'><button class='btnWithSprite btnSaveMarc' style='width:110px;' onclick='Util.saveMarc2014(95309);return false;'>Save&nbsp;MARC<span class='btnSprite'></span></button></li>
      <li style='margin-right:10px;list-style:none; width:150px; display:;'><button class='btnWithSprite btnAddToFavorite' style='width:145px;' onclick='Util.addtofav(95309, null);return false;' >Add&nbsp;To&nbsp;Favourites<span class='btnSprite'></span></button></li>
      
      
      
      </ul>
      </div><span style='width:95%;max-height:85px;overflow:auto; float:left;padding:3px;word-wrap:break-word;white-space:pre-wrap;'>Calculus: Early Transcendentals, 10th Edition continues to evolve to fulfill the needs of a changing market by providing flexible solutions to teaching and learning needs of all kinds. Calculus: Early Transcendentals, 10th Edition excels in increasing student comprehension and conceptual understanding of the mathematics.  The new edition retains the strengths of earlier editions: e.g., Anton's trademark clarity of exposition; sound mathematics; excellent exercises and examples; and appropriate level, while incorporating more skill and drill problems within WileyPLUS. 

The seamless integration of Howard Anton's Calculus: Early Transcendentals, 10th Edition with WileyPLUS, a research-based, online environment for effective teaching and learning, continues Anton's vision of building student confidence in mathematics because it takes the guesswork out of studying by providing them with a clear roadmap: what to do, how to do it, and whether they did it right.
</span><div class='itemDetailTool3' style='margin-bottom:2px;width:95%'>
         <ul>
         <li style='margin-top:2px' ><span>Share&nbsp;It:</span></li>
         <li><a target="_blank" href="http://www.pinterest.com/pin/create/button?url=https://nu.insigniails.com/library/ItemDetail?l=All&i=95309&media=https://nu.insigniails.com/library/Library/Images/~imageCI95309.JPG&description=Calculus%20%3A%20Early%20Transcendentals%20Single%20Variable."><img src="//assets.pinterest.com/images/pidgets/pin_it_button.png" alt="Pinterest" /></a></li>
         <li></li>
         <li></li>
         <li></li>
         <li style='margin-top:2px' title='Google Classroom' ><g:sharetoclassroom size=16 url='https://nu.insigniails.com/library/ItemDetail?l=All&i=95309'></g:sharetoclassroom></li>
         <li style='margin-top:2px' ><div class="addthis_inline_share_toolbox" style="width:75px;"></div></li>
         </ul>
         </div> <div id='divGBSPreview' class='itemDetailTool3' style='margin-bottom:0px;width:95%'></div></div>

            </div>
            <div style="flex: 0 0 auto; -webkit-flex: 0 0 auto; margin: 3px" class="flexlayout">
               <div class='sideBar flexlayoutcol' style='flex: 1; -webkit-flex: 1;border:none'>
                     <div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Title</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>Calculus : Early Transcendentals Single Variable.</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Call No</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>515 ANT</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Edition</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>10th Edition.</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Authors</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'><a href='DoSearch?action=simple&l=All&t=Authors&k=%20Anton%2C%20Howard%2C%201991&c=c'> Anton, Howard, 1991</a><BR><a href='DoSearch?action=simple&l=All&t=Authors&k=Howard%20Anton%2C%201991&c=c'>Howard Anton, 1991</a><BR><a href='DoSearch?action=simple&l=All&t=Authors&k=Irl%20Bivens%2C%202002&c=c'>Irl Bivens, 2002</a><BR><a href='DoSearch?action=simple&l=All&t=Authors&k=Stephen%20Davis%2C%201952&c=c'>Stephen Davis, 1952</a></div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Subjects</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'><a href='DoSearch?action=simple&l=All&t=Subjects&k=Calculus%20%1D%40~%40%1D%20Textbooks.&c=c'>Calculus -- Textbooks.</a><BR><a href='DoSearch?action=simple&l=All&t=Subjects&k=Geometry%2C%20Analytic.&c=c'>Geometry, Analytic.</a><BR><a href='DoSearch?action=simple&l=All&t=Subjects&k=Department%20of%20Sciences%20and%20Humanities.&c=c'>Department of Sciences and Humanities.</a></div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Language</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>English</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Content Type</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>text</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Media Type</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>unmediated</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Carrier Type</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>volume</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Published</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>Hoboken, NJ : Wiley, 2012.</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Publication Desc</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>xviii, 766 p : ill.</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>ISBN</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>9780470647684</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Target Audience</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;' class='sideBarText'>Specialized</div>
                     </div>
                     </div>
            </div>

         </div>
      </div>
      <div style="flex: 0 0 1px; -webkit-flex: 0 0 1px; background-color: darkgray; margin: 10px 20px 10px 10px; padding: 0px;"></div>
      <div class="itemDetailContent" id="itemDetailRight" style="flex: 0.5; -webkit-flex: 0.5; padding: 0px;">
         <div style="background-color: white; padding: 5px;">

            <!--tab panels-->
            
               <div style='height:34px;'>
               <div class='tabPanels' id='allTabPanels'>
                  <a id="subTab0" href="javascript:void(0);" class="base on" onclick="changeTab(0, this, false, false);return false;">Availability</a><a id="subTab1" href="javascript:void(0);" class="base middle" onclick="changeTab(1, this, false, false);return false;">Summary</a><a id="subTab2" href="javascript:void(0);" class="base middle" onclick="changeTab(2, this, false, false);return false;">MARC</a><a id="subTab3" href="javascript:void(0);" class="base middle" onclick="changeTab(3, this, false, false);return false;">Reviews</a><a id="subTab4" href="javascript:void(0);" class="base middle" onclick="changeTab(4, this, false, false);return false;">Cover&nbsp;Image</a><a id="subTab5" href="javascript:void(0);" class="base normal" onclick="changeTab(5, this, false, false);return false;">Additional Info</a>
               </div>
            </div>

            <!--iframeItemDetailTabs-->
            

               <div class="clear"></div>
               <div id="ItemDetailTabsIframeDiv" style="position: relative; min-width: 400px; min-height: 100px;">
                  <div class="itemDetailContent" style="padding: 0;">
                     <!--copies-->
                     <div class="copiesTable" id="copiesDetail" style="min-height: 90px; display: none;">
                        <div id="localCopiesDetail"></div>
                        <div id="overDriveEBook" style="display: none; border-top: 1px solid #c9c9ca; height: 45px;">
                           <img alt="loading" src="/Library/Images/Loading.gif" />
                        </div>
                     </div>
                     <!--Summary-->
                     <div class="copiesTable" id="SummaryDetail" style="display: none; min-height: 90px;border:none;">
                        <div style="padding: 5px">
                           <div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Summary Note</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;white-space:pre-wrap;' class='sideBarText'>Calculus: Early Transcendentals, 10th Edition continues to evolve to fulfill the needs of a changing market by providing flexible solutions to teaching and learning needs of all kinds. Calculus: Early Transcendentals, 10th Edition excels in increasing student comprehension and conceptual understanding of the mathematics.  The new edition retains the strengths of earlier editions: e.g., Anton's trademark clarity of exposition; sound mathematics; excellent exercises and examples; and appropriate level, while incorporating more skill and drill problems within WileyPLUS. 

The seamless integration of Howard Anton's Calculus: Early Transcendentals, 10th Edition with WileyPLUS, a research-based, online environment for effective teaching and learning, continues Anton's vision of building student confidence in mathematics because it takes the guesswork out of studying by providing them with a clear roadmap: what to do, how to do it, and whether they did it right.</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>General Note</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;white-space:pre-wrap;' class='sideBarText'>Anton, Bivens & Davis latest issue of Calculus Early Transcendentals Single Variable continues to build upon previous editions to fulfill the needs of a changing market by providing flexible solutions to teaching and learning needs of all kinds.</div>
                     </div><div class='flexlayout'>
                     <div style='flex: 0 0 auto; -webkit-flex: 0 0 auto;padding:3px;max-width: 200px;min-width:110px;line-height:16px' class='sideBarLabel'>Content Note</div>
                     <div style='flex: 1; -webkit-flex: 1;padding:3px;line-height:16px;white-space:pre-wrap;' class='sideBarText'>0.	Before Calculus 
1.	Limits And Continuity 
2.	The Derivative 
3.	Topics In Differentiation 
4.	The Derivative In Graphing And Applications 
5.	Integration 
6.	Applications Of The Definite Integral In Geometry, Science,And Engineering 
7.	Principles Of Integral Evaluation 
8.	Infinite Series
9.	Mathematical Modeling With Differential Equations 
10.	Parametric And Polar Curves; Conic Sections 
.</div>
                     </div>
                        </div>
                     </div>
                     <!--Marc-->
                     <div class="copiesTable" id="marcDetail" style="display: none; min-height: 90px;border:none;">
                        <div class="panelContent" id="marcDetailContent" style="display: table;">
                        </div>
                     </div>

                     <!--Review -->
                     <div id="reviewDetail" style="display: none; min-height: 90px;border:none;">
                        <div style="float:left;width:99%;padding:20px 0 10px 0">
                           <div style="float:right;width:auto">
                              <button id="btnWriteAReview_ItemDetail" class='btnWithSprite btnAddReview'
                                      style='min-width:120px;text-indent:initial;padding-right:3px;background-color:white;
                           font-weight:bold;color:#444;border:solid 1px darkgray;text-align:center'>
                                 Write a review
                        </button>
                     </div>
                  </div>
                  <div id="reviewDetailContent" class="panelContent" style="border:none">
                  </div>
               </div>

               <!--Image Cover text-align:left-->
               <div id="imageCoverDetail" style="display: none; min-height: 90px;border:none;">
                  <div class="panelContent" id="imageCoverDetailContent" style="text-align: center;">
                      <a href='javascript:void(0);' onclick='Util.pictureScale("/Library/images/~imageCI95309.JPG");' ><img alt='cover image' src='/Library/images/~imageCI95309.JPG' id='TestImg' /></a>
                  </div>
               </div>

               <!--Additional Info-->
               <div class="copiesTable" id="additionalInfo" style="min-height: 90px; display: none;border:none;">
                  <div class="panelContent" id="additionalInfoContent" style="display: table;">
                  </div>
               </div>

            </div>
         </div>
         <div class="clear3"></div>
         </div>
      </div>
         <script>
            var userId = "@insigniasftware";
            var addthis_share = {
               url: "https://nu.insigniails.com/library/ItemDetail?l=All&i=95309&ti=3&subid=0?l=All&i=95309",
               title: "Calculus : Early Transcendentals Single Variable.",
               description: " Anton, Howard, 1991.; Howard Anton, 1991.; Irl Bivens, 2002.; Stephen Davis, 1952. ",
               media: "https://nu.insigniails.com/library/Library/Images/~imageCI95309.JPG",
               templates: { twitter: '{{title}} \r\n {{description}} \r\n {{url}} ' }
            };
            var addthis_config = { services_compact: 'tumblr,reddit', services_expanded: 'tumblr,reddit' };

         </script>
         <script src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a2e2a104b7355e2"></script>
               <script src="https://apis.google.com/js/platform.js"></script>
               <script>
            function ProcessGBSBookInfo(_GBSBookInfo) {
               for (isbn in _GBSBookInfo) {
                  var b = _GBSBookInfo[isbn];
                  if (b && (b.preview == "full" || b.preview == "partial")) {
                     $("#divGBSPreview").append($('<a target="_blank" href="' + b.preview_url
                        + '"><img src="https://developers-dot-devsite-v2-prod.appspot.com/books/images/gbs_preview_button1.gif" alt="Preview" style="border:0;" /><\/a>'));
                     break;
                  }
               }
            }
         </script>
         <script src="https://books.google.com/books?jscmd=viewapi&bibkeys=ISBN:9780470647684&callback=ProcessGBSBookInfo"></script>
   </div>
</div>



<script src="/Library/Scripts/opac/Reserve.js?v=892"></script>
<script src="/Library/Scripts/opac/Reserve2.js?v=892"></script>
<script src="/Library/Scripts/opac/ReserveForNoPrompt.js?v=892"></script>
<script src="/Library/Scripts/opac/SelectIssue.js?v=892"></script>
<script type="text/javascript">
   function ReserveCheck(instantName) {
      this.init(instantName);
   }
   ReserveCheck.prototype = {
      instantName: "",
      promptToSpecifyPickupLibraryForReserve: '0',
      searchLibraryID:"",
      init: function (sInstantName) {
         this.instantName = sInstantName;
      },
      show_ReserveCheck:
         function (sender, itemids, strBarcode, LibraryID, searchLibraryID) {            
            var me = this;

            if (itemids == null || itemids == "")
               return;

            if (strBarcode == null) {
               strBarcode = "";
            }
            if (LibraryID == null) {
               LibraryID = "";
            }
            if (Util.IsLogin) {
               var sLibraryID = "";
               if (searchLibraryID) {
                  sLibraryID = searchLibraryID;
               } else {
                  sLibraryID = this.searchLibraryID;
               }
               if (!Util.AllowReserveForRegisteredPatron && Util.IsRegisteredPatron) {
                  Util.alert("Permission denied", Util.lang_NoReservePermission);
                  return;
               }
               if (Util.IsRMEnabled && $.inArray(sLibraryID, Util.RMLibraryIDList) > -1) {
                  Util.show_PatronBookPlus(sender, itemids, strBarcode, LibraryID, searchLibraryID);
                  return;
               }
               if (this.promptToSpecifyPickupLibraryForReserve == "0") {
                  $.post(Util.RootHomeFolder + "/AjaxReserveForNoPrompt_Init",
                     { strItemID: itemids + "", strBarcode: strBarcode + "", LibraryID: LibraryID + "" },
                     function (res, isSuc) {
                        if (isSuc == "success") {
                           if (res.strError != "" && (res.iResult2 != 9999 || res.iResult2 == 8888)) {
                              Util.alert("Reserve", res.strError);
                           } else {
                              if (res.bResult) {
                                 window.oReserveCheck = new ReserveForNoPrompt("oReserveCheck", res);
                                 oReserveCheck.addReserve();
                              }
                              if (res.strError != "" && res.iResult2 == 9999) {
                                 Util.alert("Reserve", res.strError);
                              }
                           }
                        } else {
                           Util.alert("Error","sorry,there is something wrong at /Home/AjaxReserveForNoPrompt_Init.")
                        }
                     });
               } else {
                  $.post(Util.RootHomeFolder + "/AjaxReserve_CheckLibrary",
                     { strItemID: itemids + "", strBarcode: strBarcode + "" },
                     function (ca, isSuc) {
                        if (isSuc == "success") {
                           //debugger;
                           if (ca) {
                              $.post(Util.RootHomeFolder + "/AjaxReserve2_Init",
                                 { strItemID: itemids + "", strBarcode: strBarcode + "", LibraryID: LibraryID + "" },
                                 function (res, isSuc1) {
                                    if (isSuc1=='success') {
                                       if (res.strError != "" && (res.iResult2 != 9999 || res.iResult2 == 8888)) {
                                          Util.alert("Reserve", res.strError);
                                       } else {
                                          if (res.bResult) {
                                             window.oReserveCheck = new Reserve2("oReserveCheck", res);
                                             oReserveCheck.createWin("#reserveCheck");
                                          }
                                          if (res.strError != "" && res.iResult2 == 9999) {
                                             Util.alert("Reserve", res.strError);
                                          }
                                       }
                                    } else {
                                       Util.alert("Error", "sorry,there is something wrong at /Home/AjaxReserve2_Init.");
                                    }
                                 });
                           } else {
                              $.post(Util.RootHomeFolder + "/AjaxReserve_Init",
                                 { strItemID: itemids + "", strBarcode: strBarcode + "", LibraryID: LibraryID + "" },
                                 function (res, isSuc1) {
                                    if (isSuc1=='success') {
                                       //debugger;
                                       if (res.strError != "" && (res.iResult2 != 9999 || res.iResult2 == 8888)) {
                                          Util.alert("Reserve", res.strError);
                                       } else {
                                          if (res.bResult) {
                                             window.oReserveCheck = new Reserve("oReserveCheck", res);
                                             oReserveCheck.createWin("#reserveCheck");
                                          }
                                          if (res.strError != "" && res.iResult2 == 9999) {
                                             Util.alert("Reserve", res.strError);
                                          }
                                       }
                                    } else {
                                       Util.alert("Error", "sorry,there is something wrong at /Home/AjaxReserve_Init.");
                                    }
                                 });
                           }
                        } else {
                           Util.alert("Error", "sorry,there is something wrong at /Home/AjaxReserve_CheckLibrary.")
                        }
                     });
               }
            } else {
               if (strBarcode == null) {
                  strBarcode = "";
               }
               var r = {
                  "itemids": itemids,
                  "strBarcode": strBarcode,
                  "LibraryID": LibraryID,
                  "searchLibraryID": searchLibraryID
               };
               Util.showLogin(me, r, 'rs', null);
            }
         }
   }
   $(document).ready(function () {
      Util.show_ReserveCheck = function (sender, itemids, strBarcode, LibraryID, searchLibraryID) {
         $.post(Util.RootHomeFolder + "/AjaxReserveCheck_Init",
            null,
            function (res, isSuc) {
               if (isSuc == "success") {
                  var reserveCheckDialog = new ReserveCheck("reserveCheckDialog");

                  reserveCheckDialog.promptToSpecifyPickupLibraryForReserve = res.promptToSpecifyPickupLibraryForReserve;
                  reserveCheckDialog.searchLibraryID = res.searchLibraryID;

                  reserveCheckDialog.show_ReserveCheck(sender, itemids, strBarcode, LibraryID, searchLibraryID);
               } else {
                  Util.alert("Error", "sorry,there is something wrong at AjaxReserveCheck_Init.");
               }
            });
      };

      Util.show_Reserve = function (tabNum) {
         if (arguments.length == 1) {
            var _args = arguments;
            if (tabNum == 1) {
               window.location.href = Util.RootHomeFolder+"/Reserves";
            }
         }
      };
      //Last modified by futao 2020-7-7 ver:8.6.8 to add requestFromLibraryID 
      Util.show_SelectIssue = function (sender, itemID, callback,requestFromLibraryID) {
         window._SelectIssue = new SelectIssue("window._SelectIssue");
         window._SelectIssue.showSelectIssue(sender, itemID, function (res) {
            callback(res);
         }, requestFromLibraryID);
      };

   });
</script>
 <div id="reserveCheck" style="display:none">   
   
    </div><script>
	jQuery(function(){jQuery("#reserveCheck").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Reserve","resizable":false,"width":520,"actions":["Close"]});});
</script>

<div id="winSelectIssue" style="display:none">
   <div style='width: 100%; ' id='divOverridePsd'>
       <div id='divSelectIssueTable' style='width: 100%;'>
<div class="k-widget k-grid" id="grdSelectIssue" style="height:325px;margin-bottom:3px;"><div class="k-grid-header"><div class="k-grid-header-wrap"><table><colgroup><col style="width:50px" /><col style="width:50px" /><col style="width:60px" /><col style="width:60px" /><col style="width:60px" /><col style="width:50px" /></colgroup><thead class="k-grid-header"><tr><th class="k-header" data-field="t72VolumeNo" data-index="0" data-title="Volume No" scope="col"><a class="k-link" href="/Library/ItemDetail?l=All&amp;i=95309&amp;ti=3&amp;subid=0&amp;grdSelectIssue-sort=t72VolumeNo-asc">Volume No</a></th><th class="k-header" data-field="t72IssueNo" data-index="1" data-title="Issue No" scope="col"><a class="k-link" href="/Library/ItemDetail?l=All&amp;i=95309&amp;ti=3&amp;subid=0&amp;grdSelectIssue-sort=t72IssueNo-asc">Issue No</a></th><th class="k-header" data-field="t72DateExpected" data-index="2" data-title="Date Expected" scope="col"><a class="k-link" href="/Library/ItemDetail?l=All&amp;i=95309&amp;ti=3&amp;subid=0&amp;grdSelectIssue-sort=t72DateExpected-asc">Date Expected</a></th><th class="k-header" data-field="t72MagazineDate" data-index="3" data-title="Magazine Date" scope="col"><a class="k-link" href="/Library/ItemDetail?l=All&amp;i=95309&amp;ti=3&amp;subid=0&amp;grdSelectIssue-sort=t72MagazineDate-asc">Magazine Date</a></th><th class="k-header" data-field="t72ArriveDate" data-index="4" data-title="Arrive Date" scope="col"><a class="k-link" href="/Library/ItemDetail?l=All&amp;i=95309&amp;ti=3&amp;subid=0&amp;grdSelectIssue-sort=t72ArriveDate-asc">Arrive Date</a></th><th class="k-header" data-field="IssueInfo" data-index="5" data-title="Reserve" scope="col"><a class="k-link" href="/Library/ItemDetail?l=All&amp;i=95309&amp;ti=3&amp;subid=0&amp;grdSelectIssue-sort=IssueInfo-asc">Reserve</a></th></tr></thead></table></div></div><div class="k-grid-content" style="height:200px"><table><colgroup><col style="width:50px" /><col style="width:50px" /><col style="width:60px" /><col style="width:60px" /><col style="width:60px" /><col style="width:50px" /></colgroup><tbody><tr class="k-no-data"><td colspan="6"></td></tr></tbody></table></div></div><script>
	jQuery(function(){jQuery("#grdSelectIssue").kendoGrid({"columns":[{"title":"Volume No","headerAttributes":{"data-field":"t72VolumeNo","data-title":"Volume\u0026#32;No"},"width":"50px","field":"t72VolumeNo","encoded":true},{"title":"Issue No","headerAttributes":{"data-field":"t72IssueNo","data-title":"Issue\u0026#32;No"},"width":"50px","field":"t72IssueNo","encoded":true},{"title":"Date Expected","headerAttributes":{"data-field":"t72DateExpected","data-title":"Date\u0026#32;Expected"},"width":"60px","template":"\u003cdiv\u003e#= t72DateExpected==null?\u0027\u0027:kendo.toString(kendo.parseDate(t72DateExpected,DateFormat), DateFormat ) #\u003c/div\u003e","field":"t72DateExpected","encoded":true},{"title":"Magazine Date","headerAttributes":{"data-field":"t72MagazineDate","data-title":"Magazine\u0026#32;Date"},"width":"60px","template":"\u003cdiv\u003e#= t72MagazineDate==null?\u0027\u0027:kendo.toString(kendo.parseDate(t72MagazineDate,DateFormat), DateFormat ) #\u003c/div\u003e","field":"t72MagazineDate","encoded":true},{"title":"Arrive Date","headerAttributes":{"data-field":"t72ArriveDate","data-title":"Arrive\u0026#32;Date"},"width":"60px","template":"\u003cdiv\u003e#= t72ArriveDate==null?\u0027\u0027:kendo.toString(kendo.parseDate(t72ArriveDate,DateFormat), DateFormat ) #\u003c/div\u003e","field":"t72ArriveDate","encoded":true},{"title":"Reserve","headerAttributes":{"data-field":"IssueInfo","data-title":"Reserve"},"width":"50px","field":"IssueInfo","encoded":true}],"sortable":true,"scrollable":{"height":"200px"},"messages":{"noRecords":"No records available."},"autoBind":false,"dataSource":{"type":(function(){if(kendo.data.transports['aspnetmvc-server']){return 'aspnetmvc-server';} else{throw new Error('The kendo.aspnetmvc.min.js script is not included.');}})(),"transport":{"read":{"url":""},"prefix":"grdSelectIssue-"},"serverPaging":true,"serverSorting":true,"serverFiltering":true,"serverGrouping":true,"serverAggregates":true,"filter":[],"schema":{"data":"Data","total":"Total","errors":"Errors","model":{"fields":{"t72VolumeNo":{"type":"string"},"t72IssueNo":{"type":"string"},"t72DateExpected":{"type":"date","defaultValue":null},"t72MagazineDate":{"type":"date","defaultValue":null},"t72ArriveDate":{"type":"date","defaultValue":null},"IssueInfo":{"type":"string"},"t72Identifier":{"type":"number"},"DateFormat":{"type":"string"}}}}}});});
</script>
       </div>
       <div style='width: 100%;text-align:right' >
         <input type='button' class = 'k-primary k-button'  id='btnOK' value='OK' onclick='window._SelectIssue.btnOK_click(); return false;' style="width:75px;"/>
          <input type='button' class = 'k-primary k-button' id='btnCancel' value='Cancel' onclick='window._SelectIssue.btnCancel_click(); return false;' style="width:75px;"/>
       </div>
    </div>
</div><script>
	jQuery(function(){jQuery("#winSelectIssue").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"SelectIssue","resizable":false,"width":700,"height":375,"actions":["Close"]});});
</script>


<script type="text/javascript" src="/Library/Scripts/opac/BookPlus.js?v=892"></script>
<script type="text/javascript">
   function show_PatronBookPlus(sender, itemids, strBarcode, LibraryID, searchLibraryID, kitKeys, defaultfromDate, reservedIdentifier) {

      var _items = [];
      if (typeof itemids == "object") {
         if (itemids.ItemID) {
            _items.push(itemids.ItemID + "|1");
         }
         else {
            _items = itemids;
         }
      }
      if (typeof itemids == "number") {
         _items.push(itemids + "|1");
      }
      if (typeof itemids == "string") {
         if (itemids != "") _items.push(itemids);
      }
      var _kitKeyArray = [];
      if (kitKeys) {
         if (typeof kitKeys == "object") {
            _kitKeyArray = kitKeys;
         }
         else if (typeof kitKeys == "string") {
            if (kitKeys != "") _kitKeyArray.push(kitKeys);
         }
      }
      if (_items.length < 1 && _kitKeyArray.length < 1) {
         return;
      }

      var sLibarayID = "";
      if (searchLibraryID) {
         sLibarayID = searchLibraryID;
      } else if (Util.RMLibraryIDList.length) {
         sLibarayID = Util.RMLibraryIDList[0];
      }

      if (!Util.IsLogin) {
         var ib = {
            "itemids": itemids,
            "strBarcode": strBarcode,
            "LibraryID": LibraryID,
            "searchLibraryID": searchLibraryID,
            "kitKeys": kitKeys
         };
         Util.showLogin(this, ib, "ib", null);
         return;
      }
      if (!Util.AllowReserveForRegisteredPatron && Util.IsRegisteredPatron) {
         Util.alert("Permission denied", Util.lang_NoReservePermission);
         return;
      }
      if (Util.IsRMEnabled && $.inArray(sLibarayID, Util.RMLibraryIDList) > -1) {
         bookPlus = new BookPlus();
         bookPlus.showWindow(sender, itemids, _kitKeyArray, defaultfromDate, reservedIdentifier);
      }
      else {
         Util.alert("Permission denied", "You do not have the permission.");
         return;
      }
   }
   function gridBookPlusDataBound() {
      this.tbody.find('script').each(function () {
         eval($(this).text());
      })
   }

   var bookPlus;
   $(document).ready(function () {
      Util.show_PatronBookPlus = show_PatronBookPlus;
   });
</script>
<style type="text/css">
   .bookPlusTable .k-state-selected a { color: white; }

   .bookPlusTable .k-grid-content { max-height: 120px; }
</style>

<div id="test"></div>

<div id="tipBookPlusWin" style="padding:0;;display:none">
<div style="padding:12px 15px;">
   <div class="bookPlusTable flexlayout">
      <div style="flex:1.5; -webkit-flex:1.5; align-items:center; -webkit-align-items:center;" class="flexlayout">
         <label id="lblBookTitleInBookingPlus" for="cboBookingListInBookingPlus_input">Book Title:</label>
         <div style="margin:0 20px;">
<input aria-labelledby="lblBookTitleInBookingPlus" id="cboBookingListInBookingPlus" name="cboBookingListInBookingPlus" style="width: 200px;" type="text" /><script>
	jQuery(function(){jQuery("#cboBookingListInBookingPlus").kendoComboBox({"dataTextField":"Text","dataValueField":"Value"});});
</script>
         </div>
         <div style="height: 1px; width: 1px; padding: 0px; margin: 0px; overflow: hidden; display: inline-block">
            <label style="text-indent: -9999em; width: 1px; padding: 0px; margin: 0px;" for="txtBookingTitleInBookingPlus">New Book Title</label>
         </div>
<input class="k-textbox" id="txtBookingTitleInBookingPlus" name="txtBookingTitleInBookingPlus" style="width:130px;;margin:0 0 0 3px;" />
      </div>
      <div style="flex:1; -webkit-flex:1; align-items:center; -webkit-align-items:center;" class="flexlayout">
         <label id="lblSite" style="line-height: 22px;" class="bold" for="cboSitesInBookingPlus_input">Site:</label>
         <div style="flex: 1; -webkit-flex: 1; margin:0 15px;">
<input aria-labelledby="lblSite" id="cboSitesInBookingPlus" name="cboSitesInBookingPlus" style="width: 158px; " type="text" /><script>
	jQuery(function(){jQuery("#cboSitesInBookingPlus").kendoComboBox({"dataTextField":"Text","dataValueField":"Value"});});
</script>
         </div>

      </div>
   </div>
   <div style="margin-top:12px; height:150px;" class="bookPlusTable">
      <span id="lblTitleRequest" style="display:none;">Title you'd like to request</span>
<div class="k-widget k-grid" id="grdItemsInBookingPlus" style="border:none;  max-height:150px; margin:1px;"><div class="k-grid-header"><div class="k-grid-header-wrap"><table style="max-height:150px; "><colgroup><col style="width:36px" /><col style="width:220px" /><col style="width:90px" /><col style="width:85px" /><col style="width:85px" /><col style="width:70px" /></colgroup><thead class="k-grid-header"><tr><th class="k-header" data-field="ID" data-index="0" data-title="ID" scope="col" style="text-align:center"><span class="k-link">ID</span></th><th class="k-header" data-field="Title" data-index="1" data-title="Title" scope="col" style="width:230px;"><span class="k-link">Title</span></th><th Length="21" class="k-header" data-field="Unavailable" data-index="2" data-title="Unavailable" scope="col"><span class="k-link">Unavailable</span></th><th Length="21" class="k-header" data-field="strApplyStartDate" data-index="3" data-title="From" scope="col"><span class="k-link">From</span></th><th Length="21" class="k-header" data-field="strApplyEndDate" data-index="4" data-title="To" scope="col"><span class="k-link">To</span></th><th Length="22" class="k-header" data-field="Copies" data-index="5" data-title="Copies" scope="col"><span class="k-link">Copies</span></th></tr></thead></table></div></div><div class="k-grid-content" style="height:auto"><table style="max-height:150px; "><colgroup><col style="width:36px" /><col style="width:220px" /><col style="width:90px" /><col style="width:85px" /><col style="width:85px" /><col style="width:70px" /></colgroup><tbody><tr class="k-no-data"><td colspan="6"></td></tr></tbody></table></div></div><script>
	jQuery(function(){jQuery("#grdItemsInBookingPlus").kendoGrid({"dataBound":gridBookPlusDataBound,"columns":[{"title":"ID","attributes":{"style":"text-align:center"},"headerAttributes":{"style":"text-align:center","data-field":"ID","data-title":"ID"},"width":"36px","template":"\u003cinput type=\"checkbox\" title=\"select #=Title#\" id=\"chkItemInBookPlus#=ID#\" value=\"#=ID#\"  onclick=\"bookPlus.onCheckboxClicked(#=ID#)\"/\u003e","field":"ID","encoded":true},{"title":"Title","headerAttributes":{"style":"width:230px;","data-field":"Title","data-title":"Title"},"width":"220px","template":"\u003cspan class=\"#=TitleClassName#\"\u003e#=Title#\u003c/span\u003e","field":"Title","encoded":true},{"title":"Unavailable","headerAttributes":{"Length":"21","data-field":"Unavailable","data-title":"Unavailable"},"width":"90px","template":"\u003ca href=\"javascript:void(0);\" onclick=\"bookPlus.unavailableBooking(#=ID#)\"\u003e#=Unavailable#\u003c/a\u003e","field":"Unavailable","encoded":true},{"title":"From","headerAttributes":{"Length":"21","data-field":"strApplyStartDate","data-title":"From"},"width":"85px","template":"\u003cspan class=\"#=DateClassName#\"\u003e#=strApplyStartDate#\u003c/span\u003e","field":"strApplyStartDate","encoded":true},{"title":"To","headerAttributes":{"Length":"21","data-field":"strApplyEndDate","data-title":"To"},"width":"85px","template":"\u003cspan class=\"#=DateClassName#\"\u003e#=strApplyEndDate#\u003c/span\u003e","field":"strApplyEndDate","encoded":true},{"title":"Copies","headerAttributes":{"Length":"22","data-field":"Copies","data-title":"Copies"},"width":"70px","template":"\u003cdiv style=\u0027height:1px; width: 1px; padding: 0px; margin: 0px;overflow:hidden\u0027\u003e\u003clabel style=\u0027text-indent: -9999em; width: 1px; padding: 0px; margin: 0px;\u0027 id=\u0027lblCopiesInBookPlus#=ID#\u0027 for=\u0027txtCopiesInBookPlus#=ID#_input\u0027\u003e#=Title# Copies\u003c/label\u003e\u003c/div\u003e\u003cinput aria-labelledby=\"lblCopiesInBookPlus#=ID#\" id=\"txtCopiesInBookPlus#=ID#\" min=\"0\" name=\"txtCopiesInBookPlus#=ID#\" onblur=\"bookPlus.copiesLostFocus(event, #=ID#)\" onkeyup=\"bookPlus.copiesKeyUp(event,#=ID#)\" onmouseout=\"bookPlus.copiesLostFocus(event, #=ID#)\" step=\"1\" style=\"width:55px;display:#=CopiesDisplay#\" type=\"text\" value=\"#=Copies#\" /\u003e\u003cscript\u003e\r\n\tjQuery(function(){jQuery(\"\\#txtCopiesInBookPlus#=ID#\").kendoNumericTextBox({\"spin\":function(event){ bookPlus.copiesSpined(event, #=ID#)},\"format\":\"{0:n0}\",\"decimals\":0});});\r\n\u003c\\/script\u003e","field":"Copies","encoded":true}],"scrollable":{"height":"auto"},"messages":{"noRecords":"No records available."},"autoBind":false,"dataSource":{"type":(function(){if(kendo.data.transports['aspnetmvc-server']){return 'aspnetmvc-server';} else{throw new Error('The kendo.aspnetmvc.min.js script is not included.');}})(),"transport":{"read":{"url":""},"prefix":"grdItemsInBookingPlus-"},"serverPaging":true,"serverSorting":true,"serverFiltering":true,"serverGrouping":true,"serverAggregates":true,"filter":[],"schema":{"data":"Data","total":"Total","errors":"Errors","model":{"fields":{"ID":{"type":"number"},"Title":{"type":"string"},"Copies":{"type":"number"},"MaxCopies":{"type":"number"},"KitKey":{"type":"string"},"StartDate":{"type":"date","defaultValue":null},"EndDate":{"type":"date","defaultValue":null},"ReceivedDate":{"type":"date","defaultValue":null},"ReturnDate":{"type":"date","defaultValue":null},"PickupOnly":{"type":"boolean"},"ApplyBeforeBook":{"type":"boolean"},"strApplyStartDate":{"type":"string"},"strApplyEndDate":{"type":"string"},"TitleClassName":{"type":"string"},"DateClassName":{"type":"string"},"Unavailable":{"type":"string"},"CopiesDisplay":{"type":"string"},"OPACIMMBookingLimit":{"type":"number"},"DoNotCheckOutLastCopy":{"type":"number"},"MaximumBookingsbyPatron":{"type":"number","defaultValue":null}}}}}});});
</script>
   </div>
   <div id="div_ClickHere_winBookingPlus" class="flexlayout" style="display:none; margin-top:12px;align-items: center;-webkit-align-items: center;">
      <div style="flex: 1; -webkit-flex: 1;"></div>
      <div id="lbl_ClickHere_winBookingPlus" class="bold" style=" margin:0 20px; color:#FF0000;">Please click here if the item is not avaiable for the dates you need.</div>
<button class="k-primary" id="btnNotEnoughCopies_winBookingPlus" style=" width:130px;padding:0; height:2.4em;">Not Enough Copies</button><script>
	jQuery(function(){jQuery("#btnNotEnoughCopies_winBookingPlus").kendoButton({});});
</script>
   </div>
   <div style="margin-top:12px;" class="bookPlusTable">


<style type="text/css">
   #calendarPlus .k-link sub
   {
      color:red; font-weight:normal;
   }
   #calendarPlus .k-state-selected sub {
      color: #fff;
   }
   #calendarPlus .k-link
   {
      padding:0 !important;
      text-align:center;
   }
   #calendarPlus .calendarPlus
   {
      width:250px; border-radius:6px; font-weight:bold;
   }
   #calendarPlus .calendarPlus th {
      font-weight: bold; background-color:transparent; border:none 0; height:2em; line-height:2em;
   }
   #calendarPlus .calendarPlus tr th:first-child {
      background-color: #E8ECEE;
   }
   #calendarPlus .calendarPlus tr td:first-child {
      background-color: #E8ECEE;
      border-radius:0;
   }
   #calendarPlus .calendarPlus tr th:last-child {
      background-color: #E8ECEE;
   }
   #calendarPlus .calendarPlus tr td:last-child {
      background-color: #E8ECEE;
      border-radius: 0;
   }
   #calendarPlus .calendarPlus .k-state-focused {
      box-shadow:none;
   }
   #calendarPlus .k-i-arrow-w, #calendarPlus .k-i-arrow-e {
      display: none;
   }
   #calendarPlus .k-header,#calendarPlus .k-nav-prev,#calendarPlus .k-nav-fast, #calendarPlus .k-nav-next
   {
      height:25px !important;
      line-height:25px !important; 
      color:white !important;
      font-size:11px !important;
   } 
</style> 
<script type="text/javascript" src="/Library/Scripts/opac/CalendarPlus.js?v=892"></script>

<div id="calendarPlus" style="position:relative;"> 
   <div id="calendarTitle" class="k-header" style="width:100%;font-weight:bold; text-align:center;margin-bottom:5px;line-height:18px;">

   </div>
   <div style="position:relative; width:806px; margin:0 auto;">
      <div style="position:absolute;z-index:101;">
         <a href="javascript:void(0);return false;" onclick="calendarPlus.btnLeftNavigatorClicked();return false;" class="calendar-date-left" style="display:block;margin:7px 0 0 3px;width:15px;height:15px;"></a>
      </div>
      <div style="position:absolute;z-index:100;">
         <a href="javascript:void(0);return false;" onclick="calendarPlus.btnRightNavigatorClicked();return false;" class="calendar-date-right" style="display:block;margin:7px 0 0 784px;width:15px;height:15px;"></a>
      </div>
      <div class="k-widget k-calendar calendarPlus" id="calendar1"></div><script>
	jQuery(function(){jQuery("#calendar1").kendoCalendar({"footer":false,"month":{"content":jQuery('#calendar-month-template').html()}});});
</script>
      <div class="k-widget k-calendar calendarPlus" id="calendar2" style="margin:0 20px;"></div><script>
	jQuery(function(){jQuery("#calendar2").kendoCalendar({"footer":false,"month":{"content":jQuery('#calendar-month-template').html()}});});
</script>
      <div class="k-widget k-calendar calendarPlus" id="calendar3"></div><script>
	jQuery(function(){jQuery("#calendar3").kendoCalendar({"footer":false,"month":{"content":jQuery('#calendar-month-template').html()}});});
</script>
   </div>
</div>

<script type="x-kendo-template" id="calendar-month-template">
   <div>
      <span>#= data.value #</span>
      <sub> </sub>
   </div>
</script>  
<script type="text/javascript">
   var calendarPlus;
   $(document).ready(function () {
      calendarPlus = new CalendarPlus();     
   }); 
</script> 
   </div>
   <div style="margin-top:20px;" class="bookPlusTable flexlayout">
      <div id="divBookingForTeachInBookingPlus" style="display:none;">
         <span class="bold" style="display:block; height:2.4em; line-height:2.4em; margin-bottom:8px;">
Booking On Behalf Of
         </span>
         <label id="lblLibraryInBookingPlus" for="cboLibraryInBookingPlus_input" style="width: 1px; text-indent: -9999em; float: left;">Select Library</label>
<input aria-labelledby="lblLibraryInBookingPlus" id="cboLibraryInBookingPlus" name="cboLibraryInBookingPlus" style="width: 158px; " type="text" /><script>
	jQuery(function(){jQuery("#cboLibraryInBookingPlus").kendoComboBox({"dataTextField":"Text","dataValueField":"Value"});});
</script>
            <div style="margin: 3px 0 0 0;"></div>
         <label id="lblTeacherInBookingPlus" for="cboTeacherInBookingPlus_input" class="irmbooking-group-teachers" style="width: 1px; text-indent: -9999em; float: left; display: none;">Select Teacher</label>
         <label id="lblTeacherInBookingPlus2" for="acpTeacherInBookingPlus_input" class="irmbooking-any-teachers" style="width: 1px; text-indent: -9999em; float: left; display: none;">Teacher</label>
         <div class="irmbooking-group-teachers" style="display:none;">
<input aria-labelledby="lblTeacherInBookingPlus" id="cboTeacherInBookingPlus" name="cboTeacherInBookingPlus" style="width: 158px; " type="text" /><script>
	jQuery(function(){jQuery("#cboTeacherInBookingPlus").kendoComboBox({"dataTextField":"Text","dataValueField":"Value"});});
</script>
         </div>
         <div class="irmbooking-any-teachers" style="display:none;">
<input aria-labelledby="lblTeacherInBookingPlus2" id="acpTeacherInBookingPlus" maxlength="100" name="acpTeacherInBookingPlus" style="width: 158px;" type="text" /><script>
	jQuery(function(){jQuery("#acpTeacherInBookingPlus").kendoAutoComplete({"dataTextField":"Text","minLength":0,"clearButton":false});});
</script>
         </div>
      </div>
      <div id="divBookingForTeachInBookingPlusRight" style="width:20px;display:none;"></div>
      <div style="flex: 1; -webkit-flex: 1;" class="flexlayoutcol">
         <div class="flexlayout" style=" align-items: center; -webkit-align-items: center;">
            <label id="lblRequestFrom" for="dtpRequestFromInBookingPlus" class="bold">Request From:</label>
            <div style="margin:0 15px;">
<input id="dtpRequestFromInBookingPlus" name="dtpRequestFromInBookingPlus" style="width:128px;" type="text" /><script>
	jQuery(function(){jQuery("#dtpRequestFromInBookingPlus").kendoDatePicker({"culture":"en-US","format":"M/d/yyyy","min":new Date(1900,0,1,0,0,0,0),"max":new Date(2099,11,31,0,0,0,0)});});
</script>
            </div>
            <div style="height: 1px; width: 1px; padding: 0px; margin: 0px; overflow: hidden; display: inline-block">
               <label id="lblRequestTo" style="text-indent: -9999em; width: 1px; padding: 0px; margin: 0px;" for="dtpRequestToInBookingPlus">Request To:</label>
            </div>
            <div>
<input id="dtpRequestToInBookingPlus" name="dtpRequestToInBookingPlus" style="width:128px;" type="text" /><script>
	jQuery(function(){jQuery("#dtpRequestToInBookingPlus").kendoDatePicker({"culture":"en-US","format":"M/d/yyyy","min":new Date(1900,0,1,0,0,0,0),"max":new Date(2099,11,31,0,0,0,0)});});
</script>
            </div>
            <div style="width:15px;"></div>
            <div id="checkoutModeDivInBookPlus" class="flexlayout">
               <div>
<input class="k-radio" id="optDeliveryInBookingPlus_0" name="CheckoutMode" type="radio" value="0" /><label class="k-radio-label" for="optDeliveryInBookingPlus_0">Delivery</label>
               </div>
               <div style="margin:0 15px;">
<input class="k-radio" id="optPickupInBookingPlus_1" name="CheckoutMode" type="radio" value="1" /><label class="k-radio-label" for="optPickupInBookingPlus_1">Pickup</label>
               </div>
            </div>
            <div id="div_chkShoterIRMBookingPeriod" style=" display: none;">
<input class="k-checkbox" id="chkShoterIRMBookingPeriod" name="chkShoterIRMBookingPeriod" type="checkbox" value="true" /><label class="k-checkbox-label" for="chkShoterIRMBookingPeriod">Shorter Booking Period</label><input name="chkShoterIRMBookingPeriod" type="hidden" value="false" />
            </div>
         </div>
         <div class="flexlayout" style="margin-top:6px;">
            <div style="flex: 1; -webkit-flex: 1;" class="divBorder">
               <label for="txtNotesInBookPlus" class="bold" style=" display:block; margin-bottom:4px;">Notes</label>
<textarea cols="20" id="txtNotesInBookPlus" name="txtNotesInBookPlus" readonly="readonly" rows="2" style="border:none&#32;0;&#32;width:&#32;100%;&#32;height:&#32;62px;&#32;background-color:&#32;rgb(238,&#32;238,&#32;238);resize:none;">
</textarea>
            </div>
            <div style="width:20px;"></div>
            <div style="flex: 1; -webkit-flex: 1;" class="divBorder">
               <label for="txtBookingMessageInBookPlus" class="bold" style=" display:block; margin-bottom:4px;">Message</label>
<textarea cols="20" id="txtBookingMessageInBookPlus" name="txtBookingMessageInBookPlus" rows="2" style="border:none&#32;0;&#32;width:&#32;100%;&#32;height:&#32;62px;resize:none;">
</textarea>
            </div>
            <div style="width:40px;"></div>
            <div class="flexlayoutcol" style="margin-top:2px;">
<button class="k-primary" id="btnApplyInBookingPlus" style="width:120px;padding:0; height:2.4em;">Apply</button><script>
	jQuery(function(){jQuery("#btnApplyInBookingPlus").kendoButton({});});
</script>
<button class="k-primary" id="btnBookItemInBookingPlus" style="margin:6px 0;width:120px;padding:0; height:2.4em;">Book Item(s)</button><script>
	jQuery(function(){jQuery("#btnBookItemInBookingPlus").kendoButton({});});
</script>
<button class="k-primary" id="btnCloseInBookingPlus" style="width:120px;padding:0; height:2.4em;">Close</button><script>
	jQuery(function(){jQuery("#btnCloseInBookingPlus").kendoButton({});});
</script>
            </div>
         </div>
      </div>
   </div>
</div>
</div><script>
	jQuery(function(){jQuery("#tipBookPlusWin").kendoWindow({"animation":false,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Booking","resizable":false,"width":966,"actions":["Close"]});});
</script>
<script type="x-kendo-template" id="chkAllInBookPlusTemplate">
   <input type="checkbox" id="chkAllInBookPlus" checked="true" title="Select all titles"/>
</script>

<div id="tipUnavailableBooking" style="display:none">
<label id="lblFromInUnavailable" for="dtpUnavailableFrom" style="line-height: 22px;">Requested From</label>
<input id="dtpUnavailableFrom" name="dtpUnavailableFrom" style="width:176px;" type="text" /><script>
	jQuery(function(){jQuery("#dtpUnavailableFrom").kendoDatePicker({"culture":"en-US","format":"M/d/yyyy","min":new Date(1900,0,1,0,0,0,0),"max":new Date(2099,11,31,0,0,0,0)});});
</script>
<label id="lblToInUnavailable" for="dtpUnavailableTo" style="line-height: 22px;">Requested To</label>
<input id="dtpUnavailableTo" name="dtpUnavailableTo" style="width:176px;" type="text" /><script>
	jQuery(function(){jQuery("#dtpUnavailableTo").kendoDatePicker({"culture":"en-US","format":"M/d/yyyy","min":new Date(1900,0,1,0,0,0,0),"max":new Date(2099,11,31,0,0,0,0)});});
</script>
<div style="margin: 7px 0 0 29px;">
<button class="k-primary" id="btnOKInUnavailable" style="width:70px;padding:0;">Save</button><script>
	jQuery(function(){jQuery("#btnOKInUnavailable").kendoButton({});});
</script>
<button class="k-primary" id="btnCancelInUnavailable" style="width:70px;padding:0;">Cancel</button><script>
	jQuery(function(){jQuery("#btnCancelInUnavailable").kendoButton({});});
</script>
</div>
</div><script>
	jQuery(function(){jQuery("#tipUnavailableBooking").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Unavailable","resizable":false,"width":187,"actions":["Close"]});});
</script>


<style>
   .width100Percent_RBS
   {
      width:100%;
   }
   .textAlignCenter_RBS 
   {
      text-align:center;
   }
   .divMarginTop5PX_RBS
   {
      margin-top:5px;
   }
   .divPaddingTop10PX_RBS
   {
      padding-top:10px;
   }
</style>

<script src="/Library/Scripts/opac/ReserveBySeries.js?v=892"></script>

<script type="text/javascript">
   var OBJReserveBySeries = new ReserveBySeries();
   if ($("#winReserveBySeries").length==1) {
      $("#winReserveBySeries").data("ReserveBySeries", OBJReserveBySeries);
   }
 
   function reserveBySeriesOBJ() {
      return $("#winReserveBySeries").data("ReserveBySeries");
   }
</script>

<div id="winReserveBySeries" style="display:none">
   <div class="width100Percent_RBS">
      <div class="width100Percent_RBS divMarginTop5PX_RBS">
         <input class="k-checkbox" id="chkReserveBySeries_RBS" name="chkReserveBySeries_RBS" style="" tabindex="1" type="checkbox" value="true" /><label class="k-checkbox-label" for="chkReserveBySeries_RBS">Reserve By Series</label><input name="chkReserveBySeries_RBS" type="hidden" value="false" />
      </div>
      <div class="width100Percent_RBS textAlignCenter_RBS divMarginTop5PX_RBS divPaddingTop10PX_RBS">
         <button class="k-primary" id="btnOK_RBS" style="line-height:0;" tabindex="2">OK</button><script>
	jQuery(function(){jQuery("#btnOK_RBS").kendoButton({});});
</script>
      </div>
   </div>

   </div><script>
	jQuery(function(){jQuery("#winReserveBySeries").kendoWindow({"open":reserveBySeriesOBJ().winReserveBySeriesOpen,"close":reserveBySeriesOBJ().winReserveBySeriesClose,"modal":true,"iframe":false,"draggable":true,"scrollable":false,"pinned":false,"title":"Reserve By Series","resizable":false,"width":200,"height":70,"actions":["Minimize","Close"]});});
</script>

<script type="text/javascript">
   if (reserveBySeriesOBJ()==null) {
      var OBJReserveBySeries = new ReserveBySeries();
      $("#winReserveBySeries").data("ReserveBySeries", OBJReserveBySeries);
   }
</script>



<script>
   function onShelflistDialogOpen(e) {
      if ($("#divShelflistDialogContent").length == 1) {
         var itemID = this.element.data().itemID;
         getShelflist(itemID, -1);
      }
   }
   function onShelflistDialogClose(e) {
      if ($("#divShelflistDialogContent").length == 1) {
         var container = $("#divShelflistDialogContent");
         container.html("");
      }
   }

   function getShelflist(itemID, startRow) {
      var container = $("#divShelflistDialogContent");
      kendo.ui.progress(container, true);
      $.post(Util.RootHomeFolder + "/SearchResult_GetShelfList", { id: itemID, startRow: startRow },
         function (data) {
            if (startRow > -1) {
               if (!(data && data.oResult && data.oResult.length && data.oResult.length > 0)) {
                  kendo.ui.progress(container, false);
                  return;
               }
            }
            var previewHtml = "";
            if (data) {
               var displayReserveCopy = data.bResult;
               if (data.strError) {///set window title
                  var alCaptions = eval(data.strError);
                  var strTitleHTML = alCaptions[0].replace(/%23/g, "'").replace(/%13/g, "\r").replace(/%13/g, "\n");
                  var wintitle = (strTitleHTML.length > 50 ? (strTitleHTML.substr(0, 50) + "...") : strTitleHTML) + " : " + alCaptions[1].replace(/%23/g, "'");
                  $("#tipShelfListWin").data("kendoWindow").title(wintitle);
               }
               var isHideReserveButtonAfterLogin = 0;
               if (data.iResult2) {
                  isHideReserveButtonAfterLogin = data.iResult2;
               }
               var showLocationInShelfList = false;
               if (data.iResult) {
                  showLocationInShelfList = (data.iResult == 1);
               }
               if (showLocationInShelfList)
                  $("#divShelflistDialogContent").height(600);
               if (data.oResult != null && data.oResult.length > 0) {
                  previewHtml += '<div class="shelfListButtons">'
                     + '<button aria-label="Previous" type="button" class="button01" id="btnPre" onclick="window.shelfListChange('
                     + itemID + ',0); return false;" title="Previous" style="margin:0 7px 0 0;" ></button>'
                     + '<button aria-label="Next" type="button" class="button02" id="btnNext" onclick="window.shelfListChange('
                     + itemID + ',1); return false;" title="Next"  style="margin:0 0 0 7px;" ></button>'
                     + '</div> ';
                  var oneShelflistCopyTemplage = kendo.template($("#oneShelflistCopyTemplage").html());
                  var oneShelflistCopy = {};
                  for (var ri = 0; ri < data.oResult.length; ri++) {
                     var row = data.oResult[ri];
                     if (ri % 8 == 0) {
                        previewHtml += "<ul>";
                     }
                     var tagHTML = '';
                     if (row.Status == 5) {
                        tagHTML = "<div class=\"inTag tag\">IN</div>";
                     }
                     else if (row.Status == 6) {
                        tagHTML = "<div class=\"outTag tag\">Out</div>";
                     }
                     var fontStyle = '';
                     var imgStyle = 'style=\"width:auto;height:auto;\"';
                     var t02Identifier = row.ItemID;
                     if (t02Identifier == itemID) {
                        fontStyle = "style =\"color:#f00;\"";
                        imgStyle = "style =\"border:1px solid #f00;width:auto;height:auto;\"";
                     }
                     oneShelflistCopy.FontStyle = fontStyle;
                     oneShelflistCopy.CallNo = row.CallNo;
                     oneShelflistCopy.Title = row.Title;
                     oneShelflistCopy.ImgStyle = imgStyle;
                     oneShelflistCopy.ImgSrc = row.ImageUrl;
                     oneShelflistCopy.Num = ri;
                     oneShelflistCopy.displayTitle = row.NoCover ? "block" : "none";
                     oneShelflistCopy.TagHTML = tagHTML;
                     oneShelflistCopy.shelfListLocationDiv = "";
                     oneShelflistCopy.LibraryID = row.LibraryID;
                     oneShelflistCopy.ItemID = row.ItemID;
                     if (showLocationInShelfList)
                        oneShelflistCopy.shelfListLocationDiv = "<span class=\"shelfListLocation\" " + fontStyle + ">" + (row.Location ? row.Location : "") + "</span>";
                     previewHtml += oneShelflistCopyTemplage(oneShelflistCopy);
                     if ((ri + 1) % 8 == 0) {
                        previewHtml += "</ul><div class=\"sperateLine\"></div>";
                     }
                  }
               }
            }
            container.html(previewHtml);
            setTooltip(data.oResult, displayReserveCopy, isHideReserveButtonAfterLogin);
            kendo.ui.progress(container, false);
         });
   }

   function setTooltip(res, displayReserveCopy, isHideReserveButtonAfterLogin) {
      if (res != null && res.length > 0) {
         var Stable = $("#divShelflistDialogContent");
         var r = Stable.find("li");
         var e2;
         var tipCheckTime = null;
         var b = $("#ShelfListView");
         b.css("position", "absolute");
         for (var i = 0; i < r.length; i++) {
            var toolTipTarget = $(r.find("img")[i]);
            toolTipTarget.parent().mouseover(shelfMouseover);
            toolTipTarget.parent().mouseleave(shelfMouseleave);
            toolTipTarget.parent().focus(shelfMouseover);
            toolTipTarget.parent().blur(shelfMouseleave);
            function shelfMouseover() {
               if (window.tipCheckTime)
                  clearTimeout(window.tipCheckTime);
               var row = res[parseInt($(this).find("img").attr("id").replace("ShelfBook_", ""))];
               $("#ShelfListView").html("");
               if (window.tooltipHelp == null) {
                  window.tooltipHelp = new Tooltip("tooltipHelp");
               }
               var sLeft = "";
               var sTop = "";
               var shelfWin = $("#tipShelfListWin").data("kendoWindow");
               if ($(this).offset().left > (shelfWin.options.position.left + (885 / 2))
                     && (($(this).offset().left - shelfWin.options.position.left) > 360))
                  sLeft = ($(this).offset().left - shelfWin.options.position.left - 360) + "px";
               else
                  sLeft = ($(this).offset().left - shelfWin.options.position.left + 70) + "px";

               if ($(this).offset().top > (shelfWin.options.position.top + (600 / 2))
                     && (($(this).offset().top - shelfWin.options.position.top) > 110))
                  sTop = ($(this).offset().top - shelfWin.options.position.top - 110) + "px";
               else
                  sTop = ($(this).offset().top - shelfWin.options.position.top - 33) + "px";
               $("#ShelfListView").css("left", sLeft);
               $("#ShelfListView").css("top", sTop);
               $("#ShelfListView").html(window.tooltipHelp.CreateHtml(row, row.ItemID, null, 0, "none", $(this).find("img").attr("id"), row.DisplayReserveOrBook, row.Barcode, row.CopyLibraryID, window.UseMaterialType));
               //$("#TooltipMore").css("display", "none");
               $("#TooltipMore").remove();
               $("#ShelfListView").show();
            };
            function shelfMouseleave() {
               if (window.tipCheckTime)
                  clearTimeout(window.tipCheckTime);
               window.tipCheckTime = setTimeout(function () {
                  $("#ShelfListView").hide();
               }, 1000);
            }
         }
      }
   }

   $(document).ready(function () {
      Util.showShelfList = function (itemID) {
         $.post(Util.RootHomeFolder + "/SearchResult_CheckLoadShelfList", null,
            function (data) {
               if (data.strResult != "") {
                  Util.alert("", data.strResult);
                  return;
               }
               window.LibraryResourceManager = data.iResult;
               window.UseMaterialType = data.iResult2;
               if ($("#tipShelfListWin").length == 1) {
                  $("#tipShelfListWin").data().itemID = itemID;
                  $("#tipShelfListWin").data("kendoWindow").open();
                  $("#tipShelfListWin").data("kendoWindow").center();
               }
            });
      };
      $("#ShelfListView").mouseover(function () {
         if (window.tipCheckTime)
            clearTimeout(window.tipCheckTime);
         $("#ShelfListView").show();
      });


      $("#ShelfListView").mouseleave(function () {
         if (window.tipCheckTime)
            clearTimeout(window.tipCheckTime);
         $("#ShelfListView").hide();
      });
      window.shelfListChange = getShelflist;
   });
</script>
<script type="text/x-kendo-template" id="oneShelflistCopyTemplage">
   <li>
     <span class="shelfListCallNo" #=FontStyle#>#=CallNo#</span>
     <div title="#=Title#" class="imgDiv item_image_normal" #=ImgStyle#>
        <a href='/Library/ItemDetail?l=#=LibraryID#&i=#=ItemID#&ti=-1' target='_blank'>
           <img src="#=ImgSrc#" alt="#=Title#" id="ShelfBook_#=Num#"/>
           <div class="no_image_text" style="top:10px;display:#=displayTitle#">#=Title#</div>#=TagHTML#
        </a>
      </div>
      #=shelfListLocationDiv#
   </li>
</script>
<script src="/Library/Scripts/opac/Tooltip.js?v=892"></script>
<div id="tipShelfListWin" style="padding:0;;display:none">
<div id="divShelflistDialogContent" class="shelfListDiv" style="width: 885px; height: 575px;">
</div>
<div id="ShelfListView" style="display:none;">
</div>
</div><script>
	jQuery(function(){jQuery("#tipShelfListWin").kendoWindow({"open":onShelflistDialogOpen,"close":onShelflistDialogClose,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Shelflist","resizable":false,"width":885,"actions":["Close"]});});
</script>



<script src="/Library/Scripts/opac/mapper.js?v=892"></script>
<script>
   function onLocateItDialogOpen(e) {
      var mapList = this.element.data().mapList;
      if ($("#btnShowShelfListInLocateIt").length == 1) {
         $("#btnShowShelfListInLocateIt").data().itemID = this.element.data().itemID;
      }
      if ($("#divMapListContainer").length == 1) {
         var mapListHTML = "";
         if (mapList != null) {
            var oneMapInListTemplate = kendo.template($("#oneMapInListTemplate").html());
            var existsMaps = [];
            for (var i = 0; i < mapList.length; i++) {
               var row = mapList[i];
               if ($.inArray(row.t455Identifier, existsMaps) == -1) {
                  existsMaps.push(row.t455Identifier);
                  row.ImageName = row.t455MapName + "(" + row.t09LibraryName + ")";
                  mapListHTML += oneMapInListTemplate(row);
               }
            }
         }
         $("#divMapListContainer").html(mapListHTML);
      }
      var mapID = -1;
      if (mapList != null) {
         mapID = mapList[0].t455Identifier;
         showMapDetail(("libraryMap_" + mapID), mapID);
      }
   }

   function showMapDetail(senderID, mapID) {
      var mapList = $("#tipLocateItWin").data().mapList;
      if ($("#" + senderID).length == 1 && mapList) {
         var sender = $("#" + senderID);
         var l = window.lastSelectMap;
         if (l && l.parent()) {
            l.attr("class", "libraryMapBorder");
            l.parent().find(".triangle").css("display", "none");
         }
         sender.attr("class", "libraryMapBorderSelected");
         var triangle = sender.parent().find(".triangle");
         if (triangle) {
            triangle.css("display", "");
            if (sender.height() <= 0)
               triangle.css("top", ((147 / 2) - 7) + "px");
            else
               triangle.css("top", ((sender.height() / 2) - 7) + "px");
         }
         window.lastSelectMap = sender;
         window.highlightSettings = [];
         clearTimeout(window.id_of_settimeout);
         if ($("#divDetailMap").length == 1) {
            var areaList = "";
            var callNoRangeList = "";
            var highlightList = "";
            var MapImageUrl = "";
            var oneAreaTemplage = kendo.template($("#oneAreaTemplage").html());
            var oneCallNoRangeTemplage = kendo.template($("#oneCallNoRangeTemplage").html());
            for (var i = 0; i < mapList.length; i++) {
               var e = mapList[i];
               if (e.t455Identifier != mapID)
                  continue;
               MapImageUrl = e.MapImageUrl;
               mapAreaObj = {
                  ConfigIndex: i,
                  ConfigShape: parseInt(e.t454HighlightShape) == 0 ? "rect" : "poly",
                  ConfigOther: parseInt(e.t454HighlightShape) == 0 ? "" : "other='ellipse'",
                  ConfigCoords: e.t454HighlightCoords,
                  ConfigColor: e.t454HighlightColor
               };
               if (("True".toLowerCase() == "true") || e.ContainsCallNo) {
                  areaList += oneAreaTemplage(mapAreaObj);
               }
               var array = e.t454HighlightCoords.split(',');
               if (array.length != 4)
                  continue;
               var left = 0.0, top = 0.0, areaTop = 0.0, width = 0.0, height = 0.0;
               if (parseInt(e.t454HighlightShape) == 0) {
                  left = parseFloat(array[0]);
                  areaTop = parseFloat(array[1]);
                  top = parseFloat(array[1]) + (parseFloat(array[3]) - parseFloat(array[1])) / 2 - 10;
                  if (top < 0)
                     top = 0;
                  width = parseFloat(array[2]) - parseFloat(array[0]) - 15;
                  height = parseFloat(array[3]) - parseFloat(array[1]) - 15;
               }
               else {
                  left = parseFloat(array[0]) - parseFloat(array[2]);
                  if (left < 0)
                     left = 0;
                  areaTop = parseFloat(array[1]) - parseFloat(array[3]);
                  if (areaTop < 0)
                     areaTop = 0;
                  top = parseFloat(array[1]) - 10;
                  if (top < 0)
                     top = 0;
                  width = parseFloat(array[2]) * 2 - 15;
                  height = parseFloat(array[3]) * 2 - 15;
               }
               if (e.ContainsCallNo) {
                  window.highlightSettings.push({
                     highlightLeft: left - 10,
                     highlightTop: areaTop - 10,
                     highlightWidth: width + 35,
                     highlightHeight: height + 35
                  });
                  highlightList += kendo.template($("#mapDetailHighlightTemplage").html())({});
               }
               if (width <= 0)
                  continue;
               var callNoRange = {
                  Left: left,
                  Top: top,
                  Width: width,
                  CallNoRange: (e.t454MappingType == 0 ? e.t454CallNoFrom + "-" + e.t454CallNoTo : e.t454Location)
               };
               if (("True".toLowerCase() == "true") || e.ContainsCallNo) {
                  callNoRangeList += oneCallNoRangeTemplage(callNoRange);
               }
            }
            var mapDetail = {
               MapImageUrl: MapImageUrl,
               HighlightList: highlightList,
               AreaList: areaList,
               CallNoRangeList: callNoRangeList,
               NumberSign: "#",
               ImageName: e.ImageName
            }
            $("#divDetailMap").html(kendo.template($("#mapDetailTemplage").html())(mapDetail));
         }
      }
   }

   function showMatchedRange() {
      var me = window;
      if ($("#tipLocateItWin").length == 1 && $("#tipLocateItWin").data("kendoWindow").options.visible) {
         if ($.isArray(me.highlightSettings) && me.highlightSettings.length > 0 && $(".HighlightRange").length == me.highlightSettings.length) {
            $.each(me.highlightSettings, function (i, setting) {
               if (setting.highlightWidth > 0 && setting.highlightHeight > 0) {
                  $(".HighlightRange:eq(" + i + ")").removeClass("CNRangeHighlight2");
                  $(".HighlightRange:eq(" + i + ")").addClass("CNRangeHighlight");
                  $(".HighlightRange:eq(" + i + ")").css("left", (setting.highlightLeft > 0 ? setting.highlightLeft : 0) + "px");
                  $(".HighlightRange:eq(" + i + ")").css("top", (setting.highlightTop > 0 ? setting.highlightTop : 0) + "px");
                  $(".HighlightRange:eq(" + i + ")").css("width", (setting.highlightWidth + (setting.highlightLeft < 0 ? setting.highlightLeft : 0)) + "px");
                  $(".HighlightRange:eq(" + i + ")").css("height", (setting.highlightHeight + (setting.highlightTop < 0 ? setting.highlightTop : 0)) + "px");
               }
               else {
                  $(".HighlightRange:eq(" + i + ")").css("left", 0 + "px");
                  $(".HighlightRange:eq(" + i + ")").css("top", 0 + "px");
                  $(".HighlightRange:eq(" + i + ")").css("width", 0 + "px");
                  $(".HighlightRange:eq(" + i + ")").css("height", 0 + "px");
                  $(".HighlightRange:eq(" + i + ")").css("display", "none");
               }
            });
         }
      }
      me.id_of_settimeout = setTimeout("showOneMatchedRange(true)", 900);
   }

   function showOneMatchedRange(isHighlight2) {
      var me = window;
      if ($("#tipLocateItWin").length == 1 && $("#tipLocateItWin").data("kendoWindow").options.visible) {
         if ($.isArray(me.highlightSettings) && me.highlightSettings.length > 0 && $(".HighlightRange").length == me.highlightSettings.length) {
            if (isHighlight2) {
               $(".HighlightRange").removeClass("CNRangeHighlight");
               $(".HighlightRange").addClass("CNRangeHighlight2");
               me.id_of_settimeout = setTimeout("showOneMatchedRange(false)", 900);
            }
            else {
               $(".HighlightRange").removeClass("CNRangeHighlight2");
               $(".HighlightRange").addClass("CNRangeHighlight");
               me.id_of_settimeout = setTimeout("showOneMatchedRange(true)", 900);
            }
         }
      }
   }

   function detailImageLoad() {
      setTimeout("addMapper()", 100);
      setTimeout("showMatchedRange()", 100);
   }

   $(document).ready(function () {
      if ($("#btnShowShelfListInLocateIt").length == 1) {
         $("#btnShowShelfListInLocateIt").bind("click", function (e) {
            var itemID = $("#btnShowShelfListInLocateIt").data().itemID;
            Util.showShelfList(itemID);
         });
      }
      if ($("#locateZoomBigger").length == 1) {
         $("#locateZoomBigger").bind("click", function (e) {
            var zoomScale1 = $("#divDetailMap").data("mapscale");
            if (!$.isNumeric(zoomScale1)) {
               zoomScale1 = 1;
            }
            zoomScale1 += 0.05;
            if ($("#divDetailMap").length == 1) {
               $("#divDetailMap").data("mapscale", zoomScale1);
               $("#divDetailMap").css("transform", ("scale(" + zoomScale1 + ")"));
            }
         });
      }
      if ($("#locateZoomSmaller").length == 1) {
         $("#locateZoomSmaller").bind("click", function (e) {
            var zoomScale1 = $("#divDetailMap").data("mapscale");
            if (!$.isNumeric(zoomScale1)) {
               zoomScale1 = 1;
            }
            zoomScale1 -= 0.05;
            if ($("#divDetailMap").length == 1) {
               $("#divDetailMap").data("mapscale", zoomScale1);
               $("#divDetailMap").css("transform", ("scale(" + zoomScale1 + ")"));
            }
         });
      }
      Util.showLibraryMap = function (itemID) {
         $.post(Util.RootHomeFolder + "/SearchResult_GetLibraryMapList", { itemID: itemID },
            function (data) {
               if (!data.bResult) {
                  Util.alert("Invalid Operation", "No maps found.");
                  return;
               }
               if ($("#tipLocateItWin").length == 1) {
                  $("#tipLocateItWin").data().mapList = data.oResult;
                  $("#tipLocateItWin").data().itemID = itemID;
                  if ($("#divDetailMap").length == 1) {
                     $("#divDetailMap").data("mapscale", 1);
                     $("#divDetailMap").css("transform", "scale(1)");
                  }
                  $("#tipLocateItWin").data("kendoWindow").open();
                  $("#tipLocateItWin").data("kendoWindow").center();
                  $("#tipLocateItWin").data("kendoWindow").title(data.strResult);
               }
            });
      };
      window.shelfListChange = getShelflist;
   });
</script>
<script type="text/x-kendo-template" id="oneMapInListTemplate">
   <div class="libraryMapDiv">
      <a href="javascript:void(0);" class="libraryMapBorder" id="libraryMap_#=t455Identifier#" onclick="showMapDetail('libraryMap_#=t455Identifier#', #=t455Identifier#);return false;">
         <img alt="#=ImageName#" id="imgLibMap_#=t455Identifier#" src="#=MapImageUrl#" />
         <span>#=ImageName#</span>
      </a>
      <div class="triangle" style="display:none;"></div>
   </div>
</script>
<script type="text/x-kendo-template" id="mapDetailTemplage">
   <img alt="#=ImageName#" src="#=MapImageUrl#" usemap="#=NumberSign#libraryMap" class="mapper" alt="" onload="detailImageLoad();return false;" />
   #=HighlightList#
   <map id="libraryMapDetail" name="libraryMap">
      #=AreaList#
   </map>
   #=CallNoRangeList#
</script>
<script type="text/x-kendo-template" id="mapDetailHighlightTemplage">
   <div class="HighlightRange CNRangeHighlight" class="cvi_area" style="position:absolute;"></div>
</script>
<script type="text/x-kendo-template" id="oneAreaTemplage">
   <area id="Area#=ConfigIndex#" shape="#=ConfigShape#" #=ConfigOther# coords="#=ConfigCoords#" class="iborder#=ConfigColor# iopacity50 icolor#=ConfigColor#" alt="" />
</script>
<script type="text/x-kendo-template" id="oneCallNoRangeTemplage">
   <div class="cvi_area" style="left:#=Left#px;top:#=Top#px;width:#=Width#px;display:block;visibility:visible;vertical-align:middle;">
      #=CallNoRange#
   </div>
</script>
<div id="tipLocateItWin" style="padding:0;;display:none">
<div style="width: 970px; height: 580px" class="flexlayout">
   <div style="width: 215px; height: 580px; float: left;">
      <div id="divMapList" style="overflow-y: auto; overflow-x: hidden; width: 210px; height: 500px; float: left; background-color: #f5f5f5; margin: 5px 0 0 3px; border: 1px solid #cccccc">
         <div id="divMapListContainer" style="width: 210px; height: 490px; margin: 5px 0;">
         </div>
      </div>
      <div id="divShowShelflist">
         <button id="btnShowShelfListInLocateIt" type="button" title="Show Shelf List" class="btnBookShelf btnWithSprite" style="margin: 22px 0 0 6px; padding: 0 0 0 15px;width:164px;"   >
            Show Shelf List
            <span class="btnSprite"></span>
         </button>
      </div>
   </div>
   <div style="overflow-y: auto; overflow-x: auto; width: 753px; height: 580px; float: left; position: relative; border: 1px solid gray;">
      <div id="divDetailMap" style="float: left">
      </div>
      <div style="position: absolute; left: 2em; top: 2em;">
         <div id="locateZoomBigger" style="border: 1px solid #bbb; border-bottom-width: 0; border-radius: 4px 4px 0 0; padding: 3px 5px; cursor: pointer;">
            <a href="javascript:void(0);" ><img alt="zoom in" src="/Library/Images/enlarge.png" style="width: 24px;" /></a>
         </div>
         <div id="locateZoomSmaller" style="border: 1px solid #bbb; border-radius: 0 0 4px 4px; padding: 3px 5px; cursor: pointer;">
            <a href="javascript:void(0);" ><img alt="zoom out" src="/Library/Images/turndown.png" style="width: 24px;" /></a>
         </div>
      </div>
   </div>
</div>
</div><script>
	jQuery(function(){jQuery("#tipLocateItWin").kendoWindow({"open":onLocateItDialogOpen,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Shelflist","resizable":false,"width":980,"actions":["Close"]});});
</script>
<script>
   function SetRate() { 
      var imgSrc = "/Library/Content" + '/opac/Images/system/Star1_24x24.png';
      var imgSrc_2;
      if (Util.skinName == "White") {
         imgSrc_2 = "/Library/Content" + '/opac/Images/system/star0White.gif';
      }
      else {
         imgSrc_2 = "/Library/Content" + '/opac/Images/system/Star0_24x24.png';
      }
      var e = $("#starReview");
      var theEvent = window.event || arguments.callee.caller.arguments[0];
      var target = theEvent && theEvent.target;
      var imgArray = e.parent().find("img");
      for (var i = 0; i < imgArray.length; i++) {
         imgArray[i]._num = i;
      }
      if (target && target.tagName == "A")//huxiaojing add at 2018-04-12,Ver 8.3.4
         target = target.childNodes[0];
      if (target && target.tagName == "IMG") {
         for (var j = 1; j < imgArray.length; j++) {
            if (j <= target._num) {
               imgArray[j].src = imgSrc_2;
            }
            else {
               imgArray[j].src = imgSrc;
            }
         }
      }
      else {
         for (var k = 1; k < imgArray.length; k++) {
            imgArray[k].src = imgSrc;
         }
      }
      if (target != null)
         window.Brate = target._num + 1;
      else
         window.Brate = 1;
   }
   function AddReview_Ok() {
      var strtxtTag = $("#itemReviewTag").val();
      var strtxtReview = $("#txtItemReviews").val();
      if (!window.Brate)
         window.Brate = 1;
      if (!window.iItemID)
         window.iItemID = 0;
      kendo.ui.progress($("#diglogItemAddReview"), true);
      $.post(Util.RootHomeFolder + "/SearchResult_DoReview", { currentSelectedLibraryID: $("#cboLibraries").data("kendoComboBox").value(), itemID: parseInt(window.iItemID), Rate: window.Brate, strTag: strtxtTag, strReview: strtxtReview }, function (res) {
         if (res != null && res.bResult) {
            var titleStars = "";
            var iRate = 0;
            for (var k = 0; k < 5; k++) {
               if (k < res.iResult) {
                  if (Util.skinName == "White") {
                     titleStars += "<a href='javascript:void(0);'><img src='/Library/Content/opac/Images/system/star0White.gif' alt='star " + (k + 1) + "'/></a>";
                        } else {
                     titleStars += "<a href='javascript:void(0);'><img src='/Library/Content/opac/Images/system/star0.gif' alt='star " + (k + 1) + "'/></a>";
                        }
                     } else {
                  titleStars += "<a href='javascript:void(0);'><img src='/Library/Content/opac/Images/system/star1.gif' alt='star " + (k + 1) + "'/></a>";
                     }
                  }
                  titleStars += res.strResult;
                  if (res.iResult > 0) {
                     if (window.starID != null) {
                        if ((showtype != 1 && showtype != 2) && $("#" + window.starID).length == 1)
                           $("#" + window.starID).html(titleStars);
                        else if (showtype == 2 && $('#iframeEverythingSearch')[0].contentWindow.$(window.starID) != null)
                           $('#iframeEverythingSearch')[0].contentWindow.$("#" + window.starID).html(titleStars);
                     }
                     if (window.ratingCap != null) {
                        if ((showtype != 1 && showtype != 2) && $("#" + window.ratingCap) != null)
                           $("#" + window.ratingCap).css("display", "");
                        else if (showtype == 2 && $('#iframeEverythingSearch')[0].contentWindow.$("#" + window.ratingCap) != null)
                           $('#iframeEverythingSearch')[0].contentWindow.$("#" + window.ratingCap).css("display", "");
                     }
                  }
               }
         kendo.ui.progress($("#diglogItemAddReview"), false);
         window.ReviewInfo = res;
         $("#diglogItemAddReview").data("kendoWindow").close();
      });
   
   }
   function AddReview_Cancel() {
      window.ReviewInfo = null;
      $("#diglogItemAddReview").data("kendoWindow").close();
   }
   var showtype = 0;
   function AddReview_Show(sender, itemid, star, rate) {
      var theEvent = window.event || arguments.callee.caller.arguments[0];
      if (theEvent != null && theEvent.target != null)
         theEvent.target._num = 1;
      SetRate();
      $("#itemReviewTag").val("");
      $("#txtItemReviews").val("");
      $("#txtItemReviews").data("kendoEditor").value("");
      var url = window.location.href;
      var showtype = 0;
      if (url.indexOf('&ifs=') > 0) {
         showtype = parseInt(url.substr((url.indexOf('&ifs=') + 5), 1));
      }
      window.starID = star;
      window.ratingCap = rate;
      $.post(Util.RootHomeFolder + "/SearchResult_GetAddReviewInfo", { itemId: itemid },
              function (data) {
                 if (data.isLogin == "0") {
                    Util.showLogin(this, itemid, 'r', null);
                 }
                 else if (data.givAddReview == "1") {
                    window.iItemID = itemid;
                    window.Brate = 1;
                    window.ReviewInfo = null;
                    $("#lblItemTitle").html(data.sTitle);
                    $("#lblItemRate").html(data.sRate);
                    $("#lblItemReviewTag").html(data.sTag);
                    $("#lblItemReviews").html(data.sReview);
                    $("#txtItemReviewTitle").html(data.sItemTitle);
                    $("#btnReviewOk").html(data.btnOK);
                    $("#btnReviewCancel").html(data.btnCancel);
                    if ($("#diglogItemAddReview").data("kendoWindow") != null) {
                       $("#diglogItemAddReview").data("kendoWindow").title(data.winTitle);
                       $("#diglogItemAddReview").data("kendoWindow").open();
                       $("#diglogItemAddReview").data("kendoWindow").center();
                    }
                 }
                 else {
                    Util.alert("Permission denied", "You do not have the permission.");
                 }
              });

   }
   function AddReviewAfterShow() {
      if ($("#itemReviewTag").length == 1)
         $("#itemReviewTag").focus();
   }
   $(document).ready(function () {
      Util.show_AddReview = AddReview_Show;
      createEditorForReview();
   });

   //add by futao 2015-10-26 ver:6.9.4
   function createEditorForReview() { 
      //if ($("#linkBtnForAddReview").html() != null && $("#linkBtnForAddReview").html() != "") {
      //   return;
      //}
      $("#txtItemReviews").kendoEditor({
         value: "",
         tools: ["formatting", "bold", "italic", "underline", "justifyLeft", "justifyCenter", "justifyRight", "insertUnorderedList", "insertOrderedList", "indent", "outdent", "createLink", "unlink", "insertImage", "createTable", "viewHtml"]
      });

      //$("#linkBtnForAddReview").append($("#divTxtItemReviews >table >tbody>tr:first>td>ul"));
      //$("#divTxtItemReviews >table >tbody>tr:first").hide();
      //$("#divTxtItemReviews >table ").css("background-color", "white");
      //$("#divTxtItemReviews >table ").css("border", "none"); 
   }
   
</script>

<style>
    .k-button
   {
      overflow:hidden;
      padding:1px;
   }
</style>

<div id="diglogItemAddReview" style=" width: 620px; height: 425px;font-size:14px;;display:none">
   <div >
      <div id="lblItemTitle">Title</div>
      <div id="txtItemReviewTitle" style="max-height:38px;width:100%;overflow:auto;min-height:20px;padding:5px 0;"></div> 
      <div id="lblItemRate">Your Rating</div>
      <div >
         <p id="starReview" style ="cursor:pointer;margin-top:3px;margin-bottom:3px" onclick="SetRate()" >
            <a href="javascript:void(0);"><img id="addReviewImg0" src="/Library/Content/opac/Images/system/Star0_24x24.png" alt="star1" /></a>
            <a href="javascript:void(0);"><img id="addReviewImg1" src="/Library/Content/opac/Images/system/Star1_24x24.png" alt="star2"/></a>
            <a href="javascript:void(0);"><img id="addReviewImg2"  src="/Library/Content/opac/Images/system/Star1_24x24.png" alt="star3"/></a>
            <a href="javascript:void(0);"><img id="addReviewImg3"  src="/Library/Content/opac/Images/system/Star1_24x24.png" alt="star4"/></a>
            <a href="javascript:void(0);"><img id="addReviewImg4"  src="/Library/Content/opac/Images/system/Star1_24x24.png" alt="star5"/></a>
         </p>
      </div>
      <label style="line-height:25px;height:25px;" id="lblItemReviewTag" for="itemReviewTag">Tag</label>
      <div>
         <input id="itemReviewTag" class="k-textbox" style="width:100%;height:30px;font-size:14px;" />
      </div>
      <div style="display:inline-block;" id="lblItemReviews">
      Review
      </div>
      
      <div id="divTxtItemReviews">
       
         <textarea style="width:100%;height:80px;"  id="txtItemReviews"></textarea>
      </div>
      <div style="width:100%;margin-top:5px;text-align:right;">
<button class="k-primary" id="btnReviewOk" style="width:80px;height:30px;padding:0;">OK</button><script>
	jQuery(function(){jQuery("#btnReviewOk").kendoButton({"click":AddReview_Ok});});
</script>
<button class="k-primary" id="btnReviewCancel" style="width:80px;margin-left:10px;height:30px;padding:0;">Cancel</button><script>
	jQuery(function(){jQuery("#btnReviewCancel").kendoButton({"click":AddReview_Cancel});});
</script>
      </div>
   </div>
   </div><script>
	jQuery(function(){jQuery("#diglogItemAddReview").kendoWindow({"activate":AddReviewAfterShow,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Add Review","resizable":false,"actions":["Close"]});});
</script>
<script>
   function saveMarc2014(id) {
      $.post(Util.RootHomeFolder + "/SearchResult_DownMarcFile", { itemId: id },
          function (res) {
             if (res != "") {
                document.location.href = "DownLoad?FileName=" + res;
             }
          });
   }
</script><script> 
   function showOverDriveDownload(id) {  
      var win = $("#tipOverDriveDownload").data("kendoWindow");
      win.open().center();
      kendo.ui.progress($("#tipOverDriveDownload"), true);
      $.post(Util.RootHomeFolder + "/OverDrive_InitDownloadDialog", { "id": id }, function (res) {
         win.title(res.captions.lang_Download);
         var o = {};
         o.Captions = res.captions;
         var metadataItem = res.metadataItem;
         if (metadataItem && metadataItem.length) {
            metadataItem = $.parseJSON(metadataItem);
            if (metadataItem.errorCode && metadataItem.message) {
               Util.alert("", metadataItem.message);
               kendo.ui.progress($("#tipOverDriveDownload"), false);
               return;
            }
            if (metadataItem && metadataItem.metadata) {
               if (metadataItem.metadata.length) {
                  metadataItem = metadataItem.metadata[0];
                  o.formats = metadataItem.formats;
                  o.id = metadataItem.id;
                  o.title = metadataItem.title;
                  o.img = (metadataItem.images && metadataItem.images.thumbnail) ? metadataItem.images.thumbnail.href : "";
                  var template = kendo.template($("#overdriveDownloadTemplate").html());
                  $("#div_overDriveDownload").html(template(o));
               }
            }
         }
         kendo.ui.progress($("#tipOverDriveDownload"), false);
      });
      function getFormatName(formatType) {
         switch (formatType) {
            case "ebook-kindle":
               return "Kindle Book";
            case "ebook-overdrive":
               return "OverDrive Read eBook";
            case "ebook-epub-adobe":
               return "Adobe EPUB eBook";
            case "ebook-epub-open":
               return "Open EPUB eBook";
            case "ebook-pdf-adobe":
               return "Adobe PDF eBook";
            case "ebook-pdf-open":
               return "Open PDF eBook";
            case "ebook-mediado":
               return "MediaDo Reader eBook";
            case "periodicals-nook":
               return "NOOK periodicals";
            case "audiobook-overdrive":
               return "OverDrive Listen audiobook";
            case "audiobook-mp3":
               return "MP3 audiobook";
            case "video-streaming":
               return "Streaming Video";
            default:
               return "eBook";
         }
      }
   }

   //Obsolete
   function downloadOverDrive(reserveID, formatID) {
      var me = window.overDriveCheckout;
      var newWin = window.open(Util.RootHomeFolder + "/LoadingPage");
      if (!newWin) return;
      kendo.ui.progress($("#tipOverDriveDownload"), true);  
      $.post(Util.RootHomeFolder + "/OverDriveCheckout_LockAndDownloadFormat", { "reserveID": reserveID, "formatID": formatID },
         function (strResult) {
            kendo.ui.progress($("#tipOverDriveDownload"), false);
            var result = $.parseJSON(strResult);
            if (result.message) {
               Util.alert('', result.message);
            }
            if (result.links && result.links.contentlink && result.links.contentlink.href) { 
               newWin.location = result.links.contentlink.href; 
            } else {
               newWin.close();
            }
         });
   }

	///niko add this 2021-12-21 Ver8.8.3
	function getRedirectLink(reserveID, formatID) {
		var me = window.overDriveCheckout;
		kendo.ui.progress($("#tipOverDriveDownload"), true);

		$.post(Util.RootHomeFolder + "/OverDriveCheckout_GetRedirectLink", { "reserveID": reserveID },
			function (res) {
				kendo.ui.progress($("#tipOverDriveDownload"), false);
				if (res.bResult) {
					window.open(res.strResult);
				}
				else {
					Util.alert('', res.strError);
				}

			});
	}
   Util.showOverDriveDownload = showOverDriveDownload;  

   function dialogOverDriveDownload_close(e) {
      $("#div_overDriveDownload").html("");
   }
</script> 
<script type="text/x-kendo-template" id="overdriveFormatTemplate">
   <input type="button" class="btnNormal" style="margin:0 10px 0 0;width:auto;height:27px;" value="#=formatName#" onclick="downloadOverDrive('#=url#')"/>
</script> 

<script type="text/x-kendo-template" id="overdriveDownloadTemplate">
	<div id="div_itemImg_tipOverDrive" class="itemImg" style="float:left;"><img src='#=img#' title='#=title#' alt='#=title#' /></div>
	<div class="itemTitleInfo" style="float:left;width:370px;margin-left:10px;padding:0;">
		<span class="bold"><span class="blueFont" id="div_itemTitle_tipOverDrive">#=title#</span></span>
		<span class="clear">#=data.Captions.lang_HasBeenCheckout#</span>
		<div class="clear" style="margin:5px 0 0 0;" id="div_formats_tipOverDrive">
		#if(data.formats != null && data.formats.length > 0){#
			#for(var k=0; k < data.formats.length; k++){#
				<button class="btnWithSprite btnOverDriveDownload" style="margin:2px 10px 0 0;width:auto;min-width:140px; padding: 0 5px; " onclick="getRedirectLink('#=id#', '#=data.formats[k].id#')">
					#=data.formats[k].name# <span class="btnSprite"></span>
				</button>
			#}#
		#}#
		</div>
		<span class="clear" style="margin:10px 0 0 0;">#=data.Captions.lang_NotSure# #=data.Captions.lang_Click# <a href="http://help.overdrive.com/customer/portal/articles/1482564" target="_blank" style="text-decoration:underline;">#=data.Captions.lang_Here#</a>.</span>
	</div>
</script>

<div id="tipOverDriveDownload" style="padding:5px;;display:none">
<div class="itemListTable itemListTable2" id="div_overDriveDownload">
   
</div>
<div class="clear"></div>
</div><script>
	jQuery(function(){jQuery("#tipOverDriveDownload").kendoWindow({"close":dialogOverDriveDownload_close,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Get Book","resizable":false,"width":510,"height":145,"actions":["Close"]});});
</script>  <script>
   onCopy_ItemCitations = function (type) {
      var sContent = $("#div_" + type + "_ItemCitations").text();
      Util.confirm("", "Do you want to copy the above info to your clipboard?", function (res) {
         if (res) {
            window.clipboardData.setData("Text", sContent);
         }
      });
   };
   onClose_ItemCitations = function (e) {
      if ($("#winItemCitations").data("kendoWindow") != null) {
         $("#winItemCitations").data("kendoWindow").close();
      }
   };
   function getMLA_ItemCitations(e, itemID) {
      var strDetailHTML = "", s = '';
      if (e) {
         strDetailHTML = strDetailHTML + "<TABLE style='WIDTH: 100%' border=0>";

         strDetailHTML = strDetailHTML + "<TR align=left><TD align=left><div class='GridInfo'  style='overflow-x: hidden; height: auto;'>";


         s = '<table  style="width: 100%;" cellSpacing="0" cellPadding="0"><tbody>';
         s += '<tr style="border:1px solid #c0c0c0;">';
         var sDisplay = '', sDisplayTemp = ''; t02MainEntry = '', t02Title = '', t02PublishPlace = '', t13Name = '', t02DatePublished = '';
         if (e.t02MainEntry != null && e.t02MainEntry.trim() != '') {
            t02MainEntry = e.t02MainEntry;
            if (t02MainEntry.substring(t02MainEntry.length - 1) != ".") {
               t02MainEntry = t02MainEntry + ".";
            }
            t02MainEntry = t02MainEntry + " ";
            sDisplay += t02MainEntry;
         }
         if (e.t02Title != null && e.t02Title.trim() != '') {
            t02Title = e.t02Title.trim();
            if (t02Title.substring(t02Title.length - 1) == ".") {
               t02Title = t02Title.substr(0, t02Title.length - 1);
            }
            if (e.t02Edition != null && e.t02Edition != '') {
               t02Title = t02Title.trim() + " (" + e.t02Edition + ")";
            }
            t02Title = t02Title + ".";

            sDisplay += "<i>" + t02Title + "</i> "; // put space after underline modified by Leo at 2013-06-21 version 6.2 & 6.3
         }
         //if (e.t02PublishPlace != null && e.t02PublishPlace.trim() != '') {
         //   t02PublishPlace = e.t02PublishPlace;
         //   if (t02PublishPlace.substring(t02PublishPlace.length - 1) != ":") {
         //      t02PublishPlace = t02PublishPlace + ":";
         //   }
         //   //add space after colon modified by Leo at 2013-06-21 version 6.2 & 6.3
         //   if (t02PublishPlace.substring(t02PublishPlace.length - 1) != " ") {
         //      t02PublishPlace = t02PublishPlace + " ";
         //   }
         //   sDisplay += t02PublishPlace;
         //   sDisplayTemp += t02PublishPlace;
         //}
         if (e.t13Name != null && e.t13Name.trim() != '') {
            t13Name = e.t13Name;
            if (t13Name.substring(t13Name.length - 1) != ",") {
               t13Name = t13Name + ",";
            }
            //add space after comma modified by Leo at 2013-06-21 version 6.2 & 6.3
            if (t13Name.substring(t13Name.length - 1) != " ") {
               t13Name = t13Name + " ";
            }
            sDisplay += t13Name;
            sDisplayTemp += t13Name;
         }
         if (e.t02DatePublished != null && e.t02DatePublished.trim() != '') {
            t02DatePublished = e.t02DatePublished;
            if (t02DatePublished.substring(t02DatePublished.length - 1) != ".") {
               t02DatePublished = t02DatePublished + ".";
            }
            sDisplay += t02DatePublished;
            sDisplayTemp += t02DatePublished;
         }
         else {//Simon add,if no date,we display (n.d.). 2013-06-05.Version:6.2.0 & 6.3.0
            sDisplay += "(n.d.).";
            sDisplayTemp += "(n.d.).";
         }
         if (sDisplay != '') {
            //if the length more than 60,we may display in two line.and the second line need to vacate 6 characters
            if (sDisplay.replace("<i>", "").replace("</i>", "").length > 60) {
               var clength = 6; //Simon set clength = 6 2012-03-30
               //we need to vacate 6 characters from the second line.
               if (t02Title != '' && t02MainEntry.length < clength) {
                  //the record has title and author,and the length of author is less than 6,we need place author
                  //and part of title(6-length of author) in first td,the rest of title and publisher info in second td.
                  //sDisplayTemp contains the infomation that except author and title.
                  var Title1 = t02Title.substring(0, clength - t02MainEntry.length);
                  var Title2 = t02Title.substring(clength - t02MainEntry.length);
                  s += '<td nowrap="nowrap" style="width:1%;text-align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + t02MainEntry.replace(" ", "&nbsp;")
                     + '<i>' + Title1 + '</i>';
                  s += '</td><td style="width:auto;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">'
                     + '<i>' + Title2 + '</i> ' + sDisplayTemp + '</td></tr>';
               }
               else {
                  s += '<td nowrap="nowrap" style="width:1%;text-align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay.substring(0, clength).replace(" ", "&nbsp;");
                  s += '</td><td style="width:auto;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay.substring(clength) + '</td></tr>';
               }
            }
            else {
               s += '<td style="width:100%;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay + '</td></tr>';
            }
         }
         s += "</tbody></table>";
         strDetailHTML = strDetailHTML + s;
         strDetailHTML = strDetailHTML + "</DIV></TD></TR></TABLE>";
         $("#div_MLA_ItemCitations").html(strDetailHTML);
      }

   };
   function getAPA_ItemCitations(e, itemID) {
      var strDetailHTML = "", s = '';
      if (e) {
         strDetailHTML = strDetailHTML + "<TABLE style='WIDTH: 100%' border=0>";
         strDetailHTML = strDetailHTML + "<TR align=left><TD align=left><div class='GridInfo'  style='overflow-x: hidden; height: auto;'>";

         s = '<table  style="width: 100%;" cellSpacing="0" cellPadding="0"><tbody>';
         s += '<tr style="border:1px solid #c0c0c0;">';
         var sDisplay = '', sDisplayTemp0 = ''; sDisplayTemp = ''; t02MainEntry = '', t02Title = '', t02PublishPlace = '', t13Name = '', t02DatePublished = '';
         if (e.t02MainEntry != null && e.t02MainEntry.trim() != '') {
            t02MainEntry = e.t02MainEntry;
            if (t02MainEntry.substring(t02MainEntry.length - 1) != ".") {
               t02MainEntry = t02MainEntry + ".";
            }
            t02MainEntry = t02MainEntry + " ";
            sDisplay += t02MainEntry;
            //                           sDisplayTemp0 += t02MainEntry;
         }
         if (e.t02DatePublished != null && e.t02DatePublished.trim() != '') {//Simon add t02DatePublished 2012-03-30
            t02DatePublished = e.t02DatePublished;
            if (t02DatePublished.substring(t02DatePublished.length - 1) != ".") {
               t02DatePublished = "(" + e.t02DatePublished + ").";
            }
            sDisplay += t02DatePublished + " ";
            sDisplayTemp += t02DatePublished + " ";
            //                           sDisplayTemp0 += t02DatePublished;
         }
         else {//Simon add,if no date,we display (n.d.). 2013-06-05.Version:6.2.0 & 6.3.0
            sDisplay += "(n.d.). ";
            sDisplayTemp += "(n.d.). ";
         }
         if (e.t02Title != null && e.t02Title.trim() != '') {
            var t02Title = e.t02Title.trim();
            if (t02Title.substring(t02Title.length - 1) == ".") {
               t02Title = t02Title.substr(0, t02Title.length - 1);
            }
            if (e.t02Edition != null && e.t02Edition != '') {
               t02Title = t02Title.trim() + " (" + e.t02Edition + ")";
            }
            t02Title = t02Title + ".";
            //                           t02Title = t02Title;
            sDisplay += "<i>" + t02Title + "</i> "; // put space after italin modified by Leo at 2013-06-21 version 6.2 & 6.3
         }
         //if (e.t02PublishPlace != null && e.t02PublishPlace.trim() != '') {
         //   var t02PublishPlace = e.t02PublishPlace;
         //   if (t02PublishPlace.substring(t02PublishPlace.length - 1) != ":") {
         //      t02PublishPlace = t02PublishPlace + ":";
         //   }
         //   // put space after colon modified by Leo at 2013-06-21 version 6.2 & 6.3
         //   if (t02PublishPlace.substring(t02PublishPlace.length - 1) != " ") {
         //      t02PublishPlace = t02PublishPlace + " ";
         //   }
         //   sDisplay += t02PublishPlace;
         //   sDisplayTemp += t02PublishPlace;
         //}
         if (e.t13Name != null && e.t13Name.trim() != '') {
            var t13Name = e.t13Name;
            if (t13Name.substring(t13Name.length - 1) != ".") {
               t13Name = t13Name + ".";
            }
            sDisplay += t13Name;
            sDisplayTemp += t13Name;
         }

         if (sDisplay != '') {
            //if the length more than 60,we may display in two line.and the second line need to vacate 6 characters
            if (sDisplay.replace("<i>", "").replace("</i>", "").length > 60) {
               var clength = 6; //Simon set clength = 6 2012-03-30
               //we need to vacate 6 characters from the second line.
               if (t02Title != '' && t02MainEntry.length < clength) {
                  //the record has title and author,and the length of author is less than 6,we need place author
                  //and part of title(6-length of author) in first td,the rest of title and publisher info in second td.
                  //sDisplayTemp contains the infomation that except author and title.
                  var Title1 = t02Title.substring(0, clength - t02MainEntry.length);
                  var Title2 = t02Title.substring(clength - t02MainEntry.length);
                  s += '<td nowrap="nowrap" style="width:1%;text-align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + t02MainEntry.replace(" ", "&nbsp;")
                     + '<i>' + Title1 + '</i>';
                  s += '</td><td style="width:auto;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">'
                     + '<i>' + Title2 + '</i> ' + sDisplayTemp + '</td></tr>';
               }
               else {
                  s += '<td nowrap="nowrap" style="width:1%;text-align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay.substring(0, clength).replace(" ", "&nbsp;");
                  s += '</td><td style="width:auto;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay.substring(clength) + '</td></tr>';
               }
            }
            else {
               s += '<td style="width:100%;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay + '</td></tr>';
            }
         }
         s += "</tbody></table>";
         strDetailHTML = strDetailHTML + s;
         strDetailHTML = strDetailHTML + "</DIV></TD></TR></TABLE>";
         $("#div_APA_ItemCitations").html(strDetailHTML);
      }

   };
   function getChicago_ItemCitations(e, itemID) {
      var strDetailHTML = "", s = '';
      if (e) {
         strDetailHTML = strDetailHTML + "<TABLE style='WIDTH: 100%' border=0>";

         strDetailHTML = strDetailHTML + "<TR align=left><TD align=left><div class='GridInfo'  style='overflow-x: hidden; height: auto;'>";

         s = '<table  style="width: 100%;" cellSpacing="0" cellPadding="0"><tbody>';
         s += '<tr style="border:1px solid #c0c0c0;">';
         var sDisplay = '', sDisplayTemp = ''; t02MainEntry = '', t02Title = '', t02PublishPlace = '', t13Name = '', t02DatePublished = '';
         if (e.t02MainEntry != null && e.t02MainEntry.trim() != '') {
            t02MainEntry = e.t02MainEntry;
            if (t02MainEntry.substring(t02MainEntry.length - 1) != ".") {
               t02MainEntry = t02MainEntry + ".";
            }
            t02MainEntry = t02MainEntry + " ";
            sDisplay += t02MainEntry;
         }
         if (e.t02Title != null && e.t02Title.trim() != '') {
            t02Title = e.t02Title.trim();
            if (t02Title.substring(t02Title.length - 1) == ".") {
               t02Title = t02Title.substr(0, t02Title.length - 1);
            }
            if (e.t02Edition != null && e.t02Edition != '') {
               t02Title = t02Title.trim() + " (" + e.t02Edition + ")";
            }
            t02Title = t02Title + ".";
            sDisplay += "<i>" + t02Title + "</i> "; // put space after italin modified by Leo at 2013-06-21 version 6.2 & 6.3
         }
         if (e.t02PublishPlace != null && e.t02PublishPlace.trim() != '') {
            t02PublishPlace = e.t02PublishPlace;
            if (t02PublishPlace.substring(t02PublishPlace.length - 1) != ":") {
               t02PublishPlace = t02PublishPlace + ":";
            }
            //add space after colon modified by Leo at 2013-06-21 version 6.2 & 6.3
            if (t02PublishPlace.substring(t02PublishPlace.length - 1) != " ") {
               t02PublishPlace = t02PublishPlace + " ";
            }
            sDisplay += t02PublishPlace;
            sDisplayTemp += t02PublishPlace;
         }
         if (e.t13Name != null && e.t13Name.trim() != '') {
            t13Name = e.t13Name;
            if (t13Name.substring(t13Name.length - 1) != ",") {
               t13Name = t13Name + ",";
            }
            //add space after comma modified by Leo at 2013-06-21 version 6.2 & 6.3
            if (t13Name.substring(t13Name.length - 1) != " ") {
               t13Name = t13Name + " ";
            }
            sDisplay += t13Name;
            sDisplayTemp += t13Name;
         }
         if (e.t02DatePublished != null && e.t02DatePublished.trim() != '') {
            t02DatePublished = e.t02DatePublished;
            if (t02DatePublished.substring(t02DatePublished.length - 1) != ".") {
               t02DatePublished = t02DatePublished + ".";
            }
            sDisplay += t02DatePublished;
            sDisplayTemp += t02DatePublished;
         }
         else {//Simon add,if no date,we display n.d. 2013-06-05.Version:6.2.0 & 6.3.0
            sDisplay += "n.d.";
            sDisplayTemp += "n.d.";
         }
         if (sDisplay != '') {
            //if the length more than 60,we may display in two line.and the second line need to vacate 6 characters
            if (sDisplay.replace("<i>", "").replace("</i>", "").length > 60) {
               var clength = 6; //Simon set clength = 6 2012-03-30
               //we need to vacate 6 characters from the second line.
               if (t02Title != '' && t02MainEntry.length < clength) {
                  //the record has title and author,and the length of author is less than 6,we need place author
                  //and part of title(6-length of author) in first td,the rest of title and publisher info in second td.
                  //sDisplayTemp contains the infomation that except author and title.
                  var Title1 = t02Title.substring(0, clength - t02MainEntry.length);
                  var Title2 = t02Title.substring(clength - t02MainEntry.length);
                  s += '<td nowrap="nowrap" style="width:1%;text-align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + t02MainEntry.replace(" ", "&nbsp;")
                     + '<i>' + Title1 + '</i>';
                  s += '</td><td style="width:auto;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">'
                     + '<i>' + Title2 + '</i> ' + sDisplayTemp + '</td></tr>';
               }
               else {
                  s += '<td nowrap="nowrap" style="width:1%;text-align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay.substring(0, clength).replace(" ", "&nbsp;");
                  s += '</td><td style="width:auto;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay.substring(clength) + '</td></tr>';
               }
            }
            else {
               s += '</td><td style="width:100%;text-align:left;align:left; vertical-align:top; padding-top: 3px; padding-bottom: 3px;">' + sDisplay + '</td></tr>';
            }
         }
         s += "</tbody></table>";
         strDetailHTML = strDetailHTML + s;
         strDetailHTML = strDetailHTML + "</DIV></TD></TR></TABLE>";

         $("#div_Chicago_ItemCitations").html(strDetailHTML);
      }
   };
   function showItemCitations(itemID) {
      $.ajax({
         type: "POST",
         url: Util.RootHomeFolder + "/ItemDetail_GetItemCitations",
         data: "itemID=" + itemID,
         success: function (list) {
            if (list != null && list.length == 3) {
               getMLA_ItemCitations(list[0], itemID);
               getAPA_ItemCitations(list[1], itemID);
               getChicago_ItemCitations(list[2], itemID);
            }    
            if (!window.clipboardData) {//not IE 
               $("#winItemCitations .iecopy_itemcitations").remove();
            }
              
            if ($("#winItemCitations").data("kendoWindow") != null) {
               $("#winItemCitations").data("kendoWindow").center().open();
            }
         }
      });
   };
   $(document).ready(function () {
      Util.showItemCitations = showItemCitations;
   });
</script>


<div id="winItemCitations" style="display:none">
   <div style="margin-top:10px;padding:5px;border:1px solid #e3e3e3">
      <div style="display: flex; display: -webkit-flex;min-height:50px;">
         <div style="width:60px;font-size:14px;margin-top:3px;" class="itemCitationsContent"> MLA</div>
         <div class="iecopy_itemcitations"> 
<button class="k-primary" id="btnMLACopy_ItemCitations" onclick="onCopy_ItemCitations(&#39;MLA&#39;);return true;" style="width:60px;height:30px;" title="Copy" type="button">Copy</button><script>
	jQuery(function(){jQuery("#btnMLACopy_ItemCitations").kendoButton({});});
</script>
         </div>
         <div id="div_MLA_ItemCitations" style="flex:1;-webkit-flex:1">

         </div>
      </div>
      <div style="display: flex; display: -webkit-flex;min-height:50px;">
         <div style="width:60px;font-size:14px;margin-top:3px;" class="itemCitationsContent">APA </div>
         <div class="iecopy_itemcitations"> 
<button class="k-primary" id="btnAPACopy_ItemCitations" onclick="onCopy_ItemCitations(&#39;APA&#39;);return true;" style="width:60px;height:30px;" title="Copy" type="button">Copy</button><script>
	jQuery(function(){jQuery("#btnAPACopy_ItemCitations").kendoButton({});});
</script>
         </div>
         <div id="div_APA_ItemCitations"  style="flex:1;-webkit-flex:1">

         </div>
      </div>
      <div style="display: flex; display: -webkit-flex;min-height:50px;">
         <div style="width:60px;font-size:14px;margin-top:3px;" class="itemCitationsContent">Chicago</div>
         <div class="iecopy_itemcitations"> 
<button class="k-primary" id="btnChicagoCopy_ItemCitations" onclick="onCopy_ItemCitations(&#39;Chicago&#39;);return true;" style="width:60px;height:30px;" title="Copy" type="button">Copy</button><script>
	jQuery(function(){jQuery("#btnChicagoCopy_ItemCitations").kendoButton({});});
</script>
         </div>
         <div id="div_Chicago_ItemCitations"  style="flex:1;-webkit-flex:1">

         </div>
      </div>
   </div>
   <div style="display: flex; display: -webkit-flex;justify-content:flex-end;-webkit-justify-content:flex-end;margin-bottom:10px;padding:5px">
<button class="k-primary" id="btnClose_ItemCitations" onclick="onClose_ItemCitations(this);return true;" style="width:80px;height:30px;" title="Close" type="button">Close</button><script>
	jQuery(function(){jQuery("#btnClose_ItemCitations").kendoButton({});});
</script>
   </div>
   </div><script>
	jQuery(function(){jQuery("#winItemCitations").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Citations","resizable":false,"width":660,"actions":["Close"]});});
</script><div id="winPartonBook" style="padding:2px;display:none">
   <div id="divWinPartonBook" style="margin: 5px auto; width: 400px">
      <div style="padding: 2px; width: 390px; height: 30px;">
         <div style="width: 150px; display: table-cell; vertical-align: middle">
            <label for="dtpDateFrom">Require From</label></div>
         <div style="width: 120px; display: table-cell;">
<input id="dtpDateFrom" name="dtpDateFrom" style="width:120px;" type="text" value="13/04/2025" /><script>
	jQuery(function(){jQuery("#dtpDateFrom").kendoDatePicker({"change":oPatronBook.onDateFromChange,"format":"dd/MM/yyyy","min":new Date(1900,0,1,0,0,0,0),"max":new Date(2099,11,31,0,0,0,0)});});
</script>
         </div>
         <div style="width: 120px; display: table-cell; vertical-align: middle;">
            <div id="divTimeFrom" style="display: none; padding-left: 3px;">
               <div style="height: 1px; width: 1px; padding: 0px; margin: 0px; overflow: hidden">
                  <label style="text-indent: -9999em; width: 1px; padding: 0px; margin: 0px;" for="dtpTimeFrom">From Time</label>
               </div>
<input id="dtpTimeFrom" name="dtpTimeFrom" style="width:110px;" type="text" value="07:44 PM" /><script>
	jQuery(function(){jQuery("#dtpTimeFrom").kendoTimePicker({"change":oPatronBook.onTimeFromChange,"format":"hh:mm tt","min":new Date(2025,3,13,0,0,0,0),"max":new Date(2025,3,13,0,0,0,0),"interval":15});});
</script>
            </div>
         </div>
      </div>
      <div style="padding: 2px; width: 390px; height: 30px;">
         <div style="width: 150px; display: table-cell; vertical-align: middle">
            <label for="dtpDateTo">Require Until</label></div>
         <div style="width: 120px; display: table-cell;">
<input id="dtpDateTo" name="dtpDateTo" style="width:120px;" type="text" value="13/04/2025" /><script>
	jQuery(function(){jQuery("#dtpDateTo").kendoDatePicker({"change":oPatronBook.onDateFromChange,"format":"dd/MM/yyyy","min":new Date(1900,0,1,0,0,0,0),"max":new Date(2099,11,31,0,0,0,0)});});
</script>
         </div>
         <div style="width: 120px; display: table-cell; vertical-align: middle;">
            <div id="divTimeTo" style="display: none; padding-left: 3px;">
               <div style="height: 1px; width: 1px; padding: 0px; margin: 0px; overflow: hidden">
                  <label style="text-indent: -9999em; width: 1px; padding: 0px; margin: 0px;" for="dtpTimeTo">To Time</label>
               </div>
<input id="dtpTimeTo" name="dtpTimeTo" style="width:110px;" type="text" value="07:44 PM" /><script>
	jQuery(function(){jQuery("#dtpTimeTo").kendoTimePicker({"change":oPatronBook.onTimeFromChange,"format":"hh:mm tt","min":new Date(2025,3,13,0,0,0,0),"max":new Date(2025,3,13,0,0,0,0),"interval":15});});
</script>
            </div>
         </div>
      </div>

      <div id="divPickupLibrary_PatronBook" style="padding: 2px; width: 390px; height: 30px; display:none;">
         <div style="width: 150px; display: table-cell; vertical-align: middle">
            <label id="lblPickupLibrary_PatronBook" for="cboPickupLibrary_PatronBook_input">Pickup Library</label>
         </div>
         <div style="width: 240px; display: table-cell;">
<input aria-labelledby="lblPickupLibrary_PatronBook" id="cboPickupLibrary_PatronBook" name="cboPickupLibrary_PatronBook" style="width:100%;" type="text" /><script>
	jQuery(function(){jQuery("#cboPickupLibrary_PatronBook").kendoComboBox({"animation":false,"dataTextField":"Text","dataValueField":"Value"});});
</script>
         </div>
      </div>   

      <div style="padding: 2px; width: 390px; height: 25px;">
         <div style="width: 150px; display: table-cell; vertical-align: middle">
            <span id="lblAllowOut"></span>
         </div>
         <div style="width: 240px; display: table-cell; text-align: left;">
            <span class="Itemlblinfo" id="lblLoanPeriod"></span>
         </div>
      </div>
      <div style="padding: 2px; width: 390px; height: 25px; text-align: left">
<input class="k-checkbox" id="chkOverrideLoanPeriod" name="chkOverrideLoanPeriod" type="checkbox" value="true" /><label class="k-checkbox-label" for="chkOverrideLoanPeriod">Override Loan Period</label><input name="chkOverrideLoanPeriod" type="hidden" value="false" />
      </div>

      <div style="padding: 2px; width: 390px; text-align: center">
<button class="k-primary" id="btnWinPartonBookOk" style="padding:0px;">Book</button><script>
	jQuery(function(){jQuery("#btnWinPartonBookOk").kendoButton({"click":oPatronBook.onWinPartonBookOkClick});});
</script>
      </div>
   </div>
   </div><script>
	jQuery(function(){jQuery("#winPartonBook").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Booking","resizable":false,"width":420,"actions":["Close"]});});
</script>
<script>
   var AddToFavorite = AddToFavorite || {};
   AddToFavorite = {
      itemlist: null,
      Win: null,
      Txt: null,
      Cbo: null,
      Cbodata: [],
      langaddYourFavorites: "",
      KeepFavoriteAfterLogout: 0,
      bDigital: false,
      getItemInfoCheckedIdentifier: function (currentIdentifier, needQty, returnString) {
         var me = AddToFavorite;
         var strList = "";
         var aryList = new Array();
         var chkRows = $("input[name='chk_Item']");
         if (!me.bDigital) {
            chkRows.each(function () {
               if (this.checked) {
                  if (strList.length > 0) strList += ",";
                  strList += this.id.replace("chk_Item", "") + (needQty ? "|1" : "");
                  aryList.push(this.id.replace("chk_Item", "") + (needQty ? "|1" : ""));
               }
               else {
                  var a = 1;
               }
            });
         }
         if (returnString) {
            if (strList.length > 0) {
               return strList;
            }
            else {
               return currentIdentifier + "";
            }
         }
         else {
            if (aryList.length > 0) {
               return aryList;
            }
            else {
               return currentIdentifier;
            }
         }
      }
   }
   function OnFavTitleChanged(e) {
      if (!e.sender.dataItem()) return false;
      showOrhideTxt();
   }
   function showOrhideTxt() {
      var me = AddToFavorite;
      var length = me.Cbodata.length;
      if (length == 1) {
         me.Txt.css("visibility", "visible");
         return;
      }
      var id = parseInt(me.Cbo.value());
      if (id > 0) {
         me.Txt.css("visibility", "hidden");
      }
      else {
         me.Txt.css("visibility", "visible");
         me.Txt.focus();
      }
   }
   function favoritettxt_keydown(e) {
      var me = AddToFavorite;
      e = e || event;
      var keyCode = e.which | e.keyCode;
      if (keyCode == 13) {
         AddToFavorite_Ok();
      }
   }
   function AddToFavorite_Ok() {
      var me = AddToFavorite;
      var itemIDlist = me.itemlist;
      var cboFavTitles = me.Cbo;
      var id = -1;
      var favTitle = "";
      var length = me.Cbodata.length;
      var id = parseInt(cboFavTitles.value());
      favTitle = me.Txt.val();
      if (!favTitle) {
         favTitle = "";
      }
      favTitle = favTitle.replace(/(^\s*)|(\s*$)/g, "");
      if (id == -1 && favTitle.length == 0) {
         return;
      }
      if (id > 0 && favTitle.length == 0) {
         for (var j = 0; j < me.Cbodata.length; j++) {
            if (parseInt(id) == parseInt(me.Cbodata[j].ID)) {
               if (me.Cbodata[j].IsReadonly && !me.Cbodata[j].Own) {
                  Util.alert("Access denied", "This is a favorite created and shared by someone else. You cannot add books into this favorite.");
                  return;
               }
            }
         }
      }
      me.Win.close();
      $.post(Util.RootHomeFolder + "/SearchResult_AddFavoriteTitle", { strNewFavTitle: favTitle, strFavTitleID: id, itemIDList: itemIDlist, bDigital: me.bDigital },
         function (res) {
         });
   }
   function AddToFavorite_Cancel() {
      var me = AddToFavorite;
      me.Win.close();
   }
   function addtofav(Currentitemid, list, bDigital) {
      var me = AddToFavorite;
      me.sortByOrder = "a";
      $("#btnFavSearchSortImg").attr("src", "Images/system/sort_asc.png");
      me.bDigital = bDigital == "1" || bDigital == "digital";
      if (list != null) {
         me.itemlist = list;
      }
      else {
         me.itemlist = me.getItemInfoCheckedIdentifier(Currentitemid, false, true);
      }
      $.post(Util.RootHomeFolder + "/SearchResult_GetfavoriteCaption", null,
         function (res) {
            me.KeepFavoriteAfterLogout = parseInt(res[30]);
            var sessionSort = "";
            if (res.length > 32) {
               $("#lblFavSortBy").html(res[32] + ": ");
            }
            if (res.length > 33) {
               sessionSort = res[33];
            }
            if (me.KeepFavoriteAfterLogout == 0) {
               $.post(Util.RootHomeFolder + "/SearchResult_AddFavoriteTitle", { strNewFavTitle: "", strFavTitleID: "-1", itemIDList: me.itemlist, bDigital: me.bDigital },
                  function (res) {
                  });
            }
            else {
               if (!res[31]) {
                  Util.showLogin(me, me.itemlist, 'a', me.bDigital,null);
               }
               else {
                  me.langaddYourFavorites = res[3];
                  me.Txt = $("#favoritettxt");
                  me.Txt.val("");
                  me.Txt.css("visibility", "hidden");
                  me.Cbo = $("#cboFavTitles").data("kendoComboBox");
                  me.Cbo.setDataSource(null);
                  me.Win = $("#tipAddFavoritesWin").data("kendoWindow");
                  me.Win.setOptions({
                     title: me.langaddYourFavorites
                  });
                  $.post(Util.RootHomeFolder + "/SearchResult_GetMyFavoriteTitles", { favoriteID: -1 },
                     function (res) {
                        if (res.oResult && res.oResult[0]) {
                           me.Cbodata = res.oResult[0];
                        }
                        else {
                           me.Cbodata = [];
                        }
                        me.noSortData = $.extend(true, [], me.Cbodata);
                        var firstSelected = "";
                        if (sessionSort) {
                           var strList = sessionSort.split(";");
                           if (strList.length == 2) {
                              me.sortByOrder = strList[1];
                              firstSelected = strList[0];
                           }
                        }
                        else {
                           me.sortByOrder = "a";
                           firstSelected = "Title";
                        }
                        if (me.sortByOrder == "d") {
                           $("#btnFavSearchSortImg").attr("src", "Images/system/sort_desc.png");
                           $("#btnFavSearchSortImg").attr("alt", "sort descending");
                        }
                        else {
                           $("#btnFavSearchSortImg").attr("src", "Images/system/sort_asc.png");
                           $("#btnFavSearchSortImg").attr("alt", "sort ascending");
                        }
                        me.notFetch = true;
                        if (res.oResult && res.oResult.SortList) {
                           $("#cboFavSortBy").data("kendoComboBox").setDataSource(res.oResult.SortList);
                           if (!firstSelected) {
                              firstSelected = res.oResult.SortList[0].Value;
                           }
                        }
                        $("#cboFavSortBy").data("kendoComboBox").value(firstSelected);
                        $("#cboFavSortBy").val(firstSelected).trigger("change");
                        addtoFav_SortDatas();
                        me.notFetch = false;
                        if (me.Cbodata.length > 0) {
                           me.Cbo.select(0);
                           $("#cboFavTitles").val(me.Cbodata[0].Value).trigger("change");
                        }
                        showOrhideTxt();
                        me.Win.center().open();
                     });
               }
            }
         });
   }
   function onFavSortByChange(e) {
      var me = AddToFavorite;
      if (me.notFetch)
         return;
      var select = this.value();
      if (select == "Title") {
         me.sortByOrder = "a";
         $("#btnFavSearchSortImg").attr("src", "Images/system/sort_asc.png");
         $("#btnFavSearchSortImg").attr("alt", "sort ascending");
      }
      else {
         me.sortByOrder = "d";
         $("#btnFavSearchSortImg").attr("src", "Images/system/sort_desc.png");
         $("#btnFavSearchSortImg").attr("alt", "sort descending");
      }
      cboFavorite_SoryBy();
   }
   function cboFavorite_SoryBy() {
      var me = AddToFavorite;
      var select = $("#cboFavSortBy").data("kendoComboBox").value();
      $.post(Util.RootHomeFolder + "/Dialog_AddToFavorite_SessionSort", { strSort: select + ";" + me.sortByOrder }, function (res) {
         addtoFav_SortDatas();
      });
   }
   function addtoFav_SortDatas() {
      var me = AddToFavorite;
      var select = $("#cboFavSortBy").data("kendoComboBox").value();
      var temp = $.extend(true, [], me.noSortData);
      var tempOwn = $.grep(temp, function (d) {
         return d.Own;
      });
      var tempOther = $.grep(temp, function (d) {
         return !d.Own;
      });
      if (me.sortByOrder == "a") {
         tempOwn.sort(function (a, b) {
            return a[select] > b[select] ? 1 : a[select] < b[select] ? -1 : 0;
         });
         tempOther.sort(function (a, b) {
            return a[select] > b[select] ? 1 : a[select] < b[select] ? -1 : 0;
         });
      }
      else {
         tempOwn.sort(function (a, b) {
            return a[select] > b[select] ? -1 : a[select] < b[select] ? 1 : 0;
         });
         tempOther.sort(function (a, b) {
            return a[select] > b[select] ? -1 : a[select] < b[select] ? 1 : 0;
         });
      }
      me.Cbodata = [];
      me.Cbodata = me.Cbodata.concat(tempOwn);
      me.Cbodata = me.Cbodata.concat(tempOther);
      me.Cbodata.push({ ID: -1, Title: 'New Favorite Title' });
      me.Cbo.setDataSource(me.Cbodata);
      if (me.Cbodata.length > 0) {
         me.Cbo.select(0);
         $("#cboFavTitles").val(me.Cbodata[0].Value).trigger("change");
      }
   }
   function onFavSortArrowClick() {
      var me = AddToFavorite;
      if (me.sortByOrder == "a") {
         me.sortByOrder = "d";
         $("#btnFavSearchSortImg").attr("src", "Images/system/sort_desc.png");
         $("#btnFavSearchSortImg").attr("alt", "sort descending");
      }
      else {
         me.sortByOrder = "a";
         $("#btnFavSearchSortImg").attr("src", "Images/system/sort_asc.png");
         $("#btnFavSearchSortImg").attr("alt", "sort ascending");
      }
      cboFavorite_SoryBy();
   }
   $(document).ready(function () {
      Util.addtofav = addtofav;
   });
</script>
<style>
   .btnSearchSort
   {
      display: inline-block;
      width: 30px;
      height: 30px;
      margin-left: 3px;
      border-radius: 6px;
   }
   .btnSearchSort img
   {
      margin: 6px;
   }
</style>
<div id="tipAddFavoritesWin" style="display:none">
   <div style="margin:0 3px;line-height:30px;">
      <div style="display: inline-block;vertical-align:top;width:110px;"  >
         <label for="cboFavSortBy_input" id="lblFavSortBy">Favorites Sort By:</label>
      </div>
      <div  style="display: inline-block; width: 140px; overflow: hidden;">
<input aria-labelledby="lblFavSortBy" id="cboFavSortBy" name="cboFavSortBy" style="width: 140px;" type="text" /><script>
	jQuery(function(){jQuery("#cboFavSortBy").kendoComboBox({"change":onFavSortByChange,"dataTextField":"Text","dataValueField":"Value","index":0});});
</script>
      </div>

      <div style="display:inline-block;">
         <button class="btnSearchSort" onclick="onFavSortArrowClick();return false;" style="margin-top:-20px;">
            <img alt="" id="btnFavSearchSortImg"  src="/Library/Images/system/sort_asc.png" />
         </button>
      </div>
   </div>
   <div>
      <div style="height:1px; width: 1px; padding: 0px; margin: 0px;overflow:hidden">
         <label style="text-indent: -9999em; width: 1px; padding: 0px; margin: 0px;" for="cboFavTitles_input" id="lblFavTitles">Favorites Title List</label>
      </div>
<input aria-labelledby="lblFavTitles" id="cboFavTitles" name="cboFavTitles" style="width:100%;" type="text" /><script>
	jQuery(function(){jQuery("#cboFavTitles").kendoComboBox({"change":OnFavTitleChanged,"dataTextField":"Title","dataValueField":"ID"});});
</script>
   </div>
   <div>
      <div style="height:1px; width: 1px; padding: 0px; margin: 0px;overflow:hidden">
         <label style="text-indent: -9999em; width: 1px; padding: 0px; margin: 0px;" for="favoritettxt" >Please Input New Favorite Title</label>
      </div>
<input class="k-textbox" id="favoritettxt" name="favoritettxt" onkeydown="favoritettxt_keydown" style="width:100%;visibility:hidden;margin-top:2px;" />

   </div>
   <div style="margin-top:10px;text-align:right;">
<button class="k-primary" id="btnAddFavoritesOk" style="width:80px;height:30px;">OK</button><script>
	jQuery(function(){jQuery("#btnAddFavoritesOk").kendoButton({"click":AddToFavorite_Ok});});
</script>
<button class="k-primary" id="btnAddFavoritesCancel" style="width:80px;margin-left:10px;height:30px;">Cancel</button><script>
	jQuery(function(){jQuery("#btnAddFavoritesCancel").kendoButton({"click":AddToFavorite_Cancel});});
</script>
   </div>
   </div><script>
	jQuery(function(){jQuery("#tipAddFavoritesWin").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Add Your Favorites","resizable":false,"width":320,"actions":["Close"]});});
</script>
<script>
   var TextMeDialog = TextMeDialog || {};
   TextMeDialog = {
      Win: null,
      Txt: null,
      TxtArea: null,
      TxtTitle: null,
      Cbo: null,
      Cbodata: new Array(),
      Btn: null
   }
   function btnTextMe_Click(e) {
      var me = TextMeDialog;
      var txtPN = me.Txt.val();
      var cboID = me.Cbo.value();
      var txtMsg = me.TxtArea.val();
      var strItemID = me.TextMeItemID.val();//add by futao 2015-10-28 ver:6.9.4  
      $.post(Util.RootHomeFolder + "/SearchResult_SendMessage",
         {
            txtCellNo: txtPN,
            cboCarrieID: cboID,
            txtMessage: txtMsg,
            title: me.TxtTitle.val(),
            itemID: strItemID == null ? "0" : strItemID,
            bDigital: me.bDigital,
            tabIndex: ($("#hifs").length > 0 ? parseInt($("#hifs").val()) : null)
         },
         function (res) {
            if (res == false) { }
         });
      me.Win.close();
   }
   //Last modified by futao 2015-10-28 ver:6.9.4 add itemID
   function showContactForm(message, e, itemID, bDigital) {
      var me = TextMeDialog;
      me.bDigital = bDigital == "digital" || bDigital == true;
      $.post(Util.RootHomeFolder + "/SearchResult_GetCarrierValues", null,
         function (res) {
            var phoneNumber = res.phone;
            var titleCap = res.TextItToMeCap;
            me.Cbodata = res.cbodata;
            me.Txt = $("#txtPhoneNumber");
            me.Txt.val(phoneNumber);
            me.Cbo = $("#cboMobileCarrier").data("kendoComboBox");
            me.Cbo.setDataSource(me.Cbodata);
            me.Cbo.select(-1);
            me.TxtArea = $("#txtTextMeMessage");
            me.TxtArea.val("");
            me.TxtTitle = $("#txtTextMeTitle");
            me.TxtTitle.val(message);

            me.TextMeItemID = $("#txtTextMeItemID");//add by futao 2015-10-28 ver:6.9.4 
            me.TextMeItemID.val(itemID);

            me.Btn = $("#btnTextMe");
            me.Btn.html(titleCap);
            me.Win = $("#tipTextMeWin").data("kendoWindow");
            me.Win.setOptions({
               title: titleCap,
               autoFocus: false
            });
            me.HideCarrier = res.HideCarrier;
            if (res.HideCarrier) { //huanglidan add at 2016-05-13,ver 7.1.3
               $("#lbl_textme_mobileCarrier").hide();
               $("#cboMobileCarrier").data("kendoComboBox").wrapper.hide();
            }
            me.Win.center().open();
            me.Txt.focus();
         });
   }
   $(document).ready(function () {
      Util.textItToMe = showContactForm;
   });
</script>
<div id="tipTextMeWin" style="display:none">
   <label id="lbl_textme_phoneNo" style=" display:block; margin:5px 0px;" for="txtPhoneNumber">Phone Number</label>
   <div><input class="k-textbox" id="txtPhoneNumber" name="txtPhoneNumber" placeholder="Please Input Phone Number" required="required" style="width:100%;" /></div>
   <label id="lbl_textme_mobileCarrier" for="cboMobileCarrier_input" style=" display:block; margin:5px 0px;">Mobile Carrier</label>
   <div><input aria-labelledby="lbl_textme_mobileCarrier" id="cboMobileCarrier" name="cboMobileCarrier" required="required" style="width:100%;" type="text" /><script>
	jQuery(function(){jQuery("#cboMobileCarrier").kendoComboBox({"dataTextField":"value","dataValueField":"id","placeholder":"Please Select Mobile Carrier"});});
</script></div>
   <label id="lbl_textme_mssage" for="txtTextMeMessage" style=" display:block; margin:5px 0px;">Message</label>
   <div>
      <textarea id="txtTextMeMessage" name="txtTextMeMessage" class="k-textbox" required="required" style="width: 100%; height: 124px;"></textarea>
      <input id="txtTextMeTitle" type="hidden" />
      <input id="txtTextMeItemID" type="hidden" />
   </div>
   <div style="margin-top:10px;text-align:right;">
<button class="k-primary" id="btnTextMe" style="width:80px;height:30px;">Text Me</button><script>
	jQuery(function(){jQuery("#btnTextMe").kendoButton({"click":btnTextMe_Click});});
</script>
   </div>
   </div><script>
	jQuery(function(){jQuery("#tipTextMeWin").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Text Me","resizable":false,"width":500,"actions":["Close"]});});
</script>
<script>
   function AddRating_2014(o) {
      this.init(o);
   }
   AddRating_2014.prototype = {
      InstantName: null,
      win: null,
      ratingHtml: "",
      sTitle: "",
      sItemTitle: "",
      sRate: "",
      swinTitle: "",
      sbtnOK: "",
      sbtnCancel: "",
      sbtnOK: "",
      sbtnCancel: "",
      doRateLoadMask: null,
      isGraphic: "0",
      init: function (o) {
         this.InstantName = o;
         this.ratingHtml = this.show_EditRating();
      },
      show: function (sender, itemID, callback) {
         sender = sender == null ? $(document.body) : sender;
         var me = this;
         window.iItemID = itemID;
         window.Brate = 1;
         window.RatingResult = null;
         me.ratingHtml = me.show_EditRating();
         $.post(Util.RootHomeFolder + "/SearchResult_AddRatingInfo", { itemID: itemID, bDigital: window.digitalResult },
             function (res) {
                me.sTitle = res.sTitle;
                me.sItemTitle = res.sItemTitle;
                me.sRate = res.sRate;
                me.swinTitle = res.winTitle;
                me.sbtnOK = res.btnOK;
                me.sbtnCancel = res.btnCancel;
                var RatingTemplate = kendo.template($("#RatingTemplate").html());
                $("#divRatingDialogContent").html(RatingTemplate(me));
                kendo.bind($("#divRatingDialogContent"), me);
                me.showContactForm(sender, callback);
             });
      },
      showContactForm: function (sender, callback) {
         var me = this;
         me.win = $("#tipRatingWin").data("kendoWindow");
         me.win.setOptions({
            close: function (e) {
               if (!window.RatingResult)
                  window.RatingResult = null;
               if (window._args != null)
                  window._args = null;
               callback(window.RatingResult);
            }
         });
         me.win.center().open();
      },
      OKRating: function () {
         var me = this;
         me.win = $("#tipRatingWin").data("kendoWindow");
         var container = $("#divRatingDialogContent");
         if (!window.Brate)
            window.Brate = 1;
         if (!window.iItemID)
            window.iItemID = 0;
         kendo.ui.progress(container, true);
         $.ajax({
            type: "POST",
            url: Util.RootHomeFolder + "/SearchResult_DoRating",
            data: { itemID: window.iItemID, Rate: window.Brate, bDigital: window.digitalResult },
            dataType: "json",
            success: function (res) {
               window.RatingResult = res;
               kendo.ui.progress(container, false);
               me.win.close();
            },
            error: function (error) {
               kendo.ui.progress(container, false);
               me.win.close();
            }
         });
      },
      CancelRating: function () {
         var me = this;
         me.win = $("#tipRatingWin").data("kendoWindow");
         window.RatingResult = null;
         me.win.close();
      },
      show_EditRating: function () {//guohf Modify at 2021-02-05,Ver:8.7.3
         var me = this;
         var strStars = "";
         strStars = "<a href='javascript:void(0);' class='starWrapper' onclick='" + me.InstantName + ".rate(this,event);' style ='cursor:pointer;text-decoration:none;'> ";
         if (Util.skinName == "White") {
             strStars += "&nbsp;<img id='addReviewImg0' src='" + Util.RootImagesSystemFolder + "star0White.gif' alt='star0White'/>";
         } else {
             strStars += "&nbsp;<img id='addReviewImg0' src='" + Util.RootImagesSystemFolder + "Star0_24x24.png' alt='star0'/>";
         }
         for (var i = 1; i < 5; i++) {
             strStars += "&nbsp;<img id='addReviewImg" + i + "' src='" + Util.RootImagesSystemFolder + "Star1_24x24.png' alt='star " + (i + 1) + "'/>";
         }
         strStars += "</a>";
         return strStars;
      },
      rate: function (obj, oEvent) {
         var imgSrc = Util.RootImagesSystemFolder + 'Star1_24x24.png';
         var imgSrc_2;
         if (Util.skinName == "White") {
            imgSrc_2 = Util.RootImagesSystemFolder + 'star0White.gif';
         } else {
            imgSrc_2 = Util.RootImagesSystemFolder + 'Star0_24x24.png';
         }
         var e = oEvent || window.event;
         var target = e.target || e.srcElement;
         var imgArray = obj.getElementsByTagName("img");
         for (var i = 0; i < imgArray.length; i++) {
            imgArray[i]._num = i;
         }
         if (target.tagName == "A")//huxiaojing add at 2018-04-12,Ver 8.3.4
            target = target.childNodes[0];
         if (target.tagName == "IMG") {
            for (var j = 1; j < imgArray.length; j++) {
               if (j <= target._num) {
                  imgArray[j].src = imgSrc_2;
               } else {
                  imgArray[j].src = imgSrc;
               }
            }
         } else {
            for (var k = 1; k < imgArray.length; k++) {
               imgArray[k].src = imgSrc;
            }
         }
         window.Brate = target._num + 1;
      }
   }
   $(document).ready(function () {
      Util.skinName = "Blue";
      Util.RootImagesSystemFolder = "/Library/Content/opac/Images/system/";
      Util.show_AddRating = function () {
         window.digitalResult = false;
         if (arguments.length >= 3) {
            var _args = arguments;
            var itemid = -1;
            window.starobj = $("#" + _args[2]);
            window.ratingCap = null;
            if (arguments.length > 3) {
               window.ratingCap = $("#" + _args[3]);
               itemid = _args[1];
            }
            var bDigital = false;
            if (arguments.length > 4) {
               if (_args[4] == "digital") {
                  bDigital = true;
               }
            }
            window.digitalResult = bDigital;

            $.post(Util.RootHomeFolder + "/SearchResult_GetAddRatingInfo", {}, function (data) {
               if (data.isLogin == "0" && data.DoRatingAfterLogin == "1") {
                  Util.showLogin(this, itemid, 'rt', bDigital, null);
                  return;
               }
               if (bDigital && data.gpmAddRate == "0") {
                  Util.alert("Digital Rating", data.Message);
                  return;
               }
               else {
                  window._AddRating = new AddRating_2014("window._AddRating");
                  window._AddRating.show(_args[0], _args[1], function (res) {
                     if (res) {
                        if (res.bResult) {
                           var titleStars = "";
                           var iRate = 0;
                           for (var k = 0; k < 5; k++) {
                              if (k < res.iResult) {
                                 if (Util.skinName == "White") {
                                    titleStars += "<a href='javascript:void(0);'><img src='" + Util.RootImagesSystemFolder + "star0White.gif' alt='star "+(k+1)+"'/></a>";
                                 } else {
                                    titleStars += "<a href='javascript:void(0);'><img src='" + Util.RootImagesSystemFolder + "star0.gif' alt='star " + (k + 1) + "'/></a>";
                                 }
                              } else {
                                 titleStars += "<a href='javascript:void(0);'><img src='" + Util.RootImagesSystemFolder + "star1.gif' alt='star " + (k + 1) + "'/></a>";
                              }
                           }
                           titleStars += res.strResult;
                           if (res.iResult > 0) {
                              if (window.starobj.length > 0)
                                 window.starobj.html(titleStars);
                              if (window.ratingCap.length > 0)
                                 window.ratingCap.css("display", "");
                           }
                        }
                     }
                  });
               }
            });
         }
      }
   });
</script>
<script type="text/x-kendo-template" id="RatingTemplate">
   <p>#=sTitle#</p>
   <p>#=sItemTitle#</p>
   <p>#=sRate#</p>
   <p style='clear:both;'>#=ratingHtml#</p>
   <p style='clear:both; text-align:right;'>
   <a class='k-button k-primary' data-bind='events:{click:OKRating}' style=' width:80px; margin-left:5px;' href='javascript:void(0);'>#=sbtnOK#</a>
   <a class='k-button k-primary' data-bind='events:{click:CancelRating}' style=' width:80px; margin-left:5px;' href='javascript:void(0);'>#=sbtnCancel#</a>
   </p>
</script>
<div id="tipRatingWin" style="padding:0;;display:none">
   <div id="divRatingDialogContent" style="width: 360px; padding:0px 20px;">
   </div>
</div><script>
	jQuery(function(){jQuery("#tipRatingWin").kendoWindow({"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Add Rating","resizable":false,"width":400,"actions":["Close"]});});
</script>
<script>
   var diglogPictureScale = diglogPictureScale || {};
   diglogPictureScale = {
      picWin: null,
      max: 1000,
      min: 80,
      //originalWidth: 0,
      //originalHeight: 0,
      enlargeCount: 0,

   }
   function PictureScale_Enlarge() {
      var _ = diglogPictureScale;
      _.enlargeCount++;
      PictureScale_Scale();
   };
   function PictureScale_BeSmall() {
      var _ = diglogPictureScale;
      _.enlargeCount--;
      PictureScale_Scale();
   };
   function PictureScale_Scale() {
      var _ = diglogPictureScale;
      var weight = 1 + _.enlargeCount * 0.1;
      if (_.enlargeCount <= -10) {
         _.enlargeCount++;
         return;
      }
      $("#imgPicScale").css("transform", "scale(" + weight + ")");
      //$("#imgPicScale").width(_.originalWidth * weight);
      //$("#imgPicScale").height(_.originalHeight * weight);
   };
   function showPictureScale(url) {
      var me = diglogPictureScale;
      $("#imgPicScale").css("width", "");
      $("#imgPicScale").css("height", "");
      me.enlargeCount = 0;
      //me.originalWidth = 0;
      //me.originalHeight = 0;
      me.picWin = $("#diglogPictureScale").data("kendoWindow");
      $("#imgPicScale")[0].src = url + "?t=" + new Date().getTime();
      me.picWin.center().open();
   }
   function diglogPictureScaleAfterShow() {
      var me = diglogPictureScale;
      //me.originalWidth = $("#imgPicScale").width();
      //me.originalHeight = $("#imgPicScale").height();
      me.picWin.center();
   };
   $(document).ready(function () {
      Util.pictureScale = showPictureScale;
   });
</script>
<div id="diglogPictureScale" style="display:none">
  <div style="width:1000px;height:760px;overflow:auto;">
     <div style="border: 0; margin: auto; width: 1000px; height: 760px; text-align: center; display: table;">
        <div style="display: table-row;">
           <div style="vertical-align: middle; display: table-cell;">
              <img alt="Picture Scale" id="imgPicScale" style ="border:0;" src="" oncontextmenu="return false"  onerror="javascript:this.src='Images/NoneThumbnail.jpg';"/>
           </div>
        </div>
     </div>
  </div>
   <div style="width:1000px;text-align:center;padding:3px;">
      <div title="enlarge" style="display:inline-block">
         <button class="k-button" id="imgEnlarge" style = "width:35px;border:0px;padding:1px;" onclick="PictureScale_Enlarge();">
            <img src="/Library/Images/enlarge.png" alt="Zoom In"/>
         </button>
      </div>
      <div title="turndown" style="margin-left:10px;display:inline-block">
           <button class="k-button" id="imgTurndown" style = "width:35px;border:0px;padding:1px;" onclick="PictureScale_BeSmall();">
            <img src="/Library/Images/turndown.png" alt="Zoom Out"/>
         </button>
      </div>

   </div>
   </div><script>
	jQuery(function(){jQuery("#diglogPictureScale").kendoWindow({"activate":diglogPictureScaleAfterShow,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Picture Scale","resizable":false,"actions":["Close"]});});
</script>

				</div>
			</section>
			<section style="padding: 0; margin: 0; height: 2px;">
				<input id="txtfixedbrwoserautofill_opac" style="width: 56px; opacity: 0; height: 2px;" type="text" />
			</section>


		</div>
		<div>
			<form id="ParamForm" method="post" target="_self" action="CustomPage">
			</form>
		</div>

		<div style="width: calc(100% - 20px); margin: 0 auto; background-color: #f4f5f7;">
			
		</div>
		<footer>
			<div class="footer floatNone">
				<span class="footerDivLeftBorder" style="display: block; padding: 0 30px; height: 47px; width: 200px; float: left;">
					<a href="/Library/Manager/Index" target="_blank" class="white">Insignia Discovery Layer Manager</a>
				</span>

				<div class="footerDivRightBorder" style="float: right; padding: 0 30px;">
					<span class="light-gray-color">©1999-2025 </span>
					<span class="white">Insignia Software</span>
					<span class="light-gray-color">Database Version..</span><span class="white">8.9.2</span>
					&nbsp;&nbsp;
					<span class="light-gray-color">Web Portal ..</span><span class="white">8.9.2</span>
				</div>
			</div>
		</footer>
		<div id="EmailPasswordWin" style="width:316px;padding:5px;display:none">
<div id="EmailPasswordDiv">
   <label id="EmailPassword_lblPatronID" for="EmailPassword_txtPatronID" style="margin-left:2px;">Patron ID</label>
<input class="k-textbox" id="EmailPassword_txtPatronID" name="EmailPassword_txtPatronID" style="margin:3px;width:300px;" />
   <label id="EmailPassword_lblEmailAddress" for="EmailPassword_txtEmailAddress" style="margin-left:2px;">Email</label>
<input class="k-textbox" id="EmailPassword_txtEmailAddress" name="EmailPassword_txtEmailAddress" style="margin:3px;width:300px; " />
   <div style="text-align:right;margin:3px;width:300px;">
<button class="k-primary " id="EmailPassword_btnOK" style="width:75px;padding:0;">OK</button><script>
	jQuery(function(){jQuery("#EmailPassword_btnOK").kendoButton({"click":EmailPassword_OKClick});});
</script>
         
<button class="k-primary " id="EmailPassword_btnCancel" style="width:75px;padding:0;">Cancel</button><script>
	jQuery(function(){jQuery("#EmailPassword_btnCancel").kendoButton({"click":EmailPassword_CancelClick});});
</script>
   </div>

</div>
</div><script>
	jQuery(function(){jQuery("#EmailPasswordWin").kendoWindow({"activate":onEmailPasswordDialogActivate,"modal":true,"iframe":false,"draggable":false,"scrollable":true,"pinned":false,"title":"Email Address","resizable":false,"actions":["Close"]});});
</script>
<script>
   function onEmailPasswordDialogActivate() {
      var EmailPasswordWin = $("#EmailPasswordWin").data("kendoWindow");
      EmailPasswordWin.title(window.EmailPasswordWinCaptions["EmailPassword"]);
      $("#EmailPassword_lblPatronID").val(window.EmailPasswordWinCaptions["PatronID"]);
      $("#EmailPassword_lblEmailAddress").val(window.EmailPasswordWinCaptions["EmailAddress"]);
      $("#EmailPassword_btnOK").text(window.EmailPasswordWinCaptions["btnOK"]);
      $("#EmailPassword_btnCancel").text(window.EmailPasswordWinCaptions["btnCancel"]);
      if (!window.sPatronID) {
         window.sPatronID = "";
      }
      $("#EmailPassword_txtPatronID").val(window.sPatronID);
      $("#EmailPassword_txtEmailAddress").val("");
      if ($("#EmailPassword_txtPatronID").val() != "") {
         $("#EmailPassword_txtEmailAddress").focus();
      }
      else {
         $("#EmailPassword_txtPatronID").focus();
      }
   }
   function EmailPassword_OKClick() {
      var container = $("#EmailPasswordDiv");
      kendo.ui.progress(container, true);
      $.post(Util.RootHomeFolder + "/EmailPassword_SendEmail", { currentSelectedLibraryID: "All", sPatronID: $("#EmailPassword_txtPatronID").val(), sEmail: $("#EmailPassword_txtEmailAddress").val() },
         function (res) {
            if (res) {
               if (res.bResult) {
                  Util.alert("", res.strResult, function () {
                     $("#EmailPasswordWin").data("kendoWindow").close();
                  });
               }
               else {
                  Util.alert("", res.strResult);
               }
            }
            var container = $("#EmailPasswordDiv");
            kendo.ui.progress(container, false);
         });
   }
   function EmailPassword_CancelClick() {
      $("#EmailPasswordWin").data("kendoWindow").close();
   }
   $(document).ready(function () {
      Util.onshowForgetPassword = function (sender) {
         var username;
         if ($("#UserName")[0]) {
            userName = $("#UserName").val();
         }
         else {
            userName = $("#tipUserName").val();
         }
         window.sPatronID = userName;
         $.post(Util.RootHomeFolder + "/EmailPassword", null,
         function (data) {
            window.EmailPasswordWinCaptions = data;
            if ($("#EmailPasswordWin").length == 1) {
               $("#EmailPasswordWin").data("kendoWindow").open();
               $("#EmailPasswordWin").data("kendoWindow").center();
            }
         });
      };
   });
</script>
		<input id="inputLang_LoginWithoutPassword" type="hidden" value="You cannot login without providing your password" />
	</div>
   <script src="/Library/Scripts/opac/IM.js?v=892"></script>
   <script id="askLibrarianCustomTemplate" type="text/x-kendo-template">
      <div class="askLibrarianBox">
         <div class="askboxheader">
            <span class="askLibrarianTitle">Ask Librarian</span>
            <div class="askLibrarianActions">
               <a class="askLibrarianMinWin" style="display:none" href="javascript:void(0);">
                  <span class="btnSprite"></span>
               </a>
               <a class=" askLibrarianResWin" href="javascript:void(0);">
                  <span class="btnSprite "></span>
               </a>
            </div>
         </div>
         <div class="askLibrarianContent">
            <div class="askFriendTreeHeader">Friend</div>
            <div class="askFriendTree"></div>
            <div class="askLibrarianTreeHeader">Librarian</div>
            <div class="askLibrarianTree"></div>
         </div>
      <div>
   </script>
   <script id="askLibrarianTreeTemplate" type="text/kendo-ui-template">  
      # if (item.items) { #
         <span class="askLibrarianTreeLibItem">#: item.LibraryName #</span>
      # } else { #
         <span class="askLibrarianTreeTipItem" data-key="#: item.PatronKey #" data-name="#: item.PatronName #">#: item.PatronName #</span>
      # } #
   </script>
   <script id="askLibrarianChatCustomTemplate" type="text/x-kendo-template">
      <div class="askLibrarianBox" data-key="#: key #" data-name="#: name #">
         <div class="askboxheader">
            <span class="askLibrarianChatTitle">#: name #</span>
            <div class="askLibrarianActions">
               <a class="k-window-action k-link askLibrarianClsWin" data-key="#: key #" data-name="#: name #"  href="javascript:void(0);">
                  <span class="k-icon k-i-close">Close</span>
               </a>
            </div>
         </div>
         <div class="askLibrarianContent">
            <div class="askLibrarianChatMsgListBox"></div>
            <div class="askLibrarianChatMsgSendBox">
               <div class="askLibrarianChatMsgSendLeft">
                  <label for="txt_askLibrarianChatMsgSendText" class="askLibrarianChatMsgSendLabel">Message:</label>
                  <textarea id="txt_askLibrarianChatMsgSendText" class="k-textbox askLibrarianChatMsgSendText" data-key="#: key #" data-name="#: name #"></textarea>
               </div>
               <div class="askLibrarianChatMsgSendRight">
                  <button class="askLibrarianChatMsgSendBtn k-primary" data-key="#: key #" data-name="#: name #">Send</button>
                  <button class="askLibrarianChatMsgExportBtn k-primary" data-key="#: key #" data-name="#: name #">eMail</button>
                  <button class="askLibrarianChatMsgFeedbackBtn k-primary" data-key="#: key #" data-name="#: name #">Feedback</button>
               </div>
            </div>
         </div>
      <div>
   </script>
   <script id="askLibrarianChatMsgListTemplate" type="text/x-kendo-template">
      <div class="askLibrarianChatMsgItemTitle #if(isReceive){# askLibrarianChatMsgReceiveItemTitle #}# " data-isreceive="#: isReceive #" data-date="#: date #" data-message="#: messageText #">#: messageTitle #</div>
      <div class="askLibrarianChatMsgItemText #if(isReceive){# askLibrarianChatMsgReceiveItemText #}# ">#= messageText.replace(/\n/g, "<br />") #</div>
   </script>
   <script>
   $(document).ready(
   function () {
      window.__IM = new InstantMessage("IM");
      window.__IM.isTesting = false;
      window.__IM.showLibraryNameForAskLibrarian = true;
      window.__IM.show();
   });
   </script>
<div id="winAskLibrarianFeedback" style="display:none">
   <div id="divChatFeedbackQuestion" style="overflow:hidden;">
      <div id="divChatFeedbackQuestionList" class="flexlayoutcol">
      </div>
      <div>
         <label id="lblComments_ChatFeedbackQuestion" for="txtComments_ChatFeedbackQuestion" style="display:inline-block;width:70px;margin:1px 3px;">Comments</label>
         <div style="margin:0 3px;">
            <textarea id="txtComments_ChatFeedbackQuestion" style="width:100%;height:100%;"></textarea>
         </div>
      </div>
      <div class="flexlayout" style="height:24px; margin-top:2px;">
         <div style="flex: 1; -webkit-flex: 1;"></div>
<button class="chatFeedbackQuestionBtn k-primary" id="btnSave_ChatFeedbackQuestion" title="Save">Save</button><script>
	jQuery(function(){jQuery("#btnSave_ChatFeedbackQuestion").kendoButton({});});
</script> 
<button class="chatFeedbackQuestionBtn k-primary" id="btnCancel_ChatFeedbackQuestion" title="Cancel">Cancel</button><script>
	jQuery(function(){jQuery("#btnCancel_ChatFeedbackQuestion").kendoButton({});});
</script> 
         <div style="flex: 1; -webkit-flex: 1;"></div>
      </div>
   </div>
   </div><script>
	jQuery(function(){jQuery("#winAskLibrarianFeedback").kendoWindow({"animation":false,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Ask Librarian Feedback","resizable":false,"width":630,"actions":["Close"]});});
</script>   <script id="chatFeedbackQuestionListComboTemplate" type="text/x-kendo-template">
      <div style="margin-bottom:1px;" data-index="#: i #">
         <div class="flexlayout" style=" line-height:20px; margin-bottom:2px;">
            <span id="lblQuestion#: i #_ChatFeedbackQuestion" style="display:inline-block;width:26px;margin:0 3px;">#: i # :</span>
            <div style="flex: 1; -webkit-flex: 1;">
               <span id="lblQuestionText#: i #_ChatFeedbackQuestion" style="display:inline-block;">#: Question #</span>
            </div>
            <div style="width:3px;"></div>
         </div>
         <div class="flexlayout" style=" margin-bottom:2px;">
            <div style="width:26px;margin:0 3px;"></div>
            <div style="flex: 1; -webkit-flex: 1;">
               <div id="divRate#: i #_ChatFeedbackQuestion">
                  <div class="flexlayout">
                     <div style="min-width:80px;">Least</div>
                     <div style="min-width:80px;"></div>
                     <div style="min-width:80px;"></div>
                     <div style="min-width:80px;"></div>
                     <div style="min-width:80px;">Most Satisfied</div>
                  </div>
                  <div class="flexlayout">
                     <div style="min-width:80px;">
                        <input name="optRate#: i #_ChatFeedbackQuestion" class="k-radio" id="optRate#: i #_ChatFeedbackQuestion_1" type="radio" value="1" #if(DefaultAnswer == "1"){# checked="checked" #}#>
                        <label class="k-radio-label" for="optRate#: i #_ChatFeedbackQuestion_1"></label>
                     </div>
                     <div style="min-width:80px;">
                        <input name="optRate#: i #_ChatFeedbackQuestion" class="k-radio" id="optRate#: i #_ChatFeedbackQuestion_2" type="radio" value="2" #if(DefaultAnswer == "2"){# checked="checked" #}#>
                        <label class="k-radio-label" for="optRate#: i #_ChatFeedbackQuestion_2"></label>
                     </div>
                     <div style="min-width:80px;">
                        <input name="optRate#: i #_ChatFeedbackQuestion" class="k-radio" id="optRate#: i #_ChatFeedbackQuestion_3" type="radio" value="3" #if(DefaultAnswer == "3"){# checked="checked" #}#>
                        <label class="k-radio-label" for="optRate#: i #_ChatFeedbackQuestion_3"></label>
                     </div>
                     <div style="min-width:80px;">
                        <input name="optRate#: i #_ChatFeedbackQuestion" class="k-radio" id="optRate#: i #_ChatFeedbackQuestion_4" type="radio" value="4" #if(DefaultAnswer == "4"){# checked="checked" #}#>
                        <label class="k-radio-label" for="optRate#: i #_ChatFeedbackQuestion_4"></label>
                     </div>
                     <div style="min-width:80px;">
                        <input name="optRate#: i #_ChatFeedbackQuestion" class="k-radio" id="optRate#: i #_ChatFeedbackQuestion_5" type="radio" value="5" #if(DefaultAnswer == "5"){# checked="checked" #}#>
                        <label class="k-radio-label" for="optRate#: i #_ChatFeedbackQuestion_5"></label>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </script>
   <script id="chatFeedbackQuestionListRadioTemplate" type="text/x-kendo-template">
      <div style="margin-bottom:1px;" data-index="#: i #">
         <div class="flexlayout" style=" line-height:20px; margin-bottom:2px;">
            <span id="lblQuestion#: i #_ChatFeedbackQuestion" style="display:inline-block;width:26px;margin:0 3px;">#: i # :</span>
            <div style="flex: 1; -webkit-flex: 1;">
               <span id="lblQuestionText#: i #_ChatFeedbackQuestion" style="display:inline-block;">#: Question #</span>
            </div>
            <div style="width:3px;"></div>
         </div>
         <div class="flexlayout" style=" line-height:20px; margin-bottom:2px;">
            <div style="width:26px;margin:0 3px;"></div>
            <div style="flex: 1; -webkit-flex: 1;">
               <div id="divRadio#: i #_ChatFeedbackQuestion">
                  <span>
                     <input name="optQuestion#: i #_ChatFeedbackQuestion" class="k-radio" id="optQuestion#: i #_ChatFeedbackQuestion_1" type="radio" value="1" #if(DefaultAnswer == "yes"){# checked="checked" #}#>
                     <label class="k-radio-label" for="optQuestion#: i #_ChatFeedbackQuestion_1">Yes</label>
                  </span>
                  <span style="margin: 0px 10px;">
                     <input name="optQuestion#: i #_ChatFeedbackQuestion" class="k-radio" id="optQuestion#: i #_ChatFeedbackQuestion_0" type="radio" value="0" #if(DefaultAnswer == "no"){# checked="checked" #}#>
                     <label class="k-radio-label" for="optQuestion#: i #_ChatFeedbackQuestion_0">No</label>
                  </span>
               </div>
            </div>
         </div>
      </div>
   </script>
   <script src="/Library/Scripts/opac/ChatFeedbackQuestion.js"></script>





<script type="text/javascript" src="/Library/Scripts/opac/DialogChangePassword.js?v=892"></script>
<div id="passwordWin" style="display:none">
        <div style="width:100%; display:table;">
           <div class="changepasswordpatronidinfo" style="display:table-row">
              <div style="display:table-cell; height:25px; vertical-align:middle;">
                 <label id="lbl_UserName_PSW" for="txtPatronID">Patron ID</label>
              </div>
           </div>
           <div class="changepasswordpatronidinfo" style="display:table-row">
              <div style="display:table-cell; height:30px;">
<input class="k-textbox" disabled="disabled" id="txtPatronID" name="txtPatronID" style="height:30px; width:100%;background: rgb(228, 227, 227);" />
              </div>
           </div>
           <div style="display:table-row">
              <div style="display:table-cell; height:25px; vertical-align:middle;">
                 <label id="lbl_OldPassword_PSW" for="txtOldPassword">Old Password</label>
              </div>
           </div>
           <div style="display:table-row">
              <div style="display:table-cell; height:30px;">
<input class="k-textbox" id="txtOldPassword" name="txtOldPassword" style="height:30px; width:100%;" type="password" />
              </div>
           </div>
           <div style="display:table-row">
              <div style="display:table-cell; height:25px; vertical-align:middle;">
                 <label id="lblNewPassword_PSW" for="txtNewPassword">New Password</label>
              </div>
           </div>
           <div style="display:table-row">
              <div style="display:table-cell; height:30px;">
<input class="k-textbox" id="txtNewPassword" name="txtNewPassword" style="height:30px; width:100%;" type="password" />
              </div>
           </div>
           <div style="display:table-row">
              <div style="display:table-cell; height:25px; vertical-align:middle;">
                 <label id="lbl_ConfirmPassword_PSW" for="txtConfirmPassword">Confirm New Password</label>
              </div>
           </div>
           <div style="display:table-row">
              <div style="display:table-cell; height:30px;">
<input class="k-textbox" id="txtConfirmPassword" name="txtConfirmPassword" style="height:30px; width:100%;" type="password" />
              </div>
           </div>
           <div style="display:table-row">
              <div style="display:table-cell; padding:5px 0px 5px 0px; text-align:right;">
                 <div style="display:table;text-align:right; width:100%;">
                    <div style="display:table-row">
                       <div style="display:table-cell">
<button class="k-primary" id="btn_Psw_Ok" style="padding:0px; width:80px; height:23px; font-size:small; margin:3px; font-weight: bold; float:none; border-radius:5px;color:#fff;">OK</button><script>
	jQuery(function(){jQuery("#btn_Psw_Ok").kendoButton({"click":oChangePasswordDialog.Password_Clicked_OK});});
</script> 
                       </div>
                       <div style="display:table-cell; width:80px;">
<button class="k-primary" id="btn_Psw_Cancel" style="padding:0px; width:80px; height:23px; font-size:small; margin:3px; font-weight: bold; float:none; border-radius:5px;color:#fff;">Cancel</button><script>
	jQuery(function(){jQuery("#btn_Psw_Cancel").kendoButton({"click":oChangePasswordDialog.Password_Clicked_Cancel});});
</script>
                       </div>
                    </div>
                 </div>
              </div>
           </div>
        </div>
    </div><script>
	jQuery(function(){jQuery("#passwordWin").kendoWindow({"open":oChangePasswordDialog.WindowToCenter,"modal":true,"iframe":false,"draggable":true,"scrollable":true,"pinned":false,"title":"Change Password","resizable":false,"width":360,"actions":["Close"]});});
</script>

<script>
   //huxiaojing add at 2018-08-01,Ver 8.4.1
   var oPasswordRequirements = {};
   oPasswordRequirements.minimumCharsOfPassword = parseInt("0");
   oPasswordRequirements.numbersOfCapitalLettersInPassword= parseInt("0");
   oPasswordRequirements.numbersOfLowerCaseLettersInPassword= parseInt("0");
   oPasswordRequirements.numbersOfNumbersInPassword = parseInt("0");
   oPasswordRequirements.numbersOfSpecialCharsOfPassword = parseInt("0");
   oPasswordRequirements.msg_33257 = "The password length must be greater than or equal 0.";
   oPasswordRequirements.msg_33258 = "The password must be contain at least 0 capital letter(s).";
   oPasswordRequirements.msg_33259 = "The password must be contain at least 0 lowercase letter(s).";
   oPasswordRequirements.msg_33260 = "The password must be contain at least 0 number(s).";
   oPasswordRequirements.msg_33261 = "The password must be contain at least 0 special char(s).";
   oPasswordRequirements.checkPasswordRequirements = function (newP,strHeader, callback) {
      var me = oPasswordRequirements;
      if (me.minimumCharsOfPassword > 0) {
         if (newP.length < me.minimumCharsOfPassword) {
            Util.alert(strHeader, me.msg_33257, function () {
               if (callback)
                  callback(false);
            });
            return;
         }
      }
      if (me.numbersOfCapitalLettersInPassword > 0 || me.numbersOfLowerCaseLettersInPassword > 0
         || me.numbersOfNumbersInPassword > 0 || me.numbersOfSpecialCharsOfPassword > 0) {
         var numbersOfCapitalLettersInPassword = 0;
         var numbersOfLowerCaseLettersInPassword = 0;
         var numbersOfNumbersInPassword = 0;
         var numbersOfSpecialCharsOfPassword = 0;
         for (var i = 0; i < newP.length; i++) {
            var charCodeAt = newP.charCodeAt(i);
            if (charCodeAt >= 65 && charCodeAt <= 90) {//A ~ Z
               numbersOfCapitalLettersInPassword++;
            }
            else if (charCodeAt >= 97 && charCodeAt <= 122) {//a ~ z
               numbersOfLowerCaseLettersInPassword++;
            }
            else if (charCodeAt >= 48 && charCodeAt <= 57) {//0 ~ 9
               numbersOfNumbersInPassword++;
            }
            else {
               numbersOfSpecialCharsOfPassword++;
            }
         }
         if (me.numbersOfCapitalLettersInPassword > 0 && me.numbersOfCapitalLettersInPassword > numbersOfCapitalLettersInPassword) {
            Util.alert(strHeader, me.msg_33258, function () {
               if (callback)
                  callback(false);
            });
            return;
         }
         if (me.numbersOfLowerCaseLettersInPassword > 0 && me.numbersOfLowerCaseLettersInPassword > numbersOfLowerCaseLettersInPassword) {
            Util.alert(strHeader, me.msg_33259, function () {
               if (callback)
                  callback(false);
            });
            return;
         }
         if (me.numbersOfNumbersInPassword > 0 && me.numbersOfNumbersInPassword > numbersOfNumbersInPassword) {
            Util.alert(strHeader, me.msg_33260, function () {
               if (callback)
                  callback(false);
            });
            return;
         }
         if (me.numbersOfSpecialCharsOfPassword > 0 && me.numbersOfSpecialCharsOfPassword > numbersOfSpecialCharsOfPassword) {
            Util.alert(strHeader, me.msg_33261, function () {
               if (callback)
                  callback(false);
            });
            return;
         }
      }
      if (callback)
         callback(true);

   };

</script>

<script>
   var oChangePasswordDialog = new DialogChangePassword();
   oChangePasswordDialog.InstantName = 'changePassword';
   oChangePasswordDialog.language_PSW_Message = "Your two passwords did not match!";
   oChangePasswordDialog.language_PSW_Message2 = "New Password should not same as old password, please reenter the password. ~Passwords same";
   oChangePasswordDialog.language_PSW_Message3 = "%1 must be entered.~Required Field";
   oChangePasswordDialog.passwordEncryptKey = "e98ea245b9294861915428b02fc7b44d";
   $(document.body).ready(function () {
      oChangePasswordDialog.Init();
   });
</script>		<form id="formPBSLearningMedia" aria-label="PBS Learning Media" action="https://staging.pbslm.org/bypass/lti/launch/" target="_blank" method="post" role="form" style="display: none;">
		<input type="hidden" name="testpbs" value="" />
	</form>
	<form id="formNBCLearn" aria-label="NBC Learn" action="https://archives.nbclearn.com/portal/site/k-12/" target="_blank" method="post" role="form" style="display: none;">
		<input type="hidden" name="testnbc" value="" />
	</form>
	
	<script>
      var defaultSearchType = "Keywords";
      var defaultLibraryID = "All";
      $(function () {
         if ($("#cboSearchTypes").data("kendoComboBox")) {
            //alivya add music search type logic at 2019-01-31, ver 8.4.7
            var searchTypeData = $("#cboSearchTypes").data("kendoComboBox").dataSource.data();
            if (searchTypeData) {
               $.each(searchTypeData, function (i, stItem) {
                  originalSearchTypes.push({ Text: stItem.Text, Value: stItem.Value });
               });
            }
            if (!isOtherSearch) {
               if ($.inArray(defaultLibraryID, musicLibraryIDs) > -1) {
                  var newSearchTypes = $.extend(true, [], originalSearchTypes);
                  newSearchTypes.push({ Text: voicing_Lang, Value: "Voicing" });
                  newSearchTypes.push({ Text: arranger_Lang, Value: "Arranger" });
                  $("#cboSearchTypes").data("kendoComboBox").setDataSource(newSearchTypes);
                  $("#cboSearchTypes").data("kendoComboBox").value(defaultSearchType);
               }
            }
         }
         if (!isOtherSearch && CS_SiteBasedCC) {
            if ($("#cboSearchTypes").length)
               $("#cboSearchTypes").data("kendoComboBox").bind("change", searchTypeChanged);
            if ($("#cboSearchData").length) {
               $("#cboSearchData").data("kendoComboBox").bind("change", function (e) {
                  $("#txtSearchData").val($("#cboSearchData").data("kendoComboBox").text());
               });
               var searchTypeValue = $("#cboSearchTypes").val();
               if (searchTypeValue == "Genre") {
                  setTimeout(function () { $("#cboSearchData").data("kendoComboBox").focus(); libraryChanged(false); }, 500);
               }
            }
         }
      });
	</script>
</body>
</html>
